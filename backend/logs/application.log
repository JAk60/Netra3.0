2025-11-07 21:37:55,089 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-07 21:37:55,089 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-07 21:37:55,094 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:37:55,094 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-07 21:37:55,099 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:37:55,099 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-07 21:37:55,104 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:37:55,104 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-07 21:37:55,108 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-07 21:37:55,108 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-07 21:37:55,113 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-07 21:37:55,113 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-07 21:37:55,114 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-07 21:37:55,120 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-07 21:37:55,120 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-07 21:37:55,120 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-07 21:37:55,127 - DEBUG - üîó Foreign keys for ships: []
2025-11-07 21:37:55,134 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-07 21:37:55,134 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-07 21:37:55,134 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-07 21:37:55,134 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-07 21:37:55,134 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-07 21:37:55,140 - DEBUG - üîó Foreign keys for systems: []
2025-11-07 21:37:55,145 - DEBUG - üîó Foreign keys for users: []
2025-11-07 21:37:55,146 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-07 21:37:55,146 - DEBUG - üîç Relationship Details:
2025-11-07 21:37:55,146 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-07 21:37:55,146 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-07 21:37:55,146 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-07 21:37:55,146 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-07 21:37:55,146 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-07 21:37:55,146 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-07 21:37:55,146 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-07 21:37:55,146 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-07 21:37:55,146 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-07 21:37:55,146 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-07 21:37:55,147 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-07 21:37:55,147 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-07 21:37:55,147 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-07 21:37:55,147 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-07 21:37:55,204 - INFO - üìå Loaded conversation memory from disk.
2025-11-07 21:37:55,204 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-07 21:39:13,235 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-07 21:39:13,235 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-07 21:39:13,235 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-07 21:39:13,378 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-07 21:39:13,549 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-07 21:39:13,565 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-07 21:39:13,565 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-07 21:39:13,581 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-07 21:39:13,597 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-07 21:39:13,606 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-07 21:39:13,628 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-07 21:39:13,634 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-07 21:39:13,637 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-07 21:39:13,639 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-07 21:39:13,642 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-07 21:39:13,644 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-07 21:39:13,647 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-07 21:39:13,650 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-07 21:39:13,654 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-07 21:39:13,657 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-07 21:39:13,660 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-07 21:39:13,663 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-07 21:39:13,665 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-07 21:39:13,668 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-07 21:39:13,673 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-07 21:39:13,678 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:39:13,678 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-07 21:39:13,682 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-07 21:39:13,682 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-07 21:39:13,687 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:39:13,687 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-07 21:39:13,691 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:39:13,691 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-07 21:39:13,696 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:39:13,696 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-07 21:39:13,700 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-07 21:39:13,700 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-07 21:39:13,705 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-07 21:39:13,705 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-07 21:39:13,705 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-07 21:39:13,710 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-07 21:39:13,710 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-07 21:39:13,710 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-07 21:39:13,715 - DEBUG - üîó Foreign keys for ships: []
2025-11-07 21:39:13,720 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-07 21:39:13,720 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-07 21:39:13,720 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-07 21:39:13,720 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-07 21:39:13,720 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-07 21:39:13,724 - DEBUG - üîó Foreign keys for systems: []
2025-11-07 21:39:13,728 - DEBUG - üîó Foreign keys for users: []
2025-11-07 21:39:13,728 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-07 21:39:13,729 - DEBUG - üîç Relationship Details:
2025-11-07 21:39:13,729 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-07 21:39:13,729 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-07 21:39:13,729 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-07 21:39:13,729 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-07 21:39:13,729 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-07 21:39:13,729 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-07 21:39:13,729 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-07 21:39:13,729 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-07 21:39:13,729 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-07 21:39:13,729 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-07 21:39:13,729 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-07 21:39:13,730 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-07 21:39:13,730 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-07 21:39:13,730 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-07 21:39:13,730 - INFO - üìå Loaded conversation memory from disk.
2025-11-07 21:39:13,730 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-07 21:39:15,308 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-07 21:39:15,324 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-07 21:39:15,325 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-07 21:39:15,338 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-07 21:39:15,343 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-07 21:39:15,347 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-07 21:39:15,351 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-07 21:39:15,355 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-07 21:39:15,358 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-07 21:39:15,360 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-07 21:39:15,364 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-07 21:39:15,368 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-07 21:39:15,372 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-07 21:39:15,375 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-07 21:39:15,378 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-07 21:39:15,381 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-07 21:39:15,384 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-07 21:39:15,389 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-07 21:39:15,393 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:39:15,393 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-07 21:39:15,398 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-07 21:39:15,398 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-07 21:39:15,402 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:39:15,402 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-07 21:39:15,406 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:39:15,406 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-07 21:39:15,411 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-07 21:39:15,411 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-07 21:39:15,415 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-07 21:39:15,415 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-07 21:39:15,419 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-07 21:39:15,420 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-07 21:39:15,420 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-07 21:39:15,424 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-07 21:39:15,424 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-07 21:39:15,424 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-07 21:39:15,428 - DEBUG - üîó Foreign keys for ships: []
2025-11-07 21:39:15,433 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-07 21:39:15,433 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-07 21:39:15,433 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-07 21:39:15,433 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-07 21:39:15,433 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-07 21:39:15,437 - DEBUG - üîó Foreign keys for systems: []
2025-11-07 21:39:15,441 - DEBUG - üîó Foreign keys for users: []
2025-11-07 21:39:15,441 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-07 21:39:15,441 - DEBUG - üîç Relationship Details:
2025-11-07 21:39:15,441 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-07 21:39:15,441 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-07 21:39:15,441 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-07 21:39:15,441 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-07 21:39:15,441 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-07 21:39:15,441 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-07 21:39:15,441 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-07 21:39:15,442 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-07 21:39:15,442 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-07 21:39:15,442 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-07 21:39:15,442 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-07 21:39:15,442 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-07 21:39:15,442 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-07 21:39:15,442 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-07 21:40:18,652 - INFO - Database engine created with pool_size=10
2025-11-07 21:40:18,653 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-07 21:40:18,653 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-07 21:40:19,192 - INFO - SQLModel query returned 53 rows
2025-11-07 21:40:19,192 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-07 21:40:19,192 - DEBUG - Starting to process and group results
2025-11-07 21:40:19,192 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-07 21:40:19,192 - DEBUG - Creating new command group: Western Naval Command
2025-11-07 21:40:19,192 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-07 21:40:19,192 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-07 21:40:19,192 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-07 21:40:19,192 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-07 21:40:19,192 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-07 21:40:19,193 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-07 21:40:19,193 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-07 21:40:19,193 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-07 21:40:19,193 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-07 21:40:19,194 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-07 21:40:19,194 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-07 21:40:19,194 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-07 21:40:19,194 - INFO - Processed 3 unique ships into 1 command groups
2025-11-07 21:40:19,194 - DEBUG - Converting to final data structure
2025-11-07 21:40:19,194 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-07 21:40:19,194 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-07 21:40:19,194 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-07 21:40:19,194 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-07 21:40:19,194 - DEBUG - Command groups: ['Western Naval Command']
2025-11-07 21:40:19,195 - INFO - Successfully retrieved hierarchical ship data
2025-11-07 21:47:39,717 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-07 21:47:39,717 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-07 21:47:39,726 - INFO - SQLModel query returned 53 rows
2025-11-07 21:47:39,726 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-07 21:47:39,726 - DEBUG - Starting to process and group results
2025-11-07 21:47:39,726 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-07 21:47:39,726 - DEBUG - Creating new command group: Western Naval Command
2025-11-07 21:47:39,726 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-07 21:47:39,726 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-07 21:47:39,726 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-07 21:47:39,726 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-07 21:47:39,726 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-07 21:47:39,726 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-07 21:47:39,726 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-07 21:47:39,727 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-07 21:47:39,727 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-07 21:47:39,727 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-07 21:47:39,727 - INFO - Processed 3 unique ships into 1 command groups
2025-11-07 21:47:39,728 - DEBUG - Converting to final data structure
2025-11-07 21:47:39,728 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-07 21:47:39,728 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-07 21:47:39,728 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-07 21:47:39,728 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-07 21:47:39,728 - DEBUG - Command groups: ['Western Naval Command']
2025-11-07 21:47:39,728 - INFO - Successfully retrieved hierarchical ship data
2025-11-07 22:09:19,111 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-07 22:09:19,111 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-07 22:09:19,119 - INFO - SQLModel query returned 53 rows
2025-11-07 22:09:19,119 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-07 22:09:19,119 - DEBUG - Starting to process and group results
2025-11-07 22:09:19,119 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-07 22:09:19,119 - DEBUG - Creating new command group: Western Naval Command
2025-11-07 22:09:19,119 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-07 22:09:19,120 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-07 22:09:19,120 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-07 22:09:19,120 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-07 22:09:19,120 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-07 22:09:19,120 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-07 22:09:19,120 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-07 22:09:19,120 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-07 22:09:19,121 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-07 22:09:19,121 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-07 22:09:19,121 - INFO - Processed 3 unique ships into 1 command groups
2025-11-07 22:09:19,121 - DEBUG - Converting to final data structure
2025-11-07 22:09:19,121 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-07 22:09:19,121 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-07 22:09:19,121 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-07 22:09:19,121 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-07 22:09:19,121 - DEBUG - Command groups: ['Western Naval Command']
2025-11-07 22:09:19,121 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 00:37:03,674 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 00:37:03,674 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 00:37:03,674 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 00:37:03,810 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 00:37:03,996 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 00:37:04,013 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 00:37:04,013 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 00:37:04,033 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 00:37:04,048 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 00:37:04,058 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 00:37:05,146 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 00:37:05,152 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 00:37:05,155 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 00:37:05,158 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 00:37:05,161 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 00:37:05,164 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 00:37:05,167 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 00:37:05,170 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 00:37:05,174 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 00:37:05,177 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 00:37:05,180 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 00:37:05,183 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 00:37:05,186 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 00:37:05,189 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 00:37:05,195 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 00:37:05,199 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 00:37:05,199 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 00:37:05,204 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 00:37:05,204 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 00:37:05,209 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 00:37:05,209 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 00:37:05,213 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 00:37:05,213 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 00:37:05,218 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 00:37:05,218 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 00:37:05,223 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 00:37:05,223 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 00:37:05,229 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 00:37:05,229 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 00:37:05,229 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 00:37:05,234 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 00:37:05,234 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 00:37:05,234 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 00:37:05,239 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 00:37:05,245 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 00:37:05,245 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 00:37:05,245 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 00:37:05,246 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 00:37:05,246 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 00:37:05,251 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 00:37:05,256 - DEBUG - üîó Foreign keys for users: []
2025-11-08 00:37:05,256 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 00:37:05,256 - DEBUG - üîç Relationship Details:
2025-11-08 00:37:05,256 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 00:37:05,256 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 00:37:05,256 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 00:37:05,256 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 00:37:05,257 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 00:37:05,257 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 00:37:05,257 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 00:37:05,257 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 00:37:05,257 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 00:37:05,257 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 00:37:05,257 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 00:37:05,257 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 00:37:05,257 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 00:37:05,257 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 00:37:05,258 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 00:37:05,258 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 00:37:05,912 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 00:37:05,928 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 00:37:05,928 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 00:37:05,940 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 00:37:05,944 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 00:37:05,947 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 00:37:05,950 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 00:37:05,952 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 00:37:05,955 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 00:37:05,957 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 00:37:05,960 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 00:37:05,963 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 00:37:05,966 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 00:37:05,968 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 00:37:05,971 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 00:37:05,974 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 00:37:05,976 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 00:37:05,982 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 00:37:05,986 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 00:37:05,986 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 00:37:05,990 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 00:37:05,991 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 00:37:05,995 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 00:37:05,995 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 00:37:05,999 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 00:37:05,999 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 00:37:06,003 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 00:37:06,003 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 00:37:06,007 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 00:37:06,007 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 00:37:06,011 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 00:37:06,011 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 00:37:06,011 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 00:37:06,016 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 00:37:06,016 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 00:37:06,016 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 00:37:06,020 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 00:37:06,025 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 00:37:06,025 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 00:37:06,025 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 00:37:06,025 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 00:37:06,025 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 00:37:06,029 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 00:37:06,033 - DEBUG - üîó Foreign keys for users: []
2025-11-08 00:37:06,033 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 00:37:06,033 - DEBUG - üîç Relationship Details:
2025-11-08 00:37:06,033 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 00:37:06,033 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 00:37:06,033 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 00:37:06,034 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 00:37:06,034 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 00:37:06,034 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 00:37:06,034 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 00:37:06,034 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 00:37:06,034 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 00:37:06,034 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 00:37:06,034 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 00:37:06,034 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 00:37:06,034 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 00:37:06,034 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 00:37:18,477 - INFO - Database engine created with pool_size=10
2025-11-08 00:37:18,477 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 00:37:18,478 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 00:37:18,511 - INFO - SQLModel query returned 53 rows
2025-11-08 00:37:18,511 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 00:37:18,511 - DEBUG - Starting to process and group results
2025-11-08 00:37:18,511 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 00:37:18,511 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 00:37:18,511 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 00:37:18,511 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 00:37:18,511 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 00:37:18,511 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 00:37:18,512 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 00:37:18,512 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 00:37:18,512 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 00:37:18,512 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 00:37:18,512 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 00:37:18,512 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 00:37:18,512 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 00:37:18,512 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 00:37:18,512 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 00:37:18,512 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 00:37:18,512 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 00:37:18,513 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 00:37:18,513 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 00:37:18,513 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 00:37:18,513 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 00:37:18,513 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 00:37:18,513 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 00:37:18,513 - DEBUG - Converting to final data structure
2025-11-08 00:37:18,513 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 00:37:18,513 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 00:37:18,513 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 00:37:18,513 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 00:37:18,513 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 00:37:18,514 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 00:40:35,034 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 00:40:35,034 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 00:40:35,036 - INFO - SQLModel query returned 53 rows
2025-11-08 00:40:35,036 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 00:40:35,037 - DEBUG - Starting to process and group results
2025-11-08 00:40:35,037 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 00:40:35,037 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 00:40:35,037 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 00:40:35,037 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 00:40:35,037 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 00:40:35,037 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 00:40:35,037 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 00:40:35,037 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 00:40:35,037 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 00:40:35,037 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 00:40:35,037 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 00:40:35,037 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 00:40:35,038 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 00:40:35,038 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 00:40:35,038 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 00:40:35,038 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 00:40:35,038 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 00:40:35,038 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 00:40:35,038 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 00:40:35,038 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 00:40:35,038 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 00:40:35,038 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 00:40:35,038 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 00:40:35,039 - DEBUG - Converting to final data structure
2025-11-08 00:40:35,039 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 00:40:35,039 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 00:40:35,039 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 00:40:35,039 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 00:40:35,039 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 00:40:35,040 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 00:42:54,324 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 00:42:54,324 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 00:42:54,332 - INFO - SQLModel query returned 53 rows
2025-11-08 00:42:54,332 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 00:42:54,332 - DEBUG - Starting to process and group results
2025-11-08 00:42:54,332 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 00:42:54,333 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 00:42:54,333 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 00:42:54,333 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 00:42:54,333 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 00:42:54,333 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 00:42:54,333 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 00:42:54,333 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 00:42:54,333 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 00:42:54,333 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 00:42:54,333 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 00:42:54,333 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 00:42:54,333 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 00:42:54,334 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 00:42:54,334 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 00:42:54,334 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 00:42:54,334 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 00:42:54,334 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 00:42:54,334 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 00:42:54,334 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 00:42:54,334 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 00:42:54,334 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 00:42:54,334 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 00:42:54,334 - DEBUG - Converting to final data structure
2025-11-08 00:42:54,334 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 00:42:54,335 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 00:42:54,335 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 00:42:54,335 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 00:42:54,335 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 00:42:54,335 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 11:31:26,883 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:31:26,883 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:31:26,883 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:31:27,022 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:31:27,185 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:31:27,201 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:31:27,201 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:31:27,217 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:31:27,232 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:31:27,241 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:31:31,699 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:31:31,704 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:31:31,708 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:31:31,711 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:31:31,713 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:31:31,716 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:31:31,719 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:31:31,722 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:31:31,725 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:31:31,728 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:31:31,731 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:31:31,734 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:31:31,737 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:31:31,740 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:31:31,745 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:31:31,749 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:31:31,749 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:31:31,753 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:31:31,753 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:31:31,757 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:31:31,757 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:31:31,761 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:31:31,761 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:31:31,765 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:31:31,765 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:31:31,769 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:31:31,769 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:31:31,774 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:31:31,774 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:31:31,774 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:31:31,778 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:31:31,778 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:31:31,778 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:31:31,783 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:31:31,787 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:31:31,787 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:31:31,787 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:31:31,787 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:31:31,787 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:31:31,791 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:31:31,795 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:31:31,796 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:31:31,796 - DEBUG - üîç Relationship Details:
2025-11-08 11:31:31,796 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:31:31,796 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:31:31,796 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:31:31,796 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:31:31,796 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:31:31,796 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:31:31,796 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:31:31,796 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:31:31,796 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:31:31,796 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:31:31,796 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:31:31,796 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:31:31,796 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:31:31,796 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:31:31,797 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:31:31,797 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:31:32,438 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:31:32,454 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:31:32,454 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:31:32,466 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:31:32,471 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:31:32,474 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:31:32,476 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:31:32,479 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:31:32,482 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:31:32,485 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:31:32,488 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:31:32,491 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:31:32,494 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:31:32,498 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:31:32,503 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:31:32,505 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:31:32,509 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:31:32,514 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:31:32,519 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:31:32,519 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:31:32,523 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:31:32,523 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:31:32,527 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:31:32,527 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:31:32,531 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:31:32,531 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:31:32,536 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:31:32,536 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:31:32,540 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:31:32,540 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:31:32,544 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:31:32,544 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:31:32,544 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:31:32,549 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:31:32,549 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:31:32,549 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:31:32,553 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:31:32,557 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:31:32,557 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:31:32,557 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:31:32,557 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:31:32,557 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:31:32,561 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:31:32,566 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:31:32,566 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:31:32,566 - DEBUG - üîç Relationship Details:
2025-11-08 11:31:32,566 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:31:32,566 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:31:32,566 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:31:32,566 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:31:32,566 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:31:32,566 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:31:32,566 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:31:32,566 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:31:32,566 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:31:32,566 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:31:32,566 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:31:32,566 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:31:32,566 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:31:32,566 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:31:55,038 - INFO - Database engine created with pool_size=10
2025-11-08 11:31:55,038 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 11:31:55,039 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 11:31:55,073 - INFO - SQLModel query returned 53 rows
2025-11-08 11:31:55,073 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 11:31:55,073 - DEBUG - Starting to process and group results
2025-11-08 11:31:55,073 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 11:31:55,073 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 11:31:55,073 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 11:31:55,073 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 11:31:55,073 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 11:31:55,073 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 11:31:55,073 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 11:31:55,074 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 11:31:55,074 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 11:31:55,074 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 11:31:55,074 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 11:31:55,074 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 11:31:55,074 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 11:31:55,074 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 11:31:55,074 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 11:31:55,074 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 11:31:55,074 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 11:31:55,074 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 11:31:55,075 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 11:31:55,075 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 11:31:55,075 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 11:31:55,075 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 11:31:55,075 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 11:31:55,075 - DEBUG - Converting to final data structure
2025-11-08 11:31:55,075 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 11:31:55,075 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 11:31:55,075 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 11:31:55,075 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 11:31:55,075 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 11:31:55,076 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 11:36:43,325 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:36:43,325 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:36:43,325 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:36:43,459 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:36:43,620 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:36:43,636 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:36:43,636 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:36:43,651 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:36:43,666 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:36:43,675 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:36:43,695 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:36:43,701 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:36:43,704 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:36:43,706 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:36:43,709 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:36:43,712 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:36:43,714 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:36:43,717 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:36:43,720 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:36:43,723 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:36:43,726 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:36:43,729 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:36:43,731 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:36:43,734 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:36:43,739 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:36:43,743 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:43,743 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:36:43,747 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:36:43,747 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:36:43,751 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:43,751 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:36:43,755 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:43,756 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:36:43,759 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:43,759 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:36:43,763 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:36:43,763 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:36:43,767 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:36:43,767 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:36:43,768 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:36:43,772 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:36:43,772 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:36:43,772 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:36:43,776 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:36:43,780 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:36:43,780 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:36:43,780 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:36:43,781 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:36:43,781 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:36:43,784 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:36:43,788 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:36:43,788 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:36:43,789 - DEBUG - üîç Relationship Details:
2025-11-08 11:36:43,789 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:36:43,789 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:36:43,789 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:36:43,789 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:36:43,789 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:36:43,789 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:36:43,789 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:36:43,789 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:36:43,789 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:36:43,789 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:36:43,789 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:36:43,789 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:36:43,789 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:36:43,789 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:36:43,790 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:36:43,790 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:36:44,393 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:36:44,408 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:36:44,408 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:36:44,421 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:36:44,425 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:36:44,428 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:36:44,430 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:36:44,433 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:36:44,435 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:36:44,438 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:36:44,441 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:36:44,443 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:36:44,446 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:36:44,449 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:36:44,452 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:36:44,454 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:36:44,457 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:36:44,462 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:36:44,466 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:44,466 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:36:44,470 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:36:44,470 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:36:44,474 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:44,474 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:36:44,478 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:44,478 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:36:44,483 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:44,483 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:36:44,487 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:36:44,487 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:36:44,491 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:36:44,491 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:36:44,491 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:36:44,495 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:36:44,495 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:36:44,495 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:36:44,499 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:36:44,504 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:36:44,504 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:36:44,504 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:36:44,504 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:36:44,504 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:36:44,508 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:36:44,512 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:36:44,512 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:36:44,512 - DEBUG - üîç Relationship Details:
2025-11-08 11:36:44,512 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:36:44,512 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:36:44,512 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:36:44,512 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:36:44,512 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:36:44,512 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:36:44,512 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:36:44,512 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:36:44,512 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:36:44,512 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:36:44,512 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:36:44,512 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:36:44,512 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:36:44,512 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:36:48,347 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:36:48,348 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:36:48,348 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:36:48,484 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:36:48,647 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:36:48,663 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:36:48,663 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:36:48,679 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:36:48,695 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:36:48,704 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:36:48,724 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:36:48,730 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:36:48,733 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:36:48,736 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:36:48,739 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:36:48,741 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:36:48,744 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:36:48,746 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:36:48,750 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:36:48,753 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:36:48,755 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:36:48,758 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:36:48,761 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:36:48,764 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:36:48,769 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:36:48,773 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:48,773 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:36:48,777 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:36:48,777 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:36:48,781 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:48,781 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:36:48,785 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:48,785 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:36:48,789 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:48,789 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:36:48,793 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:36:48,793 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:36:48,797 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:36:48,797 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:36:48,797 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:36:48,802 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:36:48,802 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:36:48,802 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:36:48,806 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:36:48,810 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:36:48,810 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:36:48,810 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:36:48,811 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:36:48,811 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:36:48,814 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:36:48,818 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:36:48,818 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:36:48,818 - DEBUG - üîç Relationship Details:
2025-11-08 11:36:48,819 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:36:48,819 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:36:48,819 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:36:48,819 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:36:48,819 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:36:48,819 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:36:48,819 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:36:48,819 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:36:48,819 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:36:48,819 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:36:48,819 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:36:48,819 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:36:48,819 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:36:48,819 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:36:48,820 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:36:48,820 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:36:49,430 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:36:49,445 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:36:49,446 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:36:49,458 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:36:49,462 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:36:49,465 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:36:49,468 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:36:49,470 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:36:49,473 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:36:49,475 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:36:49,478 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:36:49,481 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:36:49,484 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:36:49,487 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:36:49,490 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:36:49,492 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:36:49,495 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:36:49,501 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:36:49,505 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:49,505 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:36:49,510 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:36:49,510 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:36:49,514 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:49,514 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:36:49,518 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:49,518 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:36:49,524 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:36:49,524 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:36:49,528 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:36:49,528 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:36:49,532 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:36:49,532 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:36:49,532 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:36:49,536 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:36:49,537 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:36:49,537 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:36:49,541 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:36:49,546 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:36:49,546 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:36:49,546 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:36:49,546 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:36:49,546 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:36:49,550 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:36:49,554 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:36:49,554 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:36:49,554 - DEBUG - üîç Relationship Details:
2025-11-08 11:36:49,554 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:36:49,554 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:36:49,554 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:36:49,554 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:36:49,554 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:36:49,554 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:36:49,555 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:36:49,555 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:36:49,555 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:36:49,555 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:36:49,555 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:36:49,555 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:36:49,555 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:36:49,555 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:37:14,636 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:37:14,636 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:37:14,636 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:37:14,773 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:37:14,936 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:37:14,951 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:37:14,951 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:37:14,967 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:37:14,982 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:37:14,991 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:37:15,011 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:37:15,016 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:37:15,019 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:37:15,022 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:37:15,025 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:37:15,027 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:37:15,030 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:37:15,033 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:37:15,036 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:37:15,039 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:37:15,041 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:37:15,044 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:37:15,047 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:37:15,050 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:37:15,055 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:37:15,059 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:15,059 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:37:15,063 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:37:15,063 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:37:15,067 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:15,067 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:37:15,071 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:15,071 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:37:15,075 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:15,075 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:37:15,079 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:37:15,079 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:37:15,083 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:37:15,083 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:37:15,083 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:37:15,087 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:37:15,087 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:37:15,088 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:37:15,092 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:37:15,096 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:37:15,096 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:37:15,096 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:37:15,096 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:37:15,096 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:37:15,100 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:37:15,104 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:37:15,104 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:37:15,104 - DEBUG - üîç Relationship Details:
2025-11-08 11:37:15,104 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,104 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:37:15,104 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,104 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,104 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,105 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:37:15,105 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,105 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:37:15,105 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,105 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:37:15,105 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:37:15,105 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:37:15,105 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:37:15,105 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:37:15,105 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:37:15,106 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:37:15,700 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:37:15,716 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:37:15,716 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:37:15,728 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:37:15,733 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:37:15,735 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:37:15,738 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:37:15,740 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:37:15,743 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:37:15,745 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:37:15,748 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:37:15,751 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:37:15,753 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:37:15,756 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:37:15,759 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:37:15,761 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:37:15,764 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:37:15,770 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:37:15,774 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:15,774 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:37:15,778 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:37:15,778 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:37:15,782 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:15,782 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:37:15,787 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:15,787 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:37:15,792 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:15,792 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:37:15,796 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:37:15,796 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:37:15,800 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:37:15,800 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:37:15,800 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:37:15,804 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:37:15,804 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:37:15,804 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:37:15,808 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:37:15,812 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:37:15,813 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:37:15,813 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:37:15,813 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:37:15,813 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:37:15,817 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:37:15,821 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:37:15,821 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:37:15,821 - DEBUG - üîç Relationship Details:
2025-11-08 11:37:15,821 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,821 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:37:15,821 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,821 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,821 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,821 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:37:15,821 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,821 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:37:15,821 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:37:15,821 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:37:15,821 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:37:15,821 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:37:15,821 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:37:15,821 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:37:18,821 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:37:18,821 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:37:18,821 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:37:18,955 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:37:19,116 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:37:19,132 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:37:19,133 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:37:19,148 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:37:19,163 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:37:19,172 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:37:19,192 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:37:19,197 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:37:19,200 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:37:19,202 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:37:19,205 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:37:19,208 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:37:19,210 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:37:19,213 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:37:19,217 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:37:19,219 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:37:19,222 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:37:19,226 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:37:19,228 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:37:19,231 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:37:19,236 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:37:19,240 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:19,240 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:37:19,244 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:37:19,244 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:37:19,248 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:19,248 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:37:19,252 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:19,253 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:37:19,256 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:19,256 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:37:19,260 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:37:19,260 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:37:19,264 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:37:19,264 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:37:19,265 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:37:19,268 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:37:19,269 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:37:19,269 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:37:19,273 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:37:19,277 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:37:19,277 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:37:19,277 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:37:19,277 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:37:19,277 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:37:19,282 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:37:19,287 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:37:19,287 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:37:19,287 - DEBUG - üîç Relationship Details:
2025-11-08 11:37:19,287 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,287 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:37:19,287 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,287 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,287 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,287 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:37:19,287 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,287 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:37:19,287 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,287 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:37:19,287 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:37:19,287 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:37:19,287 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:37:19,287 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:37:19,288 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:37:19,288 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:37:19,871 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:37:19,887 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:37:19,887 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:37:19,900 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:37:19,904 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:37:19,907 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:37:19,910 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:37:19,912 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:37:19,915 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:37:19,917 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:37:19,920 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:37:19,924 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:37:19,927 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:37:19,930 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:37:19,933 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:37:19,936 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:37:19,939 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:37:19,944 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:37:19,948 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:19,948 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:37:19,952 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:37:19,952 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:37:19,956 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:19,956 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:37:19,960 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:19,960 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:37:19,965 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:37:19,965 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:37:19,969 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:37:19,969 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:37:19,973 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:37:19,973 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:37:19,973 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:37:19,978 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:37:19,978 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:37:19,978 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:37:19,982 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:37:19,986 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:37:19,987 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:37:19,987 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:37:19,987 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:37:19,987 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:37:19,991 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:37:19,994 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:37:19,995 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:37:19,995 - DEBUG - üîç Relationship Details:
2025-11-08 11:37:19,995 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,995 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:37:19,995 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,995 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,995 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,995 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:37:19,995 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,995 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:37:19,995 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:37:19,995 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:37:19,995 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:37:19,995 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:37:19,995 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:37:19,995 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:36,709 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:53:36,709 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:53:36,709 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:53:36,844 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:53:37,006 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:37,022 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:37,022 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:37,038 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:37,053 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:37,061 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:37,082 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:37,088 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:37,091 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:37,093 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:37,096 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:37,099 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:37,101 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:37,104 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:37,107 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:37,110 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:37,113 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:37,116 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:37,118 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:37,121 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:37,127 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:37,131 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:37,131 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:37,136 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:37,136 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:37,140 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:37,140 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:37,144 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:37,144 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:37,148 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:37,148 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:37,152 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:37,152 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:37,156 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:37,156 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:37,157 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:37,160 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:37,161 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:37,161 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:37,165 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:37,169 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:37,169 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:37,169 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:37,169 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:37,170 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:37,173 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:37,177 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:37,177 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:37,178 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:37,178 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,178 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:37,178 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,178 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,178 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,178 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:37,178 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,178 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:37,178 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,178 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:37,178 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:37,178 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:37,178 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:37,179 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:37,179 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:53:37,179 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:53:37,788 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:37,804 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:37,805 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:37,821 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:37,827 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:37,830 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:37,835 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:37,838 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:37,842 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:37,846 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:37,850 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:37,854 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:37,858 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:37,862 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:37,866 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:37,870 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:37,874 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:37,881 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:37,888 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:37,888 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:37,894 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:37,895 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:37,901 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:37,901 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:37,908 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:37,908 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:37,913 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:37,914 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:37,918 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:37,918 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:37,923 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:37,923 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:37,923 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:37,929 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:37,929 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:37,929 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:37,934 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:37,939 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:37,939 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:37,939 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:37,939 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:37,940 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:37,945 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:37,951 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:37,951 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:37,951 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:37,951 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,951 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:37,951 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,951 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,952 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,952 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:37,952 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,952 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:37,952 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:37,952 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:37,952 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:37,952 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:37,952 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:37,952 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:40,527 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:53:40,527 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:53:40,527 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:53:40,672 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:53:40,845 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:40,861 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:40,861 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:40,878 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:40,900 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:40,910 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:40,930 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:40,935 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:40,938 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:40,941 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:40,943 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:40,946 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:40,948 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:40,951 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:40,954 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:40,957 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:40,960 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:40,963 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:40,965 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:40,968 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:40,973 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:40,978 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:40,978 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:40,982 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:40,982 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:40,986 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:40,986 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:40,990 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:40,990 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:40,995 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:40,995 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:40,999 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:40,999 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:41,003 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:41,003 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:41,003 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:41,007 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:41,007 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:41,007 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:41,012 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:41,016 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:41,016 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:41,016 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:41,016 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:41,016 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:41,020 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:41,024 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:41,024 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:41,024 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:41,024 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,024 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:41,024 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,024 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,024 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,024 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:41,025 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,025 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:41,025 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,025 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:41,025 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:41,025 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:41,025 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:41,025 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:41,026 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:53:41,026 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:53:41,623 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:41,638 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:41,639 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:41,651 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:41,656 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:41,658 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:41,661 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:41,663 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:41,666 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:41,668 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:41,671 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:41,674 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:41,677 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:41,679 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:41,682 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:41,685 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:41,687 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:41,693 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:41,697 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:41,697 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:41,701 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:41,701 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:41,705 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:41,705 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:41,710 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:41,710 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:41,715 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:41,715 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:41,719 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:41,719 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:41,723 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:41,723 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:41,723 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:41,727 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:41,728 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:41,728 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:41,732 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:41,736 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:41,736 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:41,736 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:41,736 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:41,736 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:41,741 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:41,745 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:41,745 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:41,745 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:41,745 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,745 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:41,745 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,745 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,745 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,746 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:41,746 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,746 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:41,746 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:41,746 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:41,746 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:41,746 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:41,746 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:41,746 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:43,885 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:53:43,885 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:53:43,885 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:53:44,021 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:53:44,185 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:44,201 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:44,201 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:44,217 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:44,232 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:44,241 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:44,261 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:44,267 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:44,270 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:44,272 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:44,275 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:44,277 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:44,280 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:44,283 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:44,286 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:44,289 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:44,292 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:44,295 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:44,297 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:44,301 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:44,307 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:44,312 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:44,312 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:44,316 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:44,316 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:44,320 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:44,320 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:44,324 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:44,324 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:44,328 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:44,328 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:44,332 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:44,332 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:44,337 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:44,337 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:44,337 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:44,341 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:44,341 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:44,341 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:44,345 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:44,350 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:44,350 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:44,350 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:44,350 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:44,350 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:44,354 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:44,358 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:44,358 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:44,358 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:44,359 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:44,359 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:44,359 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:44,359 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:44,359 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:44,359 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:44,359 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:44,359 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:44,359 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:44,359 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:44,359 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:44,359 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:44,359 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:44,359 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:44,359 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:53:44,360 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:53:44,990 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:45,006 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:45,007 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:45,023 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:45,029 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:45,032 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:45,036 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:45,040 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:45,044 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:45,048 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:45,052 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:45,056 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:45,059 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:45,063 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:45,067 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:45,070 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:45,074 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:45,080 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:45,084 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:45,085 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:45,089 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:45,089 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:45,095 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:45,095 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:45,100 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:45,100 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:45,105 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:45,105 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:45,110 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:45,110 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:45,115 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:45,115 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:45,115 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:45,120 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:45,120 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:45,120 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:45,125 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:45,130 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:45,130 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:45,130 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:45,130 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:45,130 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:45,135 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:45,140 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:45,140 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:45,141 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:45,141 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:45,141 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:45,141 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:45,141 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:45,141 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:45,141 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:45,141 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:45,141 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:45,141 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:45,141 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:45,141 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:45,142 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:45,142 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:45,142 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:49,111 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:53:49,111 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:53:49,111 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:53:49,247 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:53:49,409 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:49,425 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:49,425 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:49,441 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:49,456 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:49,465 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:49,485 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:49,490 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:49,493 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:49,496 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:49,498 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:49,501 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:49,503 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:49,506 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:49,509 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:49,512 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:49,515 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:49,518 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:49,520 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:49,523 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:49,529 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:49,534 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:49,534 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:49,538 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:49,538 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:49,542 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:49,542 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:49,546 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:49,546 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:49,550 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:49,550 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:49,554 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:49,554 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:49,558 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:49,558 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:49,558 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:49,562 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:49,563 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:49,563 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:49,567 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:49,571 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:49,571 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:49,571 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:49,571 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:49,571 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:49,575 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:49,579 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:49,580 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:49,580 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:49,580 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:49,580 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:49,580 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:49,580 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:49,580 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:49,580 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:49,580 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:49,580 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:49,580 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:49,580 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:49,580 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:49,580 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:49,580 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:49,580 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:49,581 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:53:49,581 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:53:50,184 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:50,199 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:50,200 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:50,213 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:50,217 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:50,220 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:50,223 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:50,225 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:50,228 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:50,230 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:50,233 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:50,236 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:50,239 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:50,242 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:50,245 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:50,247 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:50,250 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:50,255 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:50,259 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:50,259 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:50,263 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:50,263 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:50,267 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:50,267 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:50,271 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:50,272 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:50,276 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:50,276 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:50,280 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:50,280 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:50,285 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:50,285 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:50,285 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:50,289 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:50,289 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:50,289 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:50,293 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:50,297 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:50,297 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:50,297 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:50,297 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:50,297 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:50,301 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:50,306 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:50,306 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:50,306 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:50,306 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:50,306 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:50,306 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:50,306 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:50,306 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:50,306 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:50,306 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:50,306 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:50,306 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:50,306 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:50,306 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:50,306 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:50,306 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:50,306 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:52,428 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:53:52,428 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:53:52,428 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:53:52,562 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:53:52,725 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:52,741 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:52,741 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:52,757 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:52,772 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:52,781 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:52,801 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:52,807 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:52,810 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:52,813 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:52,816 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:52,818 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:52,821 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:52,824 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:52,827 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:52,830 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:52,833 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:52,836 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:52,838 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:52,841 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:52,846 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:52,850 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:52,851 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:52,855 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:52,855 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:52,859 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:52,859 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:52,863 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:52,863 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:52,867 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:52,867 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:52,871 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:52,871 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:52,875 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:52,875 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:52,875 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:52,880 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:52,880 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:52,880 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:52,884 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:52,888 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:52,888 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:52,889 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:52,889 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:52,889 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:52,893 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:52,897 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:52,897 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:52,897 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:52,897 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:52,897 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:52,897 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:52,897 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:52,897 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:52,897 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:52,897 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:52,897 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:52,897 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:52,898 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:52,898 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:52,898 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:52,898 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:52,898 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:53:52,899 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:53:52,899 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:53:53,483 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:53:53,498 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:53:53,498 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:53:53,510 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:53:53,515 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:53:53,517 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:53:53,520 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:53:53,522 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:53:53,525 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:53:53,527 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:53:53,530 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:53:53,533 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:53:53,536 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:53:53,538 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:53:53,541 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:53:53,544 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:53:53,546 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:53:53,551 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:53:53,555 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:53,556 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:53,560 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:53:53,560 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:53:53,564 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:53,564 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:53:53,568 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:53,568 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:53:53,573 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:53:53,573 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:53:53,577 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:53:53,577 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:53:53,581 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:53:53,581 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:53:53,581 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:53:53,585 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:53:53,585 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:53:53,585 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:53:53,589 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:53:53,594 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:53:53,594 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:53:53,594 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:53:53,594 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:53:53,594 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:53:53,598 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:53:53,602 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:53:53,602 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:53:53,602 - DEBUG - üîç Relationship Details:
2025-11-08 11:53:53,602 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:53,602 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:53:53,602 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:53:53,602 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:53:53,602 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:53:53,602 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:53:53,602 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:53:53,603 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:53:53,603 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:53:53,603 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:53:53,603 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:53:53,603 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:53:53,603 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:53:53,603 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:54:29,420 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:54:29,420 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:54:29,420 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:54:29,554 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:54:29,716 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:29,733 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:54:29,733 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:29,748 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:29,763 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:54:29,772 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:54:29,792 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:54:29,798 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:54:29,801 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:54:29,803 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:54:29,806 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:54:29,809 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:54:29,811 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:54:29,814 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:54:29,818 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:54:29,821 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:54:29,824 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:54:29,828 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:54:29,830 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:54:29,833 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:54:29,839 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:54:29,843 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:29,843 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:54:29,848 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:54:29,848 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:54:29,852 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:29,853 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:54:29,857 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:29,857 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:54:29,861 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:29,861 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:54:29,865 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:54:29,866 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:54:29,870 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:54:29,870 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:54:29,870 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:54:29,874 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:54:29,874 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:54:29,874 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:54:29,878 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:54:29,883 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:54:29,883 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:54:29,883 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:54:29,883 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:54:29,883 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:54:29,887 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:54:29,892 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:54:29,892 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:54:29,892 - DEBUG - üîç Relationship Details:
2025-11-08 11:54:29,892 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:54:29,892 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:54:29,892 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:54:29,892 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:54:29,892 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:54:29,892 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:54:29,892 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:54:29,892 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:54:29,892 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:54:29,892 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:54:29,892 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:54:29,893 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:54:29,893 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:54:29,893 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:54:29,893 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:54:29,893 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:54:34,481 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:54:34,481 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:54:34,481 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:54:34,614 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:54:34,775 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:34,790 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:54:34,790 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:34,806 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:34,820 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:54:34,829 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:54:34,849 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:54:34,854 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:54:34,856 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:54:34,859 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:54:34,862 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:54:34,864 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:54:34,866 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:54:34,869 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:54:34,873 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:54:34,875 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:54:34,878 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:54:34,881 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:54:34,883 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:54:34,886 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:54:34,891 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:54:34,895 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:34,895 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:54:34,900 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:54:34,900 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:54:34,903 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:34,903 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:54:34,908 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:34,908 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:54:34,912 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:34,912 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:54:34,916 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:54:34,916 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:54:34,920 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:54:34,920 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:54:34,920 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:54:34,924 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:54:34,924 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:54:34,924 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:54:34,928 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:54:34,933 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:54:34,933 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:54:34,933 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:54:34,933 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:54:34,933 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:54:34,937 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:54:34,940 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:54:34,941 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:54:34,941 - DEBUG - üîç Relationship Details:
2025-11-08 11:54:34,941 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:54:34,941 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:54:34,941 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:54:34,941 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:54:34,941 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:54:34,941 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:54:34,941 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:54:34,941 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:54:34,941 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:54:34,941 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:54:34,941 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:54:34,941 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:54:34,941 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:54:34,941 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:54:34,942 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:54:34,942 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:54:50,491 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:54:50,492 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:54:50,492 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:54:50,625 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:54:50,787 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:50,803 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:54:50,803 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:50,818 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:50,833 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:54:50,841 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:54:50,861 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:54:50,868 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:54:50,871 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:54:50,874 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:54:50,877 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:54:50,879 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:54:50,882 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:54:50,885 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:54:50,888 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:54:50,891 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:54:50,894 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:54:50,897 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:54:50,899 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:54:50,902 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:54:50,908 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:54:50,912 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:50,912 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:54:50,916 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:54:50,916 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:54:50,920 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:50,920 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:54:50,924 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:50,924 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:54:50,928 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:50,928 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:54:50,932 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:54:50,932 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:54:50,937 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:54:50,937 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:54:50,937 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:54:50,941 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:54:50,941 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:54:50,941 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:54:50,945 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:54:50,949 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:54:50,950 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:54:50,950 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:54:50,950 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:54:50,950 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:54:50,954 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:54:50,958 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:54:50,958 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:54:50,958 - DEBUG - üîç Relationship Details:
2025-11-08 11:54:50,958 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:54:50,958 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:54:50,958 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:54:50,958 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:54:50,958 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:54:50,958 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:54:50,958 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:54:50,958 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:54:50,958 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:54:50,959 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:54:50,959 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:54:50,959 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:54:50,959 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:54:50,959 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:54:50,959 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:54:50,959 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:54:53,981 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:54:53,981 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:54:53,981 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:54:54,114 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:54:54,276 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:54,292 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:54:54,292 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:54,307 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:54:54,322 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:54:54,331 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:54:54,351 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:54:54,357 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:54:54,360 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:54:54,362 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:54:54,366 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:54:54,368 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:54:54,371 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:54:54,375 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:54:54,378 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:54:54,381 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:54:54,384 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:54:54,388 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:54:54,390 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:54:54,393 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:54:54,399 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:54:54,403 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:54,404 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:54:54,409 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:54:54,409 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:54:54,413 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:54,413 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:54:54,417 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:54,417 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:54:54,421 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:54:54,421 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:54:54,426 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:54:54,426 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:54:54,430 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:54:54,430 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:54:54,430 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:54:54,435 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:54:54,435 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:54:54,435 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:54:54,439 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:54:54,444 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:54:54,444 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:54:54,444 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:54:54,444 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:54:54,444 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:54:54,448 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:54:54,452 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:54:54,452 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:54:54,452 - DEBUG - üîç Relationship Details:
2025-11-08 11:54:54,452 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:54:54,453 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:54:54,453 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:54:54,453 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:54:54,453 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:54:54,453 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:54:54,453 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:54:54,453 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:54:54,453 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:54:54,453 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:54:54,453 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:54:54,453 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:54:54,453 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:54:54,453 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:54:54,454 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:54:54,454 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:55:02,367 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:55:02,367 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:55:02,367 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:55:02,501 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:55:02,662 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:02,678 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:02,678 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:02,694 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:02,709 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:02,718 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:55:02,737 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:55:02,743 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:55:02,746 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:55:02,749 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:55:02,751 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:55:02,754 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:55:02,756 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:55:02,759 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:55:02,763 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:55:02,765 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:55:02,768 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:55:02,771 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:55:02,774 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:55:02,777 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:55:02,782 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:55:02,786 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:02,786 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:02,790 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:55:02,790 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:55:02,794 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:02,794 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:02,798 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:02,798 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:55:02,802 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:02,802 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:55:02,806 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:55:02,806 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:55:02,811 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:55:02,811 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:55:02,811 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:55:02,815 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:55:02,815 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:55:02,815 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:55:02,819 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:55:02,823 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:55:02,823 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:55:02,823 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:55:02,824 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:55:02,824 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:55:02,827 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:55:02,831 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:55:02,831 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:55:02,831 - DEBUG - üîç Relationship Details:
2025-11-08 11:55:02,832 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:02,832 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:55:02,832 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:02,832 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:55:02,832 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:55:02,832 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:55:02,832 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:55:02,832 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:55:02,832 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:55:02,832 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:55:02,832 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:55:02,832 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:55:02,832 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:55:02,832 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:55:02,833 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:55:02,833 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:55:13,570 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:55:13,570 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:55:13,570 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:55:13,707 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:55:13,873 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:13,888 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:13,889 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:13,904 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:13,919 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:13,928 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:55:13,948 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:55:13,954 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:55:13,957 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:55:13,959 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:55:13,962 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:55:13,964 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:55:13,967 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:55:13,970 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:55:13,973 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:55:13,976 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:55:13,978 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:55:13,981 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:55:13,984 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:55:13,987 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:55:13,992 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:55:13,996 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:13,996 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:14,000 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:55:14,000 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:55:14,004 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:14,004 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:14,008 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:14,009 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:55:14,012 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:14,012 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:55:14,016 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:55:14,016 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:55:14,020 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:55:14,020 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:55:14,021 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:55:14,025 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:55:14,025 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:55:14,025 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:55:14,029 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:55:14,033 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:55:14,034 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:55:14,034 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:55:14,034 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:55:14,034 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:55:14,038 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:55:14,042 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:55:14,042 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:55:14,042 - DEBUG - üîç Relationship Details:
2025-11-08 11:55:14,042 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:14,042 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:55:14,042 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:14,042 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:55:14,042 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:55:14,042 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:55:14,042 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:55:14,042 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:55:14,042 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:55:14,042 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:55:14,042 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:55:14,042 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:55:14,043 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:55:14,043 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:55:14,043 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:55:14,043 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:55:42,352 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:55:42,352 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:55:42,353 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:55:42,490 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:55:42,654 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:42,670 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:42,670 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:42,686 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:42,702 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:42,711 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:55:42,731 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:55:42,737 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:55:42,739 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:55:42,742 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:55:42,745 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:55:42,748 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:55:42,751 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:55:42,754 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:55:42,757 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:55:42,760 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:55:42,762 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:55:42,765 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:55:42,768 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:55:42,771 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:55:42,776 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:55:42,780 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:42,780 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:42,785 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:55:42,785 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:55:42,789 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:42,789 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:42,792 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:42,793 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:55:42,797 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:42,797 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:55:42,801 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:55:42,801 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:55:42,805 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:55:42,805 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:55:42,805 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:55:42,809 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:55:42,809 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:55:42,809 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:55:42,814 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:55:42,818 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:55:42,818 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:55:42,818 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:55:42,818 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:55:42,818 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:55:42,822 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:55:42,826 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:55:42,826 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:55:42,826 - DEBUG - üîç Relationship Details:
2025-11-08 11:55:42,827 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:42,827 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:55:42,827 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:42,827 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:55:42,827 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:55:42,827 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:55:42,827 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:55:42,827 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:55:42,827 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:55:42,827 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:55:42,827 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:55:42,827 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:55:42,827 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:55:42,827 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:55:42,828 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:55:42,828 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:55:45,894 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:55:45,894 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:55:45,894 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:55:46,028 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:55:46,189 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:46,205 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:46,205 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:46,221 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:46,236 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:46,244 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:55:46,264 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:55:46,270 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:55:46,272 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:55:46,275 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:55:46,278 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:55:46,280 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:55:46,282 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:55:46,285 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:55:46,289 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:55:46,291 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:55:46,294 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:55:46,297 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:55:46,300 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:55:46,303 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:55:46,308 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:55:46,312 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:46,312 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:46,316 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:55:46,316 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:55:46,321 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:46,321 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:46,325 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:46,325 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:55:46,330 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:46,330 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:55:46,334 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:55:46,334 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:55:46,338 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:55:46,338 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:55:46,339 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:55:46,343 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:55:46,343 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:55:46,343 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:55:46,347 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:55:46,352 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:55:46,352 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:55:46,352 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:55:46,352 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:55:46,353 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:55:46,358 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:55:46,362 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:55:46,362 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:55:46,362 - DEBUG - üîç Relationship Details:
2025-11-08 11:55:46,362 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:46,362 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:55:46,362 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:46,362 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:55:46,362 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:55:46,362 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:55:46,362 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:55:46,363 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:55:46,363 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:55:46,363 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:55:46,363 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:55:46,363 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:55:46,363 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:55:46,363 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:55:46,363 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:55:46,363 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:55:53,506 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:55:53,506 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:55:53,506 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:55:53,641 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:55:53,808 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:53,824 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:53,824 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:53,840 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:53,856 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:53,865 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:55:53,884 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:55:53,890 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:55:53,893 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:55:53,895 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:55:53,898 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:55:53,901 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:55:53,904 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:55:53,906 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:55:53,910 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:55:53,913 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:55:53,916 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:55:53,919 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:55:53,921 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:55:53,924 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:55:53,930 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:55:53,934 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:53,934 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:53,939 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:55:53,939 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:55:53,943 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:53,943 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:53,947 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:53,947 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:55:53,951 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:53,951 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:55:53,955 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:55:53,955 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:55:53,959 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:55:53,959 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:55:53,959 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:55:53,963 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:55:53,963 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:55:53,963 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:55:53,967 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:55:53,972 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:55:53,972 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:55:53,972 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:55:53,972 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:55:53,972 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:55:53,976 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:55:53,980 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:55:53,980 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:55:53,980 - DEBUG - üîç Relationship Details:
2025-11-08 11:55:53,980 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:53,980 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:55:53,981 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:53,981 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:55:53,981 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:55:53,981 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:55:53,981 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:55:53,981 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:55:53,981 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:55:53,981 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:55:53,981 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:55:53,981 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:55:53,981 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:55:53,981 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:55:53,982 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:55:53,982 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:55:57,124 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:55:57,124 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:55:57,124 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:55:57,268 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:55:57,451 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:57,467 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:57,467 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:57,482 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:55:57,497 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:55:57,506 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:55:57,528 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:55:57,534 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:55:57,537 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:55:57,540 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:55:57,544 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:55:57,547 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:55:57,550 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:55:57,552 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:55:57,556 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:55:57,559 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:55:57,562 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:55:57,566 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:55:57,569 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:55:57,572 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:55:57,578 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:55:57,584 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:57,584 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:57,590 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:55:57,590 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:55:57,597 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:57,597 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:55:57,602 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:57,602 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:55:57,608 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:55:57,608 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:55:57,613 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:55:57,613 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:55:57,621 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:55:57,621 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:55:57,621 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:55:57,630 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:55:57,630 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:55:57,630 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:55:57,635 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:55:57,639 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:55:57,639 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:55:57,639 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:55:57,639 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:55:57,639 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:55:57,643 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:55:57,647 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:55:57,647 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:55:57,648 - DEBUG - üîç Relationship Details:
2025-11-08 11:55:57,648 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:57,648 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:55:57,648 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:55:57,648 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:55:57,648 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:55:57,648 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:55:57,648 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:55:57,648 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:55:57,648 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:55:57,648 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:55:57,648 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:55:57,648 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:55:57,648 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:55:57,648 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:55:57,649 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:55:57,649 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:00,875 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:00,875 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:00,875 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:01,012 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:01,176 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:01,192 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:01,192 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:01,208 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:01,229 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:01,237 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:01,257 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:01,263 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:01,265 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:01,268 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:01,271 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:01,273 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:01,276 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:01,278 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:01,282 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:01,284 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:01,287 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:01,290 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:01,293 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:01,296 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:01,301 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:01,305 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:01,305 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:01,309 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:01,309 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:01,313 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:01,313 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:01,318 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:01,318 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:01,322 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:01,322 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:01,326 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:01,326 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:01,330 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:01,330 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:01,330 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:01,334 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:01,334 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:01,334 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:01,339 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:01,343 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:01,343 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:01,343 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:01,344 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:01,344 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:01,347 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:01,351 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:01,351 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:01,351 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:01,351 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:01,352 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:01,352 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:01,352 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:01,352 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:01,352 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:01,352 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:01,352 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:01,352 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:01,352 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:01,352 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:01,352 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:01,352 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:01,352 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:01,353 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:01,353 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:04,414 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:04,415 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:04,415 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:04,548 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:04,710 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:04,725 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:04,725 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:04,741 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:04,756 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:04,764 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:04,783 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:04,789 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:04,792 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:04,795 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:04,797 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:04,799 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:04,802 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:04,805 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:04,808 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:04,811 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:04,814 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:04,817 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:04,819 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:04,822 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:04,827 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:04,831 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:04,831 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:04,835 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:04,836 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:04,840 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:04,840 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:04,844 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:04,844 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:04,848 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:04,848 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:04,852 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:04,852 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:04,858 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:04,858 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:04,858 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:04,862 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:04,862 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:04,862 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:04,866 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:04,871 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:04,871 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:04,871 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:04,871 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:04,871 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:04,875 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:04,879 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:04,879 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:04,880 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:04,880 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:04,880 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:04,880 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:04,880 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:04,880 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:04,880 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:04,880 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:04,880 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:04,880 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:04,880 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:04,880 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:04,880 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:04,880 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:04,880 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:04,881 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:04,881 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:14,903 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:14,903 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:14,903 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:15,038 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:15,201 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:15,217 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:15,217 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:15,233 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:15,249 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:15,258 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:15,277 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:15,283 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:15,285 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:15,288 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:15,290 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:15,293 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:15,295 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:15,298 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:15,302 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:15,305 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:15,307 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:15,310 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:15,313 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:15,315 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:15,321 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:15,325 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:15,325 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:15,330 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:15,330 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:15,334 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:15,334 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:15,338 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:15,338 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:15,343 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:15,343 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:15,347 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:15,347 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:15,351 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:15,352 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:15,352 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:15,356 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:15,356 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:15,356 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:15,360 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:15,365 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:15,365 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:15,365 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:15,365 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:15,365 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:15,369 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:15,373 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:15,373 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:15,373 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:15,373 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:15,373 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:15,374 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:15,374 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:15,374 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:15,374 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:15,374 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:15,374 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:15,374 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:15,374 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:15,374 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:15,374 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:15,374 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:15,374 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:15,375 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:15,375 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:18,528 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:18,529 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:18,529 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:18,664 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:18,826 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:18,841 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:18,841 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:18,857 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:18,872 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:18,880 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:18,900 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:18,906 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:18,908 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:18,911 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:18,914 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:18,916 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:18,919 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:18,922 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:18,925 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:18,928 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:18,931 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:18,934 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:18,936 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:18,939 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:18,944 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:18,949 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:18,949 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:18,953 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:18,953 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:18,958 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:18,958 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:18,962 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:18,962 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:18,966 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:18,966 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:18,970 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:18,970 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:18,974 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:18,974 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:18,974 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:18,978 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:18,978 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:18,978 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:18,982 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:18,986 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:18,986 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:18,987 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:18,987 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:18,987 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:18,991 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:18,995 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:18,995 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:18,995 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:18,995 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:18,995 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:18,995 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:18,995 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:18,995 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:18,995 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:18,995 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:18,995 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:18,995 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:18,995 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:18,995 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:18,995 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:18,995 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:18,996 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:18,996 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:18,996 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:27,676 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:27,676 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:27,676 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:27,810 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:27,972 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:27,988 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:27,988 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:28,004 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:28,019 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:28,028 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:28,048 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:28,054 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:28,057 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:28,059 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:28,062 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:28,064 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:28,067 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:28,069 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:28,073 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:28,075 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:28,078 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:28,081 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:28,083 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:28,086 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:28,091 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:28,096 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:28,096 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:28,100 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:28,100 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:28,104 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:28,104 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:28,108 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:28,108 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:28,112 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:28,112 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:28,116 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:28,116 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:28,120 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:28,120 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:28,120 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:28,124 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:28,124 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:28,124 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:28,128 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:28,132 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:28,132 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:28,132 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:28,132 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:28,132 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:28,136 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:28,140 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:28,140 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:28,140 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:28,140 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:28,140 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:28,140 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:28,140 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:28,140 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:28,140 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:28,140 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:28,140 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:28,140 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:28,140 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:28,141 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:28,141 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:28,141 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:28,141 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:28,141 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:28,141 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:30,958 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:30,958 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:30,958 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:31,092 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:31,254 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:31,270 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:31,270 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:31,286 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:31,301 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:31,310 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:31,330 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:31,336 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:31,339 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:31,341 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:31,344 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:31,347 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:31,350 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:31,353 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:31,357 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:31,359 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:31,362 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:31,365 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:31,368 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:31,370 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:31,376 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:31,380 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:31,380 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:31,384 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:31,384 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:31,388 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:31,388 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:31,392 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:31,392 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:31,396 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:31,396 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:31,400 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:31,400 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:31,404 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:31,404 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:31,404 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:31,408 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:31,408 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:31,409 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:31,413 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:31,417 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:31,417 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:31,417 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:31,417 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:31,417 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:31,421 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:31,425 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:31,425 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:31,425 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:31,425 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:31,425 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:31,425 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:31,425 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:31,425 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:31,426 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:31,426 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:31,426 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:31,426 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:31,426 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:31,426 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:31,426 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:31,426 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:31,426 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:31,426 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:31,426 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:38,132 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:38,132 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:38,132 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:38,269 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:38,433 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:38,448 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:38,449 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:38,464 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:38,479 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:38,488 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:38,508 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:38,513 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:38,516 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:38,519 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:38,521 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:38,524 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:38,526 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:38,529 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:38,532 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:38,535 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:38,538 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:38,541 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:38,543 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:38,546 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:38,551 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:38,555 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:38,555 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:38,559 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:38,559 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:38,563 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:38,563 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:38,568 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:38,568 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:38,572 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:38,572 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:38,576 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:38,576 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:38,580 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:38,580 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:38,580 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:38,585 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:38,585 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:38,585 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:38,589 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:38,593 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:38,593 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:38,593 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:38,593 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:38,593 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:38,597 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:38,601 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:38,601 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:38,601 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:38,601 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:38,601 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:38,602 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:38,602 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:38,602 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:38,602 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:38,602 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:38,602 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:38,602 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:38,602 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:38,602 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:38,602 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:38,602 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:38,602 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:38,603 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:38,603 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:41,671 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:41,671 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:41,671 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:41,806 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:41,968 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:41,984 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:41,984 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:42,000 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:42,015 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:42,024 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:42,044 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:42,049 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:42,052 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:42,055 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:42,057 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:42,060 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:42,062 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:42,065 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:42,069 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:42,071 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:42,074 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:42,077 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:42,079 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:42,082 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:42,088 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:42,092 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:42,092 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:42,097 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:42,097 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:42,102 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:42,102 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:42,106 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:42,106 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:42,111 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:42,111 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:42,116 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:42,116 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:42,120 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:42,120 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:42,120 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:42,124 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:42,125 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:42,125 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:42,129 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:42,134 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:42,134 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:42,134 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:42,134 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:42,134 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:42,138 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:42,142 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:42,143 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:42,143 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:42,143 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:42,143 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:42,143 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:42,143 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:42,143 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:42,143 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:42,143 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:42,143 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:42,143 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:42,143 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:42,143 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:42,143 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:42,143 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:42,143 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:42,144 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:42,144 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:45,097 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:45,097 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:45,097 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:45,233 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:45,398 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:45,413 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:45,413 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:45,429 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:45,444 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:45,453 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:45,473 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:45,478 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:45,481 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:45,484 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:45,486 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:45,489 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:45,492 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:45,494 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:45,498 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:45,501 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:45,503 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:45,506 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:45,509 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:45,511 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:45,517 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:45,521 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:45,521 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:45,525 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:45,525 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:45,529 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:45,529 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:45,533 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:45,533 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:45,537 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:45,537 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:45,541 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:45,541 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:45,545 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:45,545 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:45,545 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:45,549 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:45,550 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:45,550 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:45,554 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:45,558 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:45,558 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:45,558 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:45,558 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:45,558 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:45,562 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:45,566 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:45,566 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:45,566 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:45,566 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:45,567 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:45,567 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:45,567 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:45,567 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:45,567 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:45,567 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:45,567 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:45,567 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:45,567 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:45,567 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:45,567 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:45,567 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:45,567 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:45,568 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:45,568 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 11:56:49,913 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 11:56:49,913 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 11:56:49,914 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 11:56:50,048 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 11:56:50,209 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:50,225 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:50,225 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:50,243 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 11:56:50,258 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 11:56:50,267 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 11:56:50,287 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 11:56:50,292 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 11:56:50,295 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 11:56:50,298 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 11:56:50,300 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 11:56:50,303 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 11:56:50,305 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 11:56:50,308 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 11:56:50,311 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 11:56:50,314 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 11:56:50,317 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 11:56:50,320 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 11:56:50,322 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 11:56:50,325 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 11:56:50,331 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 11:56:50,335 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:50,335 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:50,339 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 11:56:50,339 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 11:56:50,344 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:50,344 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 11:56:50,348 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:50,348 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 11:56:50,352 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 11:56:50,352 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 11:56:50,356 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 11:56:50,356 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 11:56:50,360 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 11:56:50,360 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 11:56:50,360 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 11:56:50,364 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 11:56:50,364 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 11:56:50,365 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 11:56:50,369 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 11:56:50,373 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 11:56:50,373 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 11:56:50,373 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 11:56:50,373 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 11:56:50,373 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 11:56:50,377 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 11:56:50,381 - DEBUG - üîó Foreign keys for users: []
2025-11-08 11:56:50,381 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 11:56:50,381 - DEBUG - üîç Relationship Details:
2025-11-08 11:56:50,381 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:50,381 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 11:56:50,381 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 11:56:50,381 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 11:56:50,381 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 11:56:50,381 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 11:56:50,381 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 11:56:50,381 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 11:56:50,382 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 11:56:50,382 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 11:56:50,382 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 11:56:50,382 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 11:56:50,382 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 11:56:50,382 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 11:56:50,383 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 11:56:50,383 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 12:13:44,792 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 12:13:44,792 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 12:13:44,792 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 12:13:44,927 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 12:13:45,089 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 12:13:45,105 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 12:13:45,105 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 12:13:45,120 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 12:13:45,135 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 12:13:45,143 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 12:13:45,163 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 12:13:45,169 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 12:13:45,171 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 12:13:45,174 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 12:13:45,176 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 12:13:45,179 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 12:13:45,181 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 12:13:45,184 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 12:13:45,188 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 12:13:45,190 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 12:13:45,193 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 12:13:45,196 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 12:13:45,198 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 12:13:45,201 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 12:13:45,207 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 12:13:45,211 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:45,211 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 12:13:45,215 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 12:13:45,215 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 12:13:45,220 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:45,220 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 12:13:45,223 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:45,224 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 12:13:45,228 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:45,228 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 12:13:45,231 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 12:13:45,232 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 12:13:45,235 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 12:13:45,235 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 12:13:45,236 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 12:13:45,239 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 12:13:45,240 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 12:13:45,240 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 12:13:45,244 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 12:13:45,248 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 12:13:45,248 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 12:13:45,248 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 12:13:45,248 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 12:13:45,248 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 12:13:45,252 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 12:13:45,256 - DEBUG - üîó Foreign keys for users: []
2025-11-08 12:13:45,257 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 12:13:45,257 - DEBUG - üîç Relationship Details:
2025-11-08 12:13:45,257 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 12:13:45,257 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 12:13:45,257 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 12:13:45,257 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 12:13:45,257 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 12:13:45,257 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 12:13:45,257 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 12:13:45,257 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 12:13:45,257 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 12:13:45,257 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 12:13:45,257 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 12:13:45,258 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 12:13:45,258 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 12:13:45,258 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 12:13:45,258 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 12:13:45,259 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 12:13:48,174 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 12:13:48,174 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 12:13:48,174 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 12:13:48,308 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 12:13:48,469 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 12:13:48,485 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 12:13:48,485 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 12:13:48,501 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 12:13:48,515 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 12:13:48,524 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 12:13:48,543 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 12:13:48,549 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 12:13:48,551 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 12:13:48,554 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 12:13:48,556 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 12:13:48,559 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 12:13:48,561 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 12:13:48,564 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 12:13:48,567 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 12:13:48,570 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 12:13:48,573 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 12:13:48,576 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 12:13:48,578 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 12:13:48,581 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 12:13:48,586 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 12:13:48,590 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:48,590 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 12:13:48,594 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 12:13:48,594 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 12:13:48,598 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:48,598 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 12:13:48,602 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:48,603 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 12:13:48,607 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:48,607 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 12:13:48,611 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 12:13:48,611 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 12:13:48,615 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 12:13:48,615 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 12:13:48,615 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 12:13:48,619 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 12:13:48,619 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 12:13:48,619 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 12:13:48,623 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 12:13:48,628 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 12:13:48,628 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 12:13:48,628 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 12:13:48,628 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 12:13:48,628 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 12:13:48,632 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 12:13:48,636 - DEBUG - üîó Foreign keys for users: []
2025-11-08 12:13:48,636 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 12:13:48,636 - DEBUG - üîç Relationship Details:
2025-11-08 12:13:48,636 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 12:13:48,636 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 12:13:48,636 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 12:13:48,636 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 12:13:48,636 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 12:13:48,636 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 12:13:48,637 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 12:13:48,637 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 12:13:48,637 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 12:13:48,637 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 12:13:48,637 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 12:13:48,637 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 12:13:48,637 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 12:13:48,637 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 12:13:48,637 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 12:13:48,637 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 12:13:49,249 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 12:13:49,265 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 12:13:49,265 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 12:13:49,277 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 12:13:49,282 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 12:13:49,285 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 12:13:49,288 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 12:13:49,291 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 12:13:49,294 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 12:13:49,297 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 12:13:49,300 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 12:13:49,303 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 12:13:49,307 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 12:13:49,309 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 12:13:49,313 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 12:13:49,316 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 12:13:49,319 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 12:13:49,324 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 12:13:49,329 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:49,329 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 12:13:49,334 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 12:13:49,334 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 12:13:49,338 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:49,338 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 12:13:49,342 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:49,343 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 12:13:49,347 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 12:13:49,347 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 12:13:49,351 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 12:13:49,352 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 12:13:49,356 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 12:13:49,356 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 12:13:49,356 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 12:13:49,360 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 12:13:49,360 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 12:13:49,360 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 12:13:49,365 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 12:13:49,369 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 12:13:49,370 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 12:13:49,370 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 12:13:49,370 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 12:13:49,370 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 12:13:49,374 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 12:13:49,378 - DEBUG - üîó Foreign keys for users: []
2025-11-08 12:13:49,378 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 12:13:49,378 - DEBUG - üîç Relationship Details:
2025-11-08 12:13:49,378 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 12:13:49,378 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 12:13:49,378 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 12:13:49,378 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 12:13:49,379 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 12:13:49,379 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 12:13:49,379 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 12:13:49,379 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 12:13:49,379 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 12:13:49,379 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 12:13:49,379 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 12:13:49,379 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 12:13:49,379 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 12:13:49,379 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 12:17:59,643 - INFO - Database engine created with pool_size=10
2025-11-08 12:17:59,645 - ERROR - Database session error in FastAPI dependency: 400: Sensor ID in path must match sensor ID in request body
2025-11-08 12:18:16,675 - ERROR - Database session error in FastAPI dependency: 400: Sensor ID in path must match sensor ID in request body
2025-11-08 12:18:45,704 - ERROR - Database session error in FastAPI dependency: 400: Sensor ID in path must match sensor ID in request body
2025-11-08 15:52:20,702 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 15:52:20,702 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 15:52:20,702 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 15:52:20,945 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 15:52:21,278 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 15:52:21,305 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 15:52:21,306 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 15:52:21,321 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 15:52:21,336 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 15:52:21,394 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 15:52:21,557 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 15:52:21,562 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 15:52:21,565 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 15:52:21,568 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 15:52:21,570 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 15:52:21,573 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 15:52:21,575 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 15:52:21,578 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 15:52:21,581 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 15:52:21,584 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 15:52:21,587 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 15:52:21,590 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 15:52:21,592 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 15:52:21,595 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 15:52:21,601 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 15:52:21,605 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 15:52:21,605 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 15:52:21,609 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 15:52:21,609 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 15:52:21,613 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 15:52:21,613 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 15:52:21,617 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 15:52:21,617 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 15:52:21,621 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 15:52:21,621 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 15:52:21,625 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 15:52:21,625 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 15:52:21,629 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 15:52:21,629 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 15:52:21,629 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 15:52:21,634 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 15:52:21,634 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 15:52:21,634 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 15:52:21,638 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 15:52:21,642 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 15:52:21,642 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 15:52:21,642 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 15:52:21,642 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 15:52:21,642 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 15:52:21,646 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 15:52:21,650 - DEBUG - üîó Foreign keys for users: []
2025-11-08 15:52:21,650 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 15:52:21,650 - DEBUG - üîç Relationship Details:
2025-11-08 15:52:21,650 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 15:52:21,651 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 15:52:21,651 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 15:52:21,651 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 15:52:21,651 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 15:52:21,651 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 15:52:21,651 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 15:52:21,651 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 15:52:21,651 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 15:52:21,651 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 15:52:21,651 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 15:52:21,651 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 15:52:21,651 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 15:52:21,651 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 15:52:21,677 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 15:52:21,677 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 15:52:24,259 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 15:52:24,274 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 15:52:24,274 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 15:52:24,287 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 15:52:24,291 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 15:52:24,294 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 15:52:24,297 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 15:52:24,299 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 15:52:24,302 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 15:52:24,304 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 15:52:24,307 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 15:52:24,310 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 15:52:24,313 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 15:52:24,316 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 15:52:24,319 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 15:52:24,321 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 15:52:24,325 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 15:52:24,331 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 15:52:24,337 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 15:52:24,337 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 15:52:24,342 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 15:52:24,342 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 15:52:24,346 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 15:52:24,346 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 15:52:24,350 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 15:52:24,350 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 15:52:24,354 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 15:52:24,354 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 15:52:24,358 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 15:52:24,358 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 15:52:24,362 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 15:52:24,362 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 15:52:24,362 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 15:52:24,366 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 15:52:24,367 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 15:52:24,367 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 15:52:24,371 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 15:52:24,375 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 15:52:24,375 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 15:52:24,375 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 15:52:24,375 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 15:52:24,375 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 15:52:24,379 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 15:52:24,383 - DEBUG - üîó Foreign keys for users: []
2025-11-08 15:52:24,383 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 15:52:24,384 - DEBUG - üîç Relationship Details:
2025-11-08 15:52:24,384 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 15:52:24,384 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 15:52:24,384 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 15:52:24,384 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 15:52:24,384 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 15:52:24,384 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 15:52:24,384 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 15:52:24,384 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 15:52:24,384 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 15:52:24,384 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 15:52:24,384 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 15:52:24,384 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 15:52:24,384 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 15:52:24,384 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 15:54:15,899 - INFO - Database engine created with pool_size=10
2025-11-08 15:54:15,899 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 15:54:15,900 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 15:54:15,932 - INFO - SQLModel query returned 53 rows
2025-11-08 15:54:15,932 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 15:54:15,932 - DEBUG - Starting to process and group results
2025-11-08 15:54:15,932 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 15:54:15,932 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 15:54:15,932 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 15:54:15,932 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 15:54:15,932 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 15:54:15,932 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 15:54:15,932 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 15:54:15,932 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 15:54:15,932 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 15:54:15,932 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 15:54:15,933 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 15:54:15,933 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 15:54:15,933 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 15:54:15,934 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 15:54:15,934 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 15:54:15,934 - DEBUG - Converting to final data structure
2025-11-08 15:54:15,934 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 15:54:15,934 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 15:54:15,934 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 15:54:15,934 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 15:54:15,934 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 15:54:15,935 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 16:01:31,451 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 16:01:31,451 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 16:01:31,452 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 16:01:31,585 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 16:01:31,750 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:01:31,765 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:01:31,765 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:01:31,781 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:01:31,796 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:01:31,804 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 16:01:31,824 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 16:01:31,830 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 16:01:31,832 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 16:01:31,835 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 16:01:31,837 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 16:01:31,840 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 16:01:31,842 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 16:01:31,845 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 16:01:31,848 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 16:01:31,851 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 16:01:31,854 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 16:01:31,856 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 16:01:31,859 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 16:01:31,861 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 16:01:31,867 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 16:01:31,871 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:31,871 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 16:01:31,875 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 16:01:31,875 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 16:01:31,879 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:31,879 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 16:01:31,883 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:31,883 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 16:01:31,887 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:31,887 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 16:01:31,891 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 16:01:31,891 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 16:01:31,895 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 16:01:31,895 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 16:01:31,895 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 16:01:31,899 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 16:01:31,900 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 16:01:31,900 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 16:01:31,904 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 16:01:31,909 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 16:01:31,909 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 16:01:31,909 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 16:01:31,909 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 16:01:31,909 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 16:01:31,913 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 16:01:31,917 - DEBUG - üîó Foreign keys for users: []
2025-11-08 16:01:31,917 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 16:01:31,917 - DEBUG - üîç Relationship Details:
2025-11-08 16:01:31,917 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:01:31,917 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 16:01:31,917 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:01:31,918 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 16:01:31,918 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 16:01:31,918 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 16:01:31,918 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 16:01:31,918 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 16:01:31,918 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 16:01:31,918 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 16:01:31,918 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 16:01:31,918 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 16:01:31,918 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 16:01:31,918 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 16:01:31,919 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 16:01:31,919 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 16:01:32,544 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:01:32,560 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:01:32,560 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 16:01:32,572 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 16:01:32,576 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 16:01:32,579 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 16:01:32,581 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 16:01:32,584 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 16:01:32,586 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 16:01:32,588 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 16:01:32,591 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 16:01:32,594 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 16:01:32,597 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 16:01:32,600 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 16:01:32,603 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 16:01:32,605 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 16:01:32,608 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 16:01:32,613 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 16:01:32,617 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:32,617 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 16:01:32,622 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 16:01:32,622 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 16:01:32,626 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:32,626 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 16:01:32,630 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:32,630 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 16:01:32,634 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:32,634 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 16:01:32,638 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 16:01:32,638 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 16:01:32,642 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 16:01:32,642 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 16:01:32,642 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 16:01:32,646 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 16:01:32,647 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 16:01:32,647 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 16:01:32,651 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 16:01:32,655 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 16:01:32,655 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 16:01:32,655 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 16:01:32,655 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 16:01:32,655 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 16:01:32,659 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 16:01:32,663 - DEBUG - üîó Foreign keys for users: []
2025-11-08 16:01:32,663 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 16:01:32,664 - DEBUG - üîç Relationship Details:
2025-11-08 16:01:32,664 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:01:32,664 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 16:01:32,664 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:01:32,664 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 16:01:32,664 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 16:01:32,664 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 16:01:32,664 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 16:01:32,664 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 16:01:32,664 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 16:01:32,664 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 16:01:32,664 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 16:01:32,664 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 16:01:32,664 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 16:01:32,664 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 16:01:36,680 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 16:01:36,680 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 16:01:36,680 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 16:01:36,814 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 16:01:36,976 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:01:36,992 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:01:36,992 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:01:37,007 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:01:37,022 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:01:37,031 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 16:01:37,050 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 16:01:37,056 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 16:01:37,058 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 16:01:37,061 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 16:01:37,064 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 16:01:37,066 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 16:01:37,069 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 16:01:37,071 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 16:01:37,075 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 16:01:37,078 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 16:01:37,080 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 16:01:37,083 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 16:01:37,085 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 16:01:37,088 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 16:01:37,094 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 16:01:37,098 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:37,098 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 16:01:37,102 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 16:01:37,102 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 16:01:37,106 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:37,106 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 16:01:37,110 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:37,110 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 16:01:37,114 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:37,114 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 16:01:37,118 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 16:01:37,118 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 16:01:37,122 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 16:01:37,122 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 16:01:37,122 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 16:01:37,127 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 16:01:37,127 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 16:01:37,127 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 16:01:37,131 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 16:01:37,136 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 16:01:37,136 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 16:01:37,136 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 16:01:37,136 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 16:01:37,136 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 16:01:37,140 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 16:01:37,144 - DEBUG - üîó Foreign keys for users: []
2025-11-08 16:01:37,144 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 16:01:37,144 - DEBUG - üîç Relationship Details:
2025-11-08 16:01:37,145 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,145 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 16:01:37,145 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,145 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,145 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,145 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 16:01:37,145 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,145 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 16:01:37,145 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,145 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 16:01:37,145 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 16:01:37,145 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 16:01:37,145 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 16:01:37,145 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 16:01:37,145 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 16:01:37,146 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 16:01:37,762 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:01:37,777 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:01:37,777 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 16:01:37,789 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 16:01:37,793 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 16:01:37,796 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 16:01:37,798 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 16:01:37,801 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 16:01:37,803 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 16:01:37,806 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 16:01:37,809 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 16:01:37,811 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 16:01:37,814 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 16:01:37,816 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 16:01:37,819 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 16:01:37,821 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 16:01:37,824 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 16:01:37,829 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 16:01:37,833 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:37,833 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 16:01:37,837 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 16:01:37,837 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 16:01:37,841 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:37,841 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 16:01:37,845 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:37,845 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 16:01:37,849 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:01:37,849 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 16:01:37,853 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 16:01:37,853 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 16:01:37,857 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 16:01:37,857 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 16:01:37,857 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 16:01:37,861 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 16:01:37,861 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 16:01:37,861 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 16:01:37,866 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 16:01:37,870 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 16:01:37,870 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 16:01:37,870 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 16:01:37,870 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 16:01:37,870 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 16:01:37,874 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 16:01:37,878 - DEBUG - üîó Foreign keys for users: []
2025-11-08 16:01:37,878 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 16:01:37,878 - DEBUG - üîç Relationship Details:
2025-11-08 16:01:37,878 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,878 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 16:01:37,879 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,879 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,879 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,879 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 16:01:37,879 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,879 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 16:01:37,879 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 16:01:37,879 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 16:01:37,879 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 16:01:37,879 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 16:01:37,879 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 16:01:37,879 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 16:02:02,737 - INFO - Database engine created with pool_size=10
2025-11-08 16:02:02,739 - ERROR - Database session error in FastAPI dependency: 400: Sensor ID in path must match sensor ID in request body
2025-11-08 16:04:18,344 - ERROR - Database session error in FastAPI dependency: 400: Sensor ID in path must match sensor ID in request body
2025-11-08 16:09:27,651 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 16:09:27,651 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 16:09:27,651 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 16:09:27,788 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 16:09:27,955 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:09:27,971 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:09:27,971 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:09:27,987 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:09:28,003 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:09:28,012 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 16:09:28,033 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 16:09:28,038 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 16:09:28,041 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 16:09:28,044 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 16:09:28,046 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 16:09:28,049 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 16:09:28,051 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 16:09:28,054 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 16:09:28,057 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 16:09:28,060 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 16:09:28,063 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 16:09:28,066 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 16:09:28,069 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 16:09:28,072 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 16:09:28,077 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 16:09:28,081 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:09:28,081 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 16:09:28,086 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 16:09:28,086 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 16:09:28,090 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:09:28,090 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 16:09:28,094 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:09:28,094 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 16:09:28,098 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:09:28,098 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 16:09:28,102 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 16:09:28,102 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 16:09:28,106 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 16:09:28,106 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 16:09:28,106 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 16:09:28,110 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 16:09:28,110 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 16:09:28,110 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 16:09:28,114 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 16:09:28,119 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 16:09:28,119 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 16:09:28,119 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 16:09:28,119 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 16:09:28,119 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 16:09:28,123 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 16:09:28,127 - DEBUG - üîó Foreign keys for users: []
2025-11-08 16:09:28,127 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 16:09:28,127 - DEBUG - üîç Relationship Details:
2025-11-08 16:09:28,127 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,127 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 16:09:28,128 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,128 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,128 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,128 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 16:09:28,128 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,128 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 16:09:28,128 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,128 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 16:09:28,128 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 16:09:28,128 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 16:09:28,128 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 16:09:28,128 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 16:09:28,129 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 16:09:28,129 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 16:09:28,741 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:09:28,757 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:09:28,757 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 16:09:28,770 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 16:09:28,774 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 16:09:28,777 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 16:09:28,780 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 16:09:28,783 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 16:09:28,785 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 16:09:28,788 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 16:09:28,791 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 16:09:28,794 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 16:09:28,797 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 16:09:28,799 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 16:09:28,803 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 16:09:28,806 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 16:09:28,808 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 16:09:28,814 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 16:09:28,818 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:09:28,818 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 16:09:28,822 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 16:09:28,822 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 16:09:28,826 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:09:28,826 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 16:09:28,830 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:09:28,830 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 16:09:28,835 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:09:28,835 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 16:09:28,839 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 16:09:28,839 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 16:09:28,843 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 16:09:28,843 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 16:09:28,843 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 16:09:28,847 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 16:09:28,847 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 16:09:28,847 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 16:09:28,851 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 16:09:28,855 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 16:09:28,855 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 16:09:28,855 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 16:09:28,856 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 16:09:28,856 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 16:09:28,859 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 16:09:28,863 - DEBUG - üîó Foreign keys for users: []
2025-11-08 16:09:28,863 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 16:09:28,863 - DEBUG - üîç Relationship Details:
2025-11-08 16:09:28,863 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,863 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 16:09:28,864 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,864 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,864 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,864 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 16:09:28,864 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,864 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 16:09:28,864 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 16:09:28,864 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 16:09:28,864 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 16:09:28,864 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 16:09:28,864 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 16:09:28,864 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 16:09:40,823 - INFO - Database engine created with pool_size=10
2025-11-08 16:09:42,333 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 16:09:42,334 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 16:09:42,338 - INFO - SQLModel query returned 53 rows
2025-11-08 16:09:42,338 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 16:09:42,338 - DEBUG - Starting to process and group results
2025-11-08 16:09:42,338 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 16:09:42,338 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 16:09:42,338 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 16:09:42,338 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 16:09:42,338 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 16:09:42,338 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 16:09:42,338 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 16:09:42,338 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 16:09:42,339 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 16:09:42,339 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 16:09:42,339 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 16:09:42,339 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 16:09:42,339 - DEBUG - Converting to final data structure
2025-11-08 16:09:42,339 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 16:09:42,339 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 16:09:42,339 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 16:09:42,339 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 16:09:42,340 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 16:09:42,340 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 16:49:12,403 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 16:49:12,404 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 16:49:12,476 - INFO - SQLModel query returned 53 rows
2025-11-08 16:49:12,476 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 16:49:12,476 - DEBUG - Starting to process and group results
2025-11-08 16:49:12,476 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 16:49:12,476 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 16:49:12,476 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 16:49:12,476 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 16:49:12,476 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 16:49:12,476 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 16:49:12,477 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 16:49:12,477 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 16:49:12,477 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 16:49:12,477 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 16:49:12,477 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 16:49:12,477 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 16:49:12,477 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 16:49:12,477 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 16:49:12,477 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 16:49:12,477 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 16:49:12,477 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 16:49:12,477 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 16:49:12,478 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 16:49:12,478 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 16:49:12,478 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 16:49:12,478 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 16:49:12,478 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 16:49:12,478 - DEBUG - Converting to final data structure
2025-11-08 16:49:12,478 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 16:49:12,478 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 16:49:12,478 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 16:49:12,478 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 16:49:12,478 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 16:49:12,506 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 16:51:02,741 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 16:51:02,741 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 16:51:02,742 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 16:51:02,876 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 16:51:03,036 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:51:03,052 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:51:03,052 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:51:03,068 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:51:03,083 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:51:03,092 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 16:51:03,112 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 16:51:03,118 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 16:51:03,120 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 16:51:03,123 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 16:51:03,125 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 16:51:03,128 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 16:51:03,131 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 16:51:03,133 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 16:51:03,137 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 16:51:03,139 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 16:51:03,142 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 16:51:03,145 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 16:51:03,148 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 16:51:03,150 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 16:51:03,156 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 16:51:03,160 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:51:03,160 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 16:51:03,164 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 16:51:03,164 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 16:51:03,168 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:51:03,168 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 16:51:03,173 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:51:03,173 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 16:51:03,177 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:51:03,177 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 16:51:03,181 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 16:51:03,181 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 16:51:03,185 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 16:51:03,185 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 16:51:03,186 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 16:51:03,190 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 16:51:03,190 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 16:51:03,190 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 16:51:03,195 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 16:51:03,199 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 16:51:03,199 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 16:51:03,199 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 16:51:03,199 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 16:51:03,199 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 16:51:03,204 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 16:51:03,208 - DEBUG - üîó Foreign keys for users: []
2025-11-08 16:51:03,209 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 16:51:03,209 - DEBUG - üîç Relationship Details:
2025-11-08 16:51:03,209 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,209 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 16:51:03,209 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,209 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,209 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,209 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 16:51:03,209 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,209 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 16:51:03,209 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,209 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 16:51:03,209 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 16:51:03,209 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 16:51:03,210 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 16:51:03,210 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 16:51:03,210 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 16:51:03,210 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 16:51:03,820 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 16:51:03,836 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 16:51:03,836 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 16:51:03,848 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 16:51:03,853 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 16:51:03,856 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 16:51:03,858 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 16:51:03,861 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 16:51:03,864 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 16:51:03,866 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 16:51:03,869 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 16:51:03,872 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 16:51:03,874 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 16:51:03,877 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 16:51:03,880 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 16:51:03,882 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 16:51:03,885 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 16:51:03,891 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 16:51:03,895 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:51:03,895 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 16:51:03,899 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 16:51:03,899 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 16:51:03,903 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:51:03,903 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 16:51:03,907 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:51:03,907 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 16:51:03,912 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 16:51:03,912 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 16:51:03,916 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 16:51:03,916 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 16:51:03,920 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 16:51:03,920 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 16:51:03,920 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 16:51:03,925 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 16:51:03,925 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 16:51:03,925 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 16:51:03,929 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 16:51:03,933 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 16:51:03,934 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 16:51:03,934 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 16:51:03,934 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 16:51:03,934 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 16:51:03,938 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 16:51:03,943 - DEBUG - üîó Foreign keys for users: []
2025-11-08 16:51:03,943 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 16:51:03,943 - DEBUG - üîç Relationship Details:
2025-11-08 16:51:03,943 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,943 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 16:51:03,943 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,943 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,943 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,943 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 16:51:03,943 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,943 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 16:51:03,943 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 16:51:03,943 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 16:51:03,944 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 16:51:03,944 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 16:51:03,944 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 16:51:03,944 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 16:51:40,471 - INFO - Database engine created with pool_size=10
2025-11-08 16:53:06,378 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 16:53:06,379 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 16:53:06,383 - INFO - SQLModel query returned 53 rows
2025-11-08 16:53:06,383 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 16:53:06,383 - DEBUG - Starting to process and group results
2025-11-08 16:53:06,383 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 16:53:06,383 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 16:53:06,383 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 16:53:06,383 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 16:53:06,384 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 16:53:06,384 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 16:53:06,384 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 16:53:06,384 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 16:53:06,384 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 16:53:06,384 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 16:53:06,384 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 16:53:06,384 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 16:53:06,384 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 16:53:06,384 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 16:53:06,384 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 16:53:06,384 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 16:53:06,385 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 16:53:06,385 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 16:53:06,385 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 16:53:06,385 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 16:53:06,385 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 16:53:06,385 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 16:53:06,385 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 16:53:06,385 - DEBUG - Converting to final data structure
2025-11-08 16:53:06,385 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 16:53:06,385 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 16:53:06,385 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 16:53:06,385 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 16:53:06,385 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 16:53:06,386 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 16:58:48,339 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 16:58:48,339 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 16:58:48,346 - INFO - SQLModel query returned 53 rows
2025-11-08 16:58:48,347 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 16:58:48,347 - DEBUG - Starting to process and group results
2025-11-08 16:58:48,347 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 16:58:48,347 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 16:58:48,347 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 16:58:48,347 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 16:58:48,347 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 16:58:48,347 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 16:58:48,347 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 16:58:48,347 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 16:58:48,347 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 16:58:48,348 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 16:58:48,348 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 16:58:48,348 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 16:58:48,348 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 16:58:48,348 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 16:58:48,348 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 16:58:48,348 - DEBUG - Converting to final data structure
2025-11-08 16:58:48,348 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 16:58:48,348 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 16:58:48,348 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 16:58:48,348 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 16:58:48,348 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 16:58:48,348 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 17:49:01,462 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 17:49:01,462 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 17:49:01,462 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 17:49:01,602 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 17:49:01,767 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 17:49:01,782 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 17:49:01,783 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 17:49:01,799 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 17:49:01,815 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 17:49:01,824 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 17:49:01,957 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 17:49:01,964 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 17:49:01,968 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 17:49:01,972 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 17:49:01,975 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 17:49:01,978 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 17:49:01,982 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 17:49:01,984 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 17:49:01,988 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 17:49:01,991 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 17:49:01,995 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 17:49:01,998 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 17:49:02,000 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 17:49:02,003 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 17:49:02,011 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 17:49:02,016 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:02,016 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 17:49:02,021 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 17:49:02,021 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 17:49:02,027 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:02,027 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 17:49:02,032 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:02,032 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 17:49:02,036 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:02,037 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 17:49:02,042 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 17:49:02,042 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 17:49:02,047 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 17:49:02,047 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 17:49:02,047 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 17:49:02,053 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 17:49:02,053 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 17:49:02,053 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 17:49:02,058 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 17:49:02,062 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 17:49:02,062 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 17:49:02,062 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 17:49:02,062 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 17:49:02,062 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 17:49:02,066 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 17:49:02,070 - DEBUG - üîó Foreign keys for users: []
2025-11-08 17:49:02,070 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 17:49:02,071 - DEBUG - üîç Relationship Details:
2025-11-08 17:49:02,071 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,071 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 17:49:02,071 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,071 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,071 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,071 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 17:49:02,071 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,071 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 17:49:02,071 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,071 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 17:49:02,071 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 17:49:02,071 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 17:49:02,071 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 17:49:02,072 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 17:49:02,072 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 17:49:02,072 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 17:49:02,697 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 17:49:02,712 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 17:49:02,713 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 17:49:02,725 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 17:49:02,730 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 17:49:02,733 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 17:49:02,735 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 17:49:02,738 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 17:49:02,741 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 17:49:02,743 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 17:49:02,747 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 17:49:02,750 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 17:49:02,752 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 17:49:02,755 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 17:49:02,759 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 17:49:02,761 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 17:49:02,764 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 17:49:02,769 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 17:49:02,773 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:02,774 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 17:49:02,778 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 17:49:02,778 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 17:49:02,782 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:02,782 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 17:49:02,786 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:02,786 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 17:49:02,790 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:02,790 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 17:49:02,794 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 17:49:02,794 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 17:49:02,798 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 17:49:02,798 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 17:49:02,798 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 17:49:02,803 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 17:49:02,803 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 17:49:02,803 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 17:49:02,807 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 17:49:02,811 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 17:49:02,811 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 17:49:02,811 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 17:49:02,811 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 17:49:02,811 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 17:49:02,815 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 17:49:02,819 - DEBUG - üîó Foreign keys for users: []
2025-11-08 17:49:02,819 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 17:49:02,819 - DEBUG - üîç Relationship Details:
2025-11-08 17:49:02,819 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,820 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 17:49:02,820 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,820 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,820 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,820 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 17:49:02,820 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,820 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 17:49:02,820 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 17:49:02,820 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 17:49:02,820 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 17:49:02,820 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 17:49:02,820 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 17:49:02,820 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 17:49:04,925 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 17:49:04,925 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 17:49:04,925 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 17:49:05,059 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 17:49:05,222 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 17:49:05,238 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 17:49:05,238 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 17:49:05,256 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 17:49:05,272 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 17:49:05,281 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 17:49:05,301 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 17:49:05,307 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 17:49:05,310 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 17:49:05,312 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 17:49:05,315 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 17:49:05,318 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 17:49:05,320 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 17:49:05,323 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 17:49:05,327 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 17:49:05,330 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 17:49:05,332 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 17:49:05,336 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 17:49:05,338 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 17:49:05,341 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 17:49:05,346 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 17:49:05,350 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:05,350 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 17:49:05,354 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 17:49:05,355 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 17:49:05,359 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:05,359 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 17:49:05,364 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:05,364 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 17:49:05,369 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:05,369 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 17:49:05,373 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 17:49:05,373 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 17:49:05,377 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 17:49:05,377 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 17:49:05,377 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 17:49:05,382 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 17:49:05,382 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 17:49:05,382 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 17:49:05,387 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 17:49:05,391 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 17:49:05,391 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 17:49:05,391 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 17:49:05,391 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 17:49:05,391 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 17:49:05,396 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 17:49:05,400 - DEBUG - üîó Foreign keys for users: []
2025-11-08 17:49:05,400 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 17:49:05,400 - DEBUG - üîç Relationship Details:
2025-11-08 17:49:05,400 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 17:49:05,400 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 17:49:05,400 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 17:49:05,400 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 17:49:05,401 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 17:49:05,401 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 17:49:05,401 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 17:49:05,401 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 17:49:05,401 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 17:49:05,401 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 17:49:05,401 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 17:49:05,401 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 17:49:05,401 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 17:49:05,401 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 17:49:05,402 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 17:49:05,402 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 17:49:06,053 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 17:49:06,068 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 17:49:06,068 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 17:49:06,080 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 17:49:06,085 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 17:49:06,087 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 17:49:06,089 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 17:49:06,092 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 17:49:06,094 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 17:49:06,097 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 17:49:06,099 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 17:49:06,102 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 17:49:06,104 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 17:49:06,107 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 17:49:06,110 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 17:49:06,112 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 17:49:06,115 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 17:49:06,120 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 17:49:06,124 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:06,124 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 17:49:06,128 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 17:49:06,129 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 17:49:06,133 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:06,133 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 17:49:06,137 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:06,137 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 17:49:06,141 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 17:49:06,141 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 17:49:06,145 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 17:49:06,146 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 17:49:06,150 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 17:49:06,150 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 17:49:06,150 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 17:49:06,154 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 17:49:06,154 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 17:49:06,154 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 17:49:06,158 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 17:49:06,163 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 17:49:06,163 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 17:49:06,163 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 17:49:06,163 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 17:49:06,163 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 17:49:06,167 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 17:49:06,171 - DEBUG - üîó Foreign keys for users: []
2025-11-08 17:49:06,171 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 17:49:06,172 - DEBUG - üîç Relationship Details:
2025-11-08 17:49:06,172 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 17:49:06,172 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 17:49:06,172 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 17:49:06,172 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 17:49:06,172 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 17:49:06,172 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 17:49:06,172 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 17:49:06,172 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 17:49:06,172 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 17:49:06,172 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 17:49:06,172 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 17:49:06,172 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 17:49:06,172 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 17:49:06,172 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:03:50,688 - INFO - Database engine created with pool_size=10
2025-11-08 18:03:50,689 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 18:03:50,689 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 18:03:50,721 - INFO - SQLModel query returned 53 rows
2025-11-08 18:03:50,721 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 18:03:50,721 - DEBUG - Starting to process and group results
2025-11-08 18:03:50,721 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 18:03:50,722 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 18:03:50,722 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 18:03:50,722 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 18:03:50,722 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 18:03:50,722 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 18:03:50,722 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 18:03:50,722 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 18:03:50,722 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 18:03:50,722 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 18:03:50,722 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 18:03:50,722 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 18:03:50,722 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 18:03:50,722 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 18:03:50,723 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 18:03:50,723 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 18:03:50,723 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 18:03:50,723 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 18:03:50,723 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 18:03:50,723 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 18:03:50,723 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 18:03:50,723 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 18:03:50,723 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 18:03:50,723 - DEBUG - Converting to final data structure
2025-11-08 18:03:50,723 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 18:03:50,723 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 18:03:50,724 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 18:03:50,724 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 18:03:50,724 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 18:03:50,724 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 18:07:51,986 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 18:07:51,986 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 18:07:51,986 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 18:07:52,119 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 18:07:52,284 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:52,299 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:52,299 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:52,315 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:52,330 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:52,338 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:07:52,359 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:07:52,365 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:07:52,369 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:07:52,372 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:07:52,375 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:07:52,377 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:07:52,380 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:07:52,383 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:07:52,386 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:07:52,389 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:07:52,391 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:07:52,394 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:07:52,397 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:07:52,399 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:07:52,404 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:07:52,408 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:52,408 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:52,412 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:07:52,412 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:07:52,416 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:52,416 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:52,420 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:52,420 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:07:52,425 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:52,425 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:07:52,429 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:07:52,429 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:07:52,433 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:07:52,433 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:07:52,433 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:07:52,437 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:07:52,437 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:07:52,437 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:07:52,442 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:07:52,446 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:07:52,446 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:07:52,446 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:07:52,446 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:07:52,446 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:07:52,450 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:07:52,454 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:07:52,454 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:07:52,454 - DEBUG - üîç Relationship Details:
2025-11-08 18:07:52,454 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:52,454 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:07:52,455 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:52,455 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:07:52,455 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:07:52,455 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:07:52,455 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:07:52,455 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:07:52,455 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:07:52,455 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:07:52,455 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:07:52,455 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:07:52,455 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:07:52,455 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:07:52,456 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 18:07:52,456 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 18:07:53,081 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:53,097 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:53,097 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:07:53,110 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:07:53,114 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:07:53,117 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:07:53,120 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:07:53,122 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:07:53,125 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:07:53,128 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:07:53,130 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:07:53,133 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:07:53,136 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:07:53,139 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:07:53,142 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:07:53,144 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:07:53,147 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:07:53,153 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:07:53,157 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:53,158 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:53,162 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:07:53,162 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:07:53,166 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:53,166 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:53,170 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:53,170 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:07:53,175 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:53,175 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:07:53,179 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:07:53,179 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:07:53,183 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:07:53,184 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:07:53,184 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:07:53,188 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:07:53,189 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:07:53,189 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:07:53,193 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:07:53,197 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:07:53,197 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:07:53,197 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:07:53,197 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:07:53,197 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:07:53,201 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:07:53,206 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:07:53,206 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:07:53,206 - DEBUG - üîç Relationship Details:
2025-11-08 18:07:53,206 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:53,206 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:07:53,206 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:53,206 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:07:53,206 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:07:53,206 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:07:53,206 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:07:53,206 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:07:53,206 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:07:53,207 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:07:53,207 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:07:53,207 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:07:53,207 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:07:53,207 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:07:55,344 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 18:07:55,344 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 18:07:55,344 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 18:07:55,486 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 18:07:55,660 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:55,676 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:55,676 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:55,692 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:55,708 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:55,717 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:07:55,737 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:07:55,742 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:07:55,745 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:07:55,749 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:07:55,752 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:07:55,754 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:07:55,757 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:07:55,760 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:07:55,764 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:07:55,767 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:07:55,770 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:07:55,773 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:07:55,775 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:07:55,778 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:07:55,784 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:07:55,788 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:55,788 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:55,793 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:07:55,793 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:07:55,797 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:55,797 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:55,802 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:55,802 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:07:55,806 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:55,806 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:07:55,810 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:07:55,810 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:07:55,815 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:07:55,815 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:07:55,815 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:07:55,819 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:07:55,819 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:07:55,819 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:07:55,823 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:07:55,828 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:07:55,828 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:07:55,828 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:07:55,828 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:07:55,828 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:07:55,833 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:07:55,837 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:07:55,837 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:07:55,837 - DEBUG - üîç Relationship Details:
2025-11-08 18:07:55,837 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:55,837 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:07:55,837 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:55,837 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:07:55,837 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:07:55,837 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:07:55,838 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:07:55,838 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:07:55,838 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:07:55,838 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:07:55,838 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:07:55,838 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:07:55,838 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:07:55,838 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:07:55,839 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 18:07:55,839 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 18:07:56,477 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:56,493 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:56,494 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:07:56,506 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:07:56,510 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:07:56,513 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:07:56,516 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:07:56,518 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:07:56,521 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:07:56,524 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:07:56,526 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:07:56,529 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:07:56,532 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:07:56,534 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:07:56,537 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:07:56,540 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:07:56,542 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:07:56,547 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:07:56,551 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:56,551 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:56,555 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:07:56,555 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:07:56,560 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:56,560 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:56,564 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:56,564 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:07:56,568 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:56,568 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:07:56,572 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:07:56,572 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:07:56,576 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:07:56,576 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:07:56,576 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:07:56,580 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:07:56,580 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:07:56,580 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:07:56,584 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:07:56,588 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:07:56,588 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:07:56,588 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:07:56,588 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:07:56,588 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:07:56,592 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:07:56,597 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:07:56,597 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:07:56,597 - DEBUG - üîç Relationship Details:
2025-11-08 18:07:56,597 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:56,597 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:07:56,597 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:56,597 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:07:56,597 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:07:56,597 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:07:56,597 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:07:56,597 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:07:56,597 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:07:56,597 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:07:56,597 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:07:56,597 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:07:56,597 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:07:56,597 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:07:58,708 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 18:07:58,709 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 18:07:58,709 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 18:07:58,843 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 18:07:59,007 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:59,023 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:59,023 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:59,039 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:59,054 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:59,063 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:07:59,083 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:07:59,089 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:07:59,091 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:07:59,094 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:07:59,097 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:07:59,099 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:07:59,102 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:07:59,104 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:07:59,108 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:07:59,111 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:07:59,114 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:07:59,117 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:07:59,119 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:07:59,122 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:07:59,127 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:07:59,131 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:59,131 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:59,135 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:07:59,135 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:07:59,140 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:59,140 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:59,144 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:59,144 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:07:59,148 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:59,148 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:07:59,153 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:07:59,153 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:07:59,157 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:07:59,157 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:07:59,157 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:07:59,161 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:07:59,161 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:07:59,161 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:07:59,165 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:07:59,170 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:07:59,170 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:07:59,170 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:07:59,170 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:07:59,170 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:07:59,174 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:07:59,178 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:07:59,178 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:07:59,179 - DEBUG - üîç Relationship Details:
2025-11-08 18:07:59,179 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,179 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:07:59,179 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,179 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,179 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,179 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:07:59,179 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,179 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:07:59,179 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,179 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:07:59,179 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:07:59,179 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:07:59,179 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:07:59,179 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:07:59,180 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 18:07:59,180 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 18:07:59,786 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:07:59,802 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:07:59,803 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:07:59,815 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:07:59,819 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:07:59,822 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:07:59,824 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:07:59,827 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:07:59,829 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:07:59,832 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:07:59,835 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:07:59,837 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:07:59,840 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:07:59,843 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:07:59,846 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:07:59,848 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:07:59,851 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:07:59,856 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:07:59,860 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:59,860 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:59,865 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:07:59,865 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:07:59,869 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:59,869 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:07:59,873 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:59,873 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:07:59,878 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:07:59,878 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:07:59,883 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:07:59,883 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:07:59,887 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:07:59,887 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:07:59,887 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:07:59,891 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:07:59,891 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:07:59,891 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:07:59,895 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:07:59,899 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:07:59,900 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:07:59,900 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:07:59,900 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:07:59,900 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:07:59,904 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:07:59,908 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:07:59,908 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:07:59,908 - DEBUG - üîç Relationship Details:
2025-11-08 18:07:59,908 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,908 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:07:59,908 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,908 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,908 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,908 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:07:59,908 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,908 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:07:59,908 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:07:59,908 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:07:59,908 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:07:59,908 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:07:59,908 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:07:59,908 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:08:02,951 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 18:08:02,951 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 18:08:02,951 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 18:08:03,086 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 18:08:03,252 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:03,267 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:03,267 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:03,283 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:03,298 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:03,308 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:08:03,328 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:08:03,333 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:08:03,336 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:08:03,339 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:08:03,341 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:08:03,344 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:08:03,346 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:08:03,349 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:08:03,353 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:08:03,355 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:08:03,358 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:08:03,361 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:08:03,363 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:08:03,366 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:08:03,372 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:08:03,376 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:03,376 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:03,380 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:08:03,380 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:08:03,384 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:03,384 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:03,388 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:03,388 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:08:03,392 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:03,392 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:08:03,396 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:08:03,396 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:08:03,400 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:08:03,400 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:08:03,400 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:08:03,404 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:08:03,404 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:08:03,405 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:08:03,409 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:08:03,413 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:08:03,413 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:08:03,413 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:08:03,413 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:08:03,413 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:08:03,417 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:08:03,421 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:08:03,421 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:08:03,422 - DEBUG - üîç Relationship Details:
2025-11-08 18:08:03,422 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:03,422 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:08:03,422 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:03,422 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:08:03,422 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:08:03,422 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:08:03,422 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:08:03,422 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:08:03,422 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:08:03,422 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:08:03,422 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:08:03,422 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:08:03,422 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:08:03,422 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:08:03,423 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 18:08:03,423 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 18:08:04,028 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:04,045 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:04,046 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:08:04,058 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:08:04,063 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:08:04,066 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:08:04,068 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:08:04,071 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:08:04,074 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:08:04,076 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:08:04,079 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:08:04,082 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:08:04,085 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:08:04,088 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:08:04,091 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:08:04,093 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:08:04,096 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:08:04,101 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:08:04,105 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:04,106 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:04,110 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:08:04,110 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:08:04,114 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:04,114 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:04,118 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:04,118 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:08:04,122 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:04,122 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:08:04,126 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:08:04,126 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:08:04,130 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:08:04,131 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:08:04,131 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:08:04,135 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:08:04,135 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:08:04,135 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:08:04,139 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:08:04,143 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:08:04,143 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:08:04,143 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:08:04,143 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:08:04,143 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:08:04,147 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:08:04,151 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:08:04,151 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:08:04,152 - DEBUG - üîç Relationship Details:
2025-11-08 18:08:04,152 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:04,152 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:08:04,152 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:04,152 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:08:04,152 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:08:04,152 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:08:04,152 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:08:04,152 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:08:04,152 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:08:04,152 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:08:04,152 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:08:04,152 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:08:04,152 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:08:04,152 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:08:07,225 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 18:08:07,225 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 18:08:07,225 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 18:08:07,362 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 18:08:07,528 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:07,544 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:07,544 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:07,560 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:07,576 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:07,584 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:08:07,604 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:08:07,610 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:08:07,612 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:08:07,615 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:08:07,618 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:08:07,620 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:08:07,623 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:08:07,625 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:08:07,629 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:08:07,631 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:08:07,634 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:08:07,637 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:08:07,639 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:08:07,642 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:08:07,647 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:08:07,651 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:07,651 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:07,655 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:08:07,655 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:08:07,659 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:07,659 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:07,663 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:07,663 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:08:07,667 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:07,667 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:08:07,671 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:08:07,671 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:08:07,675 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:08:07,675 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:08:07,675 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:08:07,680 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:08:07,680 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:08:07,680 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:08:07,684 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:08:07,688 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:08:07,688 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:08:07,688 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:08:07,688 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:08:07,688 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:08:07,692 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:08:07,697 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:08:07,697 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:08:07,697 - DEBUG - üîç Relationship Details:
2025-11-08 18:08:07,697 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:07,697 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:08:07,697 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:07,697 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:08:07,697 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:08:07,697 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:08:07,697 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:08:07,697 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:08:07,698 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:08:07,698 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:08:07,698 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:08:07,698 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:08:07,698 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:08:07,698 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:08:07,699 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 18:08:07,699 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 18:08:08,310 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:08,327 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:08,327 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:08:08,340 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:08:08,344 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:08:08,347 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:08:08,349 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:08:08,352 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:08:08,355 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:08:08,358 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:08:08,361 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:08:08,364 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:08:08,367 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:08:08,370 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:08:08,373 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:08:08,376 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:08:08,380 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:08:08,385 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:08:08,390 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:08,390 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:08,394 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:08:08,394 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:08:08,398 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:08,398 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:08,402 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:08,402 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:08:08,406 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:08,406 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:08:08,411 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:08:08,411 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:08:08,415 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:08:08,415 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:08:08,415 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:08:08,419 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:08:08,419 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:08:08,419 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:08:08,423 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:08:08,428 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:08:08,428 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:08:08,428 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:08:08,428 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:08:08,428 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:08:08,432 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:08:08,436 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:08:08,436 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:08:08,436 - DEBUG - üîç Relationship Details:
2025-11-08 18:08:08,436 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:08,436 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:08:08,437 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:08,437 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:08:08,437 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:08:08,437 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:08:08,437 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:08:08,437 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:08:08,437 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:08:08,437 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:08:08,437 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:08:08,437 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:08:08,437 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:08:08,437 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:08:22,098 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 18:08:22,098 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 18:08:22,098 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 18:08:22,232 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 18:08:22,396 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:22,411 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:22,411 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:22,427 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:22,442 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:22,450 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:08:22,470 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:08:22,476 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:08:22,479 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:08:22,482 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:08:22,484 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:08:22,487 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:08:22,490 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:08:22,492 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:08:22,496 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:08:22,498 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:08:22,501 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:08:22,504 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:08:22,507 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:08:22,509 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:08:22,515 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:08:22,519 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:22,519 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:22,523 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:08:22,523 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:08:22,527 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:22,527 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:22,531 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:22,531 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:08:22,535 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:22,535 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:08:22,539 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:08:22,539 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:08:22,543 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:08:22,543 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:08:22,544 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:08:22,547 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:08:22,548 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:08:22,548 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:08:22,552 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:08:22,556 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:08:22,556 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:08:22,556 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:08:22,556 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:08:22,556 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:08:22,560 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:08:22,564 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:08:22,565 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:08:22,565 - DEBUG - üîç Relationship Details:
2025-11-08 18:08:22,565 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:22,565 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:08:22,565 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:22,565 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:08:22,565 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:08:22,565 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:08:22,565 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:08:22,565 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:08:22,565 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:08:22,565 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:08:22,565 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:08:22,565 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:08:22,565 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:08:22,565 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:08:22,566 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 18:08:22,566 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 18:08:23,170 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:23,185 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:23,186 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:08:23,198 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:08:23,203 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:08:23,205 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:08:23,208 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:08:23,211 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:08:23,213 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:08:23,216 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:08:23,219 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:08:23,221 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:08:23,224 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:08:23,227 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:08:23,230 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:08:23,232 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:08:23,235 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:08:23,240 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:08:23,245 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:23,245 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:23,249 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:08:23,249 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:08:23,253 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:23,253 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:23,257 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:23,257 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:08:23,262 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:23,262 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:08:23,266 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:08:23,266 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:08:23,270 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:08:23,270 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:08:23,270 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:08:23,275 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:08:23,275 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:08:23,275 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:08:23,279 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:08:23,283 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:08:23,284 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:08:23,284 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:08:23,284 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:08:23,284 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:08:23,288 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:08:23,292 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:08:23,292 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:08:23,292 - DEBUG - üîç Relationship Details:
2025-11-08 18:08:23,293 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:23,293 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:08:23,293 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:23,293 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:08:23,293 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:08:23,293 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:08:23,293 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:08:23,293 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:08:23,293 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:08:23,293 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:08:23,293 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:08:23,293 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:08:23,293 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:08:23,293 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:08:31,109 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 18:08:31,109 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 18:08:31,109 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 18:08:31,244 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 18:08:31,406 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:31,422 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:31,422 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:31,438 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:31,453 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:31,461 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:08:31,481 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:08:31,487 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:08:31,490 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:08:31,492 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:08:31,495 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:08:31,497 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:08:31,500 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:08:31,503 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:08:31,506 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:08:31,509 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:08:31,512 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:08:31,515 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:08:31,517 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:08:31,520 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:08:31,525 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:08:31,529 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:31,529 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:31,533 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:08:31,533 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:08:31,537 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:31,537 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:31,541 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:31,541 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:08:31,545 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:31,545 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:08:31,549 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:08:31,549 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:08:31,553 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:08:31,553 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:08:31,553 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:08:31,557 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:08:31,557 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:08:31,557 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:08:31,561 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:08:31,565 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:08:31,566 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:08:31,566 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:08:31,566 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:08:31,566 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:08:31,570 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:08:31,573 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:08:31,573 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:08:31,574 - DEBUG - üîç Relationship Details:
2025-11-08 18:08:31,574 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:31,574 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:08:31,574 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:31,574 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:08:31,574 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:08:31,574 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:08:31,574 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:08:31,574 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:08:31,574 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:08:31,574 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:08:31,574 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:08:31,574 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:08:31,574 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:08:31,574 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 18:08:31,575 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 18:08:31,575 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 18:08:32,181 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 18:08:32,200 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 18:08:32,201 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 18:08:32,214 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 18:08:32,219 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 18:08:32,222 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 18:08:32,224 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 18:08:32,227 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 18:08:32,229 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 18:08:32,232 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 18:08:32,235 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 18:08:32,238 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 18:08:32,241 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 18:08:32,244 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 18:08:32,247 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 18:08:32,249 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 18:08:32,252 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 18:08:32,257 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 18:08:32,262 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:32,262 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:32,266 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 18:08:32,266 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 18:08:32,270 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:32,271 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 18:08:32,275 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:32,275 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 18:08:32,279 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 18:08:32,279 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 18:08:32,283 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 18:08:32,283 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 18:08:32,287 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 18:08:32,287 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 18:08:32,287 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 18:08:32,291 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 18:08:32,291 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 18:08:32,292 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 18:08:32,296 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 18:08:32,300 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 18:08:32,300 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 18:08:32,300 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 18:08:32,300 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 18:08:32,300 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 18:08:32,304 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 18:08:32,308 - DEBUG - üîó Foreign keys for users: []
2025-11-08 18:08:32,308 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 18:08:32,308 - DEBUG - üîç Relationship Details:
2025-11-08 18:08:32,308 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:32,308 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 18:08:32,308 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 18:08:32,308 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 18:08:32,308 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 18:08:32,309 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 18:08:32,309 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 18:08:32,309 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 18:08:32,309 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 18:08:32,309 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 18:08:32,309 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 18:08:32,309 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 18:08:32,309 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 18:08:32,309 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 21:22:08,764 - INFO - Database engine created with pool_size=10
2025-11-08 21:36:03,168 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 21:36:03,168 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 21:36:03,168 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 21:36:03,333 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 21:36:03,594 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 21:36:03,610 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 21:36:03,610 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 21:36:03,626 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 21:36:03,640 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 21:36:03,649 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 21:36:03,753 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 21:36:03,758 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 21:36:03,761 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 21:36:03,764 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 21:36:03,766 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 21:36:03,769 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 21:36:03,772 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 21:36:03,774 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 21:36:03,777 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 21:36:03,780 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 21:36:03,783 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 21:36:03,786 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 21:36:03,789 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 21:36:03,792 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 21:36:03,797 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 21:36:03,801 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 21:36:03,801 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 21:36:03,806 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 21:36:03,806 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 21:36:03,810 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 21:36:03,810 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 21:36:03,814 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 21:36:03,814 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 21:36:03,818 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 21:36:03,818 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 21:36:03,822 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 21:36:03,823 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 21:36:03,827 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 21:36:03,827 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 21:36:03,827 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 21:36:03,831 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 21:36:03,832 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 21:36:03,832 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 21:36:03,836 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 21:36:03,840 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 21:36:03,840 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 21:36:03,840 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 21:36:03,841 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 21:36:03,841 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 21:36:03,845 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 21:36:03,849 - DEBUG - üîó Foreign keys for users: []
2025-11-08 21:36:03,849 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 21:36:03,849 - DEBUG - üîç Relationship Details:
2025-11-08 21:36:03,849 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 21:36:03,849 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 21:36:03,849 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 21:36:03,849 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 21:36:03,849 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 21:36:03,849 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 21:36:03,849 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 21:36:03,849 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 21:36:03,849 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 21:36:03,849 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 21:36:03,849 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 21:36:03,849 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 21:36:03,849 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 21:36:03,849 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 21:36:03,851 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 21:36:03,851 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 21:36:04,559 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 21:36:04,574 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 21:36:04,575 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 21:36:04,588 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 21:36:04,592 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 21:36:04,595 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 21:36:04,598 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 21:36:04,600 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 21:36:04,603 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 21:36:04,606 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 21:36:04,608 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 21:36:04,611 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 21:36:04,614 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 21:36:04,617 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 21:36:04,620 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 21:36:04,622 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 21:36:04,625 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 21:36:04,631 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 21:36:04,635 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 21:36:04,635 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 21:36:04,639 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 21:36:04,639 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 21:36:04,643 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 21:36:04,643 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 21:36:04,647 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 21:36:04,647 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 21:36:04,652 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 21:36:04,652 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 21:36:04,656 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 21:36:04,656 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 21:36:04,660 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 21:36:04,660 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 21:36:04,660 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 21:36:04,664 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 21:36:04,664 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 21:36:04,664 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 21:36:04,668 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 21:36:04,673 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 21:36:04,673 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 21:36:04,673 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 21:36:04,673 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 21:36:04,673 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 21:36:04,677 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 21:36:04,681 - DEBUG - üîó Foreign keys for users: []
2025-11-08 21:36:04,681 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 21:36:04,682 - DEBUG - üîç Relationship Details:
2025-11-08 21:36:04,682 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 21:36:04,682 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 21:36:04,682 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 21:36:04,682 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 21:36:04,682 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 21:36:04,682 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 21:36:04,682 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 21:36:04,682 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 21:36:04,682 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 21:36:04,682 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 21:36:04,682 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 21:36:04,682 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 21:36:04,683 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 21:36:04,683 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 21:37:16,826 - INFO - Database engine created with pool_size=10
2025-11-08 21:37:16,826 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 21:37:16,827 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 21:37:16,859 - INFO - SQLModel query returned 53 rows
2025-11-08 21:37:16,859 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 21:37:16,859 - DEBUG - Starting to process and group results
2025-11-08 21:37:16,859 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 21:37:16,859 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 21:37:16,859 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 21:37:16,859 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 21:37:16,859 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 21:37:16,859 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 21:37:16,859 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 21:37:16,859 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 21:37:16,859 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 21:37:16,859 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 21:37:16,859 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 21:37:16,859 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 21:37:16,860 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 21:37:16,860 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 21:37:16,860 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 21:37:16,860 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 21:37:16,860 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 21:37:16,860 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 21:37:16,860 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 21:37:16,860 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 21:37:16,860 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 21:37:16,860 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 21:37:16,860 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 21:37:16,860 - DEBUG - Converting to final data structure
2025-11-08 21:37:16,860 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 21:37:16,860 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 21:37:16,860 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 21:37:16,860 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 21:37:16,860 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 21:37:16,861 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 21:59:58,286 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 21:59:58,287 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 21:59:58,294 - INFO - SQLModel query returned 53 rows
2025-11-08 21:59:58,295 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 21:59:58,295 - DEBUG - Starting to process and group results
2025-11-08 21:59:58,295 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 21:59:58,295 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 21:59:58,295 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 21:59:58,295 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 21:59:58,295 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 21:59:58,295 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 21:59:58,295 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 21:59:58,295 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 21:59:58,295 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 21:59:58,295 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 21:59:58,295 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 21:59:58,296 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 21:59:58,296 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 21:59:58,296 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 21:59:58,296 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 21:59:58,297 - DEBUG - Converting to final data structure
2025-11-08 21:59:58,297 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 21:59:58,297 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 21:59:58,297 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 21:59:58,297 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 21:59:58,297 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 21:59:58,297 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 22:00:14,050 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 22:00:14,050 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 22:00:14,052 - INFO - SQLModel query returned 53 rows
2025-11-08 22:00:14,052 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 22:00:14,052 - DEBUG - Starting to process and group results
2025-11-08 22:00:14,053 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 22:00:14,053 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 22:00:14,053 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 22:00:14,053 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 22:00:14,053 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 22:00:14,053 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 22:00:14,053 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 22:00:14,053 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 22:00:14,053 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 22:00:14,053 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 22:00:14,053 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 22:00:14,053 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 22:00:14,054 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 22:00:14,054 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 22:00:14,054 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 22:00:14,054 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 22:00:14,054 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 22:00:14,054 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 22:00:14,054 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 22:00:14,054 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 22:00:14,054 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 22:00:14,054 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 22:00:14,054 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 22:00:14,054 - DEBUG - Converting to final data structure
2025-11-08 22:00:14,054 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 22:00:14,055 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 22:00:14,055 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 22:00:14,055 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 22:00:14,055 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 22:00:14,055 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 22:01:39,613 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 22:01:39,613 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 22:01:39,615 - INFO - SQLModel query returned 53 rows
2025-11-08 22:01:39,615 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 22:01:39,615 - DEBUG - Starting to process and group results
2025-11-08 22:01:39,615 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 22:01:39,615 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 22:01:39,615 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 22:01:39,615 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 22:01:39,616 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 22:01:39,616 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 22:01:39,616 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 22:01:39,616 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 22:01:39,616 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 22:01:39,616 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 22:01:39,616 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 22:01:39,616 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 22:01:39,616 - DEBUG - Converting to final data structure
2025-11-08 22:01:39,616 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 22:01:39,617 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 22:01:39,617 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 22:01:39,617 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 22:01:39,617 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 22:01:39,617 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 22:02:42,742 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 22:02:42,742 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 22:02:42,744 - INFO - SQLModel query returned 53 rows
2025-11-08 22:02:42,744 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 22:02:42,744 - DEBUG - Starting to process and group results
2025-11-08 22:02:42,744 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 22:02:42,744 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 22:02:42,744 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 22:02:42,744 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 22:02:42,744 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 22:02:42,744 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 22:02:42,744 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 22:02:42,744 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 22:02:42,745 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 22:02:42,745 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 22:02:42,745 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 22:02:42,745 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 22:02:42,745 - DEBUG - Converting to final data structure
2025-11-08 22:02:42,745 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 22:02:42,745 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 22:02:42,745 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 22:02:42,745 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 22:02:42,745 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 22:02:42,746 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 22:04:22,884 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 22:04:22,884 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 22:04:22,886 - INFO - SQLModel query returned 53 rows
2025-11-08 22:04:22,886 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 22:04:22,886 - DEBUG - Starting to process and group results
2025-11-08 22:04:22,886 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 22:04:22,886 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 22:04:22,886 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 22:04:22,886 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 22:04:22,886 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 22:04:22,887 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 22:04:22,887 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 22:04:22,887 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 22:04:22,887 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 22:04:22,887 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 22:04:22,887 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 22:04:22,888 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 22:04:22,888 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 22:04:22,888 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 22:04:22,888 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 22:04:22,888 - DEBUG - Converting to final data structure
2025-11-08 22:04:22,888 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 22:04:22,888 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 22:04:22,888 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 22:04:22,888 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 22:04:22,888 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 22:04:22,888 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 23:21:33,357 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 23:21:33,358 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 23:21:34,640 - INFO - SQLModel query returned 53 rows
2025-11-08 23:21:34,640 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 23:21:34,641 - DEBUG - Starting to process and group results
2025-11-08 23:21:34,641 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 23:21:34,641 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 23:21:34,641 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 23:21:34,641 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 23:21:34,641 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 23:21:34,641 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 23:21:34,641 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 23:21:34,641 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 23:21:34,641 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 23:21:34,641 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 23:21:34,641 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 23:21:34,642 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 23:21:34,642 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 23:21:34,642 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 23:21:34,643 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 23:21:34,643 - DEBUG - Converting to final data structure
2025-11-08 23:21:34,643 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 23:21:34,643 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 23:21:34,643 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 23:21:34,643 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 23:21:34,643 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 23:21:34,702 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 23:23:15,560 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:23:15,560 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:23:15,560 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:23:15,736 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:23:15,980 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:15,998 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:15,998 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:16,014 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:16,029 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:16,039 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:23:16,059 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:23:16,065 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:23:16,068 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:23:16,071 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:23:16,073 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:23:16,076 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:23:16,078 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:23:16,081 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:23:16,084 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:23:16,087 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:23:16,089 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:23:16,092 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:23:16,095 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:23:16,098 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:23:16,103 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:23:16,107 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:16,108 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:16,111 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:23:16,111 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:23:16,116 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:16,116 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:16,120 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:16,120 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:23:16,124 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:16,124 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:23:16,128 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:23:16,128 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:23:16,132 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:23:16,132 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:23:16,132 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:23:16,136 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:23:16,137 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:23:16,137 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:23:16,141 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:23:16,145 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:23:16,145 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:23:16,145 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:23:16,145 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:23:16,145 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:23:16,149 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:23:16,153 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:23:16,153 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:23:16,153 - DEBUG - üîç Relationship Details:
2025-11-08 23:23:16,153 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:16,153 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:23:16,153 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:16,154 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:23:16,154 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:23:16,154 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:23:16,154 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:23:16,154 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:23:16,154 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:23:16,154 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:23:16,154 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:23:16,154 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:23:16,154 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:23:16,154 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:23:16,155 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:23:16,155 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:23:20,924 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:23:20,924 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:23:20,924 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:23:21,112 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:23:21,348 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:21,363 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:21,363 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:21,379 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:21,394 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:21,403 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:23:21,422 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:23:21,428 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:23:21,430 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:23:21,433 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:23:21,436 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:23:21,438 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:23:21,441 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:23:21,444 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:23:21,446 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:23:21,449 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:23:21,452 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:23:21,455 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:23:21,458 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:23:21,460 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:23:21,466 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:23:21,470 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:21,470 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:21,474 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:23:21,474 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:23:21,478 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:21,478 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:21,482 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:21,482 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:23:21,486 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:21,486 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:23:21,490 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:23:21,490 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:23:21,494 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:23:21,495 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:23:21,495 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:23:21,499 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:23:21,499 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:23:21,499 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:23:21,504 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:23:21,508 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:23:21,508 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:23:21,508 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:23:21,508 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:23:21,508 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:23:21,512 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:23:21,516 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:23:21,516 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:23:21,516 - DEBUG - üîç Relationship Details:
2025-11-08 23:23:21,517 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:21,517 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:23:21,517 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:21,517 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:23:21,517 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:23:21,517 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:23:21,517 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:23:21,517 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:23:21,517 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:23:21,517 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:23:21,517 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:23:21,517 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:23:21,517 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:23:21,517 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:23:21,518 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:23:21,518 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:23:22,172 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:22,187 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:22,188 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:23:22,200 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:23:22,205 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:23:22,207 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:23:22,210 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:23:22,212 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:23:22,214 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:23:22,217 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:23:22,219 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:23:22,222 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:23:22,225 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:23:22,227 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:23:22,230 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:23:22,233 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:23:22,236 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:23:22,241 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:23:22,245 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:22,245 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:22,249 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:23:22,249 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:23:22,253 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:22,253 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:22,256 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:22,256 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:23:22,260 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:22,260 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:23:22,264 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:23:22,264 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:23:22,268 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:23:22,268 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:23:22,268 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:23:22,272 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:23:22,273 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:23:22,273 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:23:22,277 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:23:22,281 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:23:22,281 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:23:22,281 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:23:22,281 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:23:22,281 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:23:22,286 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:23:22,290 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:23:22,290 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:23:22,290 - DEBUG - üîç Relationship Details:
2025-11-08 23:23:22,290 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:22,290 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:23:22,290 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:22,290 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:23:22,290 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:23:22,290 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:23:22,290 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:23:22,290 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:23:22,290 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:23:22,290 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:23:22,290 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:23:22,290 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:23:22,291 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:23:22,291 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:23:25,782 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:23:25,782 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:23:25,783 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:23:25,957 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:23:26,216 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:26,232 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:26,232 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:26,248 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:26,263 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:26,271 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:23:26,291 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:23:26,297 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:23:26,299 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:23:26,302 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:23:26,305 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:23:26,307 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:23:26,310 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:23:26,313 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:23:26,316 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:23:26,319 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:23:26,322 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:23:26,325 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:23:26,327 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:23:26,330 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:23:26,335 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:23:26,339 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:26,339 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:26,343 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:23:26,343 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:23:26,348 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:26,348 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:26,353 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:26,353 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:23:26,358 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:26,358 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:23:26,363 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:23:26,363 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:23:26,368 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:23:26,368 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:23:26,368 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:23:26,373 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:23:26,374 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:23:26,374 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:23:26,379 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:23:26,385 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:23:26,385 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:23:26,385 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:23:26,385 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:23:26,385 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:23:26,389 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:23:26,393 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:23:26,393 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:23:26,393 - DEBUG - üîç Relationship Details:
2025-11-08 23:23:26,393 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:26,394 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:23:26,394 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:26,394 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:23:26,394 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:23:26,394 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:23:26,394 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:23:26,394 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:23:26,394 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:23:26,394 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:23:26,394 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:23:26,394 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:23:26,394 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:23:26,394 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:23:26,395 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:23:26,395 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:23:27,108 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:27,124 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:27,125 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:23:27,137 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:23:27,142 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:23:27,144 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:23:27,147 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:23:27,149 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:23:27,152 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:23:27,154 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:23:27,157 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:23:27,160 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:23:27,163 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:23:27,165 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:23:27,169 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:23:27,171 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:23:27,174 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:23:27,179 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:23:27,183 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:27,183 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:27,187 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:23:27,188 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:23:27,191 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:27,192 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:27,196 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:27,196 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:23:27,200 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:27,200 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:23:27,204 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:23:27,204 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:23:27,208 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:23:27,208 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:23:27,208 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:23:27,213 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:23:27,213 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:23:27,213 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:23:27,217 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:23:27,221 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:23:27,221 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:23:27,222 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:23:27,222 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:23:27,222 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:23:27,226 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:23:27,230 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:23:27,230 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:23:27,230 - DEBUG - üîç Relationship Details:
2025-11-08 23:23:27,230 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:27,230 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:23:27,230 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:27,230 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:23:27,230 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:23:27,230 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:23:27,230 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:23:27,230 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:23:27,231 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:23:27,231 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:23:27,231 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:23:27,231 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:23:27,231 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:23:27,231 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:23:44,084 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:23:44,084 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:23:44,085 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:23:44,255 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:23:44,486 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:44,502 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:44,502 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:44,517 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:44,532 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:44,540 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:23:44,559 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:23:44,565 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:23:44,567 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:23:44,570 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:23:44,573 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:23:44,575 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:23:44,578 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:23:44,580 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:23:44,583 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:23:44,585 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:23:44,588 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:23:44,591 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:23:44,593 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:23:44,596 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:23:44,602 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:23:44,606 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:44,606 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:44,610 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:23:44,610 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:23:44,614 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:44,614 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:44,618 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:44,618 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:23:44,622 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:44,622 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:23:44,626 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:23:44,626 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:23:44,630 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:23:44,630 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:23:44,630 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:23:44,633 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:23:44,634 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:23:44,634 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:23:44,637 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:23:44,642 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:23:44,642 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:23:44,642 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:23:44,642 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:23:44,642 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:23:44,646 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:23:44,650 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:23:44,650 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:23:44,651 - DEBUG - üîç Relationship Details:
2025-11-08 23:23:44,651 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:44,651 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:23:44,651 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:44,651 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:23:44,651 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:23:44,651 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:23:44,651 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:23:44,651 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:23:44,651 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:23:44,651 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:23:44,651 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:23:44,651 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:23:44,651 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:23:44,652 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:23:44,653 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:23:44,653 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:23:45,304 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:23:45,319 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:23:45,320 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:23:45,332 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:23:45,336 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:23:45,339 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:23:45,342 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:23:45,344 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:23:45,347 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:23:45,350 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:23:45,353 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:23:45,356 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:23:45,358 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:23:45,361 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:23:45,364 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:23:45,367 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:23:45,370 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:23:45,375 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:23:45,379 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:45,379 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:45,383 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:23:45,383 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:23:45,387 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:45,388 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:23:45,392 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:45,392 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:23:45,396 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:23:45,396 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:23:45,400 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:23:45,400 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:23:45,404 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:23:45,404 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:23:45,404 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:23:45,408 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:23:45,408 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:23:45,408 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:23:45,412 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:23:45,416 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:23:45,416 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:23:45,416 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:23:45,416 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:23:45,416 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:23:45,420 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:23:45,424 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:23:45,424 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:23:45,424 - DEBUG - üîç Relationship Details:
2025-11-08 23:23:45,425 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:45,425 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:23:45,425 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:23:45,425 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:23:45,425 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:23:45,425 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:23:45,425 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:23:45,425 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:23:45,425 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:23:45,425 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:23:45,425 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:23:45,425 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:23:45,425 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:23:45,426 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:24:19,229 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:24:19,229 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:24:19,229 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:24:19,400 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:24:19,692 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:24:19,707 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:24:19,708 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:24:19,723 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:24:19,738 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:24:19,747 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:24:19,767 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:24:19,773 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:24:19,775 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:24:19,778 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:24:19,781 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:24:19,783 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:24:19,786 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:24:19,788 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:24:19,791 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:24:19,794 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:24:19,797 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:24:19,800 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:24:19,802 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:24:19,805 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:24:19,811 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:24:19,815 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:24:19,815 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:24:19,819 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:24:19,819 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:24:19,823 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:24:19,823 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:24:19,828 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:24:19,828 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:24:19,832 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:24:19,832 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:24:19,836 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:24:19,836 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:24:19,840 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:24:19,841 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:24:19,841 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:24:19,845 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:24:19,845 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:24:19,845 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:24:19,849 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:24:19,854 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:24:19,854 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:24:19,855 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:24:19,855 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:24:19,855 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:24:19,860 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:24:19,864 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:24:19,864 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:24:19,864 - DEBUG - üîç Relationship Details:
2025-11-08 23:24:19,864 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:24:19,864 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:24:19,864 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:24:19,864 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:24:19,864 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:24:19,864 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:24:19,864 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:24:19,864 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:24:19,864 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:24:19,865 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:24:19,865 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:24:19,865 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:24:19,865 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:24:19,865 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:24:19,867 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:24:19,867 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:24:20,523 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:24:20,539 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:24:20,540 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:24:20,553 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:24:20,557 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:24:20,560 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:24:20,562 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:24:20,565 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:24:20,568 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:24:20,570 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:24:20,573 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:24:20,576 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:24:20,578 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:24:20,581 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:24:20,584 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:24:20,587 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:24:20,589 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:24:20,595 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:24:20,599 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:24:20,599 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:24:20,604 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:24:20,604 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:24:20,608 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:24:20,608 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:24:20,612 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:24:20,612 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:24:20,617 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:24:20,617 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:24:20,621 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:24:20,621 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:24:20,625 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:24:20,625 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:24:20,625 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:24:20,629 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:24:20,629 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:24:20,629 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:24:20,633 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:24:20,638 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:24:20,638 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:24:20,638 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:24:20,638 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:24:20,638 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:24:20,642 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:24:20,646 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:24:20,646 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:24:20,646 - DEBUG - üîç Relationship Details:
2025-11-08 23:24:20,646 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:24:20,646 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:24:20,646 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:24:20,646 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:24:20,646 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:24:20,646 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:24:20,646 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:24:20,646 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:24:20,646 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:24:20,647 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:24:20,647 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:24:20,647 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:24:20,647 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:24:20,647 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:43:16,276 - INFO - Database engine created with pool_size=10
2025-11-08 23:43:16,276 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-08 23:43:16,277 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-08 23:43:17,293 - INFO - SQLModel query returned 53 rows
2025-11-08 23:43:17,294 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-08 23:43:17,294 - DEBUG - Starting to process and group results
2025-11-08 23:43:17,294 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 23:43:17,294 - DEBUG - Creating new command group: Western Naval Command
2025-11-08 23:43:17,294 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 23:43:17,294 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-08 23:43:17,294 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-08 23:43:17,294 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-08 23:43:17,294 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-08 23:43:17,294 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-08 23:43:17,294 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-08 23:43:17,295 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-08 23:43:17,295 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-08 23:43:17,295 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-08 23:43:17,296 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-08 23:43:17,296 - INFO - Processed 3 unique ships into 1 command groups
2025-11-08 23:43:17,296 - DEBUG - Converting to final data structure
2025-11-08 23:43:17,296 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-08 23:43:17,296 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-08 23:43:17,296 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-08 23:43:17,296 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-08 23:43:17,296 - DEBUG - Command groups: ['Western Naval Command']
2025-11-08 23:43:17,297 - INFO - Successfully retrieved hierarchical ship data
2025-11-08 23:46:34,601 - ERROR - Database session error: 'SensorMetadataCreate' object has no attribute 'sensor_id'
2025-11-08 23:46:34,602 - ERROR - Database session error in FastAPI dependency: 500: Internal server error
2025-11-08 23:47:10,436 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:47:10,436 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:47:10,436 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:47:10,606 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:47:10,854 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:10,870 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:10,870 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:10,886 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:10,902 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:10,912 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:10,933 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:10,940 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:10,943 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:10,947 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:10,950 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:10,954 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:10,958 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:10,961 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:10,965 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:10,969 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:10,972 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:10,976 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:10,978 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:10,981 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:10,986 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:10,990 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:10,990 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:10,994 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:10,994 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:10,998 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:10,998 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:11,002 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:11,002 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:11,006 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:11,007 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:11,010 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:11,011 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:11,015 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:11,015 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:11,015 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:11,019 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:11,019 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:11,019 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:11,023 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:11,027 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:11,027 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:11,027 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:11,027 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:11,027 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:11,031 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:11,035 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:11,035 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:11,035 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:11,035 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,035 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:11,035 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,035 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,036 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,036 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:11,036 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,036 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:11,036 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,036 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:11,036 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:11,036 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:11,036 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:11,036 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:11,038 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:47:11,038 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:47:11,689 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:11,705 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:11,705 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:11,718 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:11,722 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:11,725 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:11,727 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:11,730 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:11,732 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:11,735 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:11,738 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:11,740 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:11,743 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:11,746 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:11,749 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:11,751 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:11,754 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:11,759 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:11,763 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:11,763 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:11,767 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:11,767 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:11,771 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:11,771 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:11,775 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:11,775 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:11,779 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:11,779 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:11,783 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:11,783 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:11,787 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:11,787 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:11,787 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:11,791 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:11,791 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:11,792 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:11,796 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:11,800 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:11,800 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:11,800 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:11,800 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:11,800 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:11,804 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:11,808 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:11,808 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:11,808 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:11,808 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,808 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:11,808 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,808 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,809 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,809 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:11,809 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,809 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:11,809 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:11,809 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:11,809 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:11,809 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:11,809 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:11,809 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:16,440 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:47:16,441 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:47:16,441 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:47:16,610 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:47:16,840 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:16,855 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:16,855 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:16,871 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:16,885 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:16,894 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:16,914 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:16,919 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:16,922 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:16,925 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:16,927 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:16,930 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:16,933 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:16,936 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:16,939 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:16,942 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:16,945 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:16,950 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:16,953 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:16,956 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:16,963 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:16,967 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:16,967 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:16,972 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:16,972 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:16,977 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:16,978 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:16,982 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:16,982 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:16,987 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:16,988 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:16,992 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:16,992 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:16,997 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:16,997 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:16,997 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:17,002 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:17,002 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:17,002 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:17,007 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:17,012 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:17,012 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:17,013 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:17,013 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:17,013 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:17,018 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:17,022 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:17,022 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:17,023 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:17,023 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,023 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:17,023 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,023 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,023 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,023 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:17,023 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,023 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:17,023 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,023 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:17,023 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:17,023 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:17,023 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:17,024 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:17,025 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:47:17,025 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:47:17,674 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:17,689 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:17,690 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:17,702 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:17,707 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:17,709 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:17,712 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:17,714 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:17,717 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:17,719 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:17,722 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:17,725 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:17,728 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:17,730 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:17,733 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:17,736 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:17,738 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:17,744 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:17,748 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:17,748 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:17,752 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:17,752 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:17,756 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:17,756 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:17,760 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:17,760 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:17,764 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:17,764 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:17,768 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:17,768 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:17,772 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:17,772 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:17,772 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:17,777 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:17,777 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:17,777 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:17,781 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:17,785 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:17,785 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:17,785 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:17,785 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:17,785 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:17,789 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:17,793 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:17,793 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:17,793 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:17,794 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,794 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:17,794 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,794 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,794 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,794 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:17,794 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,794 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:17,794 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:17,794 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:17,794 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:17,794 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:17,794 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:17,794 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:27,058 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:47:27,059 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:47:27,059 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:47:27,226 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:47:27,463 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:27,478 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:27,478 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:27,495 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:27,511 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:27,520 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:27,539 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:27,545 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:27,547 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:27,550 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:27,552 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:27,555 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:27,557 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:27,560 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:27,563 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:27,565 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:27,568 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:27,571 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:27,574 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:27,576 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:27,582 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:27,586 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:27,586 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:27,590 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:27,590 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:27,594 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:27,594 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:27,599 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:27,599 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:27,603 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:27,603 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:27,607 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:27,607 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:27,612 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:27,612 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:27,612 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:27,616 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:27,616 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:27,616 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:27,620 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:27,624 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:27,625 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:27,625 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:27,625 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:27,625 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:27,629 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:27,633 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:27,633 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:27,634 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:27,634 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:27,634 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:27,634 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:27,634 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:27,634 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:27,634 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:27,634 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:27,634 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:27,634 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:27,634 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:27,634 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:27,634 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:27,634 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:27,634 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:27,635 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:47:27,635 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:47:28,754 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:28,769 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:28,770 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:28,783 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:28,788 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:28,790 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:28,793 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:28,796 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:28,799 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:28,801 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:28,804 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:28,807 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:28,809 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:28,812 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:28,815 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:28,818 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:28,821 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:28,826 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:28,830 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:28,830 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:28,834 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:28,834 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:28,838 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:28,838 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:28,843 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:28,843 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:28,848 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:28,848 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:28,852 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:28,852 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:28,857 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:28,857 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:28,857 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:28,861 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:28,861 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:28,861 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:28,866 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:28,870 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:28,870 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:28,870 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:28,870 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:28,870 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:28,875 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:28,879 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:28,879 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:28,879 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:28,879 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:28,879 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:28,879 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:28,880 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:28,880 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:28,880 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:28,880 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:28,880 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:28,880 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:28,880 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:28,880 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:28,880 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:28,880 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:28,880 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:29,834 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:47:29,834 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:47:29,834 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:47:30,003 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:47:30,239 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:30,255 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:30,255 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:30,271 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:30,286 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:30,295 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:30,315 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:30,321 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:30,323 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:30,326 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:30,329 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:30,332 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:30,334 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:30,337 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:30,340 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:30,342 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:30,345 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:30,348 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:30,351 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:30,353 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:30,359 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:30,364 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:30,364 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:30,368 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:30,368 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:30,372 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:30,372 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:30,376 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:30,376 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:30,381 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:30,381 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:30,385 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:30,385 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:30,389 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:30,389 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:30,389 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:30,393 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:30,393 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:30,393 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:30,397 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:30,402 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:30,402 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:30,402 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:30,402 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:30,402 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:30,406 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:30,410 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:30,410 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:30,410 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:30,410 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:30,410 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:30,411 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:30,411 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:30,411 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:30,411 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:30,411 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:30,411 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:30,411 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:30,411 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:30,411 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:30,411 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:30,411 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:30,411 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:30,413 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:47:30,413 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:47:31,088 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:31,104 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:31,105 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:31,117 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:31,122 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:31,125 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:31,127 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:31,130 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:31,133 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:31,135 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:31,138 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:31,141 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:31,144 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:31,147 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:31,150 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:31,153 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:31,156 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:31,161 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:31,166 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:31,166 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:31,170 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:31,170 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:31,174 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:31,174 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:31,180 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:31,180 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:31,188 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:31,188 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:31,194 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:31,194 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:31,198 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:31,198 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:31,198 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:31,203 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:31,203 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:31,203 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:31,207 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:31,212 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:31,212 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:31,212 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:31,212 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:31,212 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:31,216 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:31,221 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:31,221 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:31,221 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:31,221 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:31,221 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:31,221 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:31,221 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:31,221 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:31,221 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:31,221 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:31,221 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:31,221 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:31,221 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:31,222 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:31,222 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:31,222 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:31,222 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:32,131 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:47:32,131 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:47:32,131 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:47:32,294 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:47:32,525 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:32,540 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:32,540 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:32,556 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:32,571 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:32,579 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:32,598 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:32,604 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:32,607 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:32,609 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:32,612 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:32,614 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:32,617 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:32,620 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:32,622 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:32,625 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:32,628 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:32,631 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:32,633 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:32,636 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:32,641 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:32,645 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:32,646 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:32,649 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:32,649 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:32,653 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:32,653 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:32,657 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:32,658 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:32,662 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:32,662 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:32,666 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:32,666 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:32,670 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:32,670 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:32,670 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:32,674 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:32,674 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:32,674 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:32,678 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:32,683 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:32,683 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:32,683 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:32,683 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:32,683 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:32,687 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:32,691 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:32,691 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:32,691 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:32,691 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:32,691 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:32,691 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:32,691 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:32,691 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:32,691 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:32,691 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:32,691 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:32,691 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:32,692 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:32,692 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:32,692 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:32,692 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:32,692 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:32,693 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:47:32,693 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:47:33,340 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:33,355 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:33,356 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:33,369 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:33,373 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:33,376 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:33,379 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:33,381 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:33,384 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:33,387 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:33,389 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:33,392 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:33,395 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:33,398 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:33,401 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:33,403 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:33,406 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:33,411 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:33,415 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:33,415 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:33,420 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:33,420 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:33,424 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:33,424 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:33,429 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:33,429 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:33,433 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:33,433 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:33,437 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:33,437 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:33,441 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:33,441 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:33,441 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:33,445 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:33,445 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:33,445 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:33,449 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:33,453 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:33,453 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:33,454 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:33,454 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:33,454 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:33,458 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:33,462 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:33,462 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:33,462 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:33,462 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:33,462 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:33,462 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:33,462 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:33,462 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:33,462 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:33,462 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:33,462 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:33,462 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:33,462 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:33,462 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:33,462 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:33,462 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:33,462 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:39,404 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:47:39,404 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:47:39,404 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:47:39,571 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:47:39,812 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:39,827 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:39,828 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:39,843 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:39,858 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:39,867 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:39,888 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:39,894 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:39,898 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:39,901 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:39,904 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:39,907 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:39,910 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:39,914 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:39,917 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:39,921 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:39,924 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:39,928 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:39,931 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:39,934 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:39,940 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:39,944 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:39,944 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:39,949 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:39,949 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:39,953 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:39,954 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:39,958 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:39,958 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:39,963 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:39,963 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:39,967 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:39,967 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:39,972 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:39,972 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:39,972 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:39,976 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:39,976 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:39,977 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:39,981 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:39,986 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:39,986 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:39,986 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:39,986 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:39,986 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:39,990 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:39,995 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:39,995 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:39,995 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:39,995 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:39,995 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:39,995 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:39,995 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:39,995 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:39,995 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:39,995 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:39,996 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:39,996 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:39,996 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:39,996 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:39,996 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:39,996 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:39,996 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:39,998 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:47:39,998 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:47:42,442 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-08 23:47:42,442 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-08 23:47:42,442 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-08 23:47:42,607 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-08 23:47:42,835 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:42,850 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:42,850 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:42,866 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:42,880 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:42,889 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:42,908 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:42,914 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:42,916 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:42,919 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:42,922 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:42,924 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:42,927 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:42,929 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:42,932 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:42,935 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:42,937 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:42,940 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:42,943 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:42,946 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:42,951 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:42,955 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:42,955 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:42,959 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:42,959 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:42,963 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:42,963 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:42,967 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:42,967 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:42,972 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:42,972 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:42,976 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:42,976 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:42,980 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:42,980 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:42,980 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:42,984 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:42,984 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:42,984 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:42,988 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:42,992 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:42,992 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:42,992 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:42,992 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:42,992 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:42,996 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:43,000 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:43,000 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:43,000 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:43,000 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,001 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:43,001 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,001 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,001 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,001 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:43,001 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,001 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:43,001 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,001 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:43,001 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:43,001 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:43,001 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:43,001 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:43,002 - INFO - üìå Loaded conversation memory from disk.
2025-11-08 23:47:43,002 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-08 23:47:43,650 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-08 23:47:43,665 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-08 23:47:43,666 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-08 23:47:43,678 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-08 23:47:43,682 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-08 23:47:43,685 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-08 23:47:43,688 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-08 23:47:43,690 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-08 23:47:43,693 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-08 23:47:43,695 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-08 23:47:43,698 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-08 23:47:43,701 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-08 23:47:43,703 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-08 23:47:43,706 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-08 23:47:43,709 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-08 23:47:43,711 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-08 23:47:43,714 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-08 23:47:43,719 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-08 23:47:43,723 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:43,723 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:43,727 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-08 23:47:43,727 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-08 23:47:43,731 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:43,731 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-08 23:47:43,735 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:43,735 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-08 23:47:43,739 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-08 23:47:43,739 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-08 23:47:43,743 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-08 23:47:43,743 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-08 23:47:43,748 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-08 23:47:43,748 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-08 23:47:43,748 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-08 23:47:43,752 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-08 23:47:43,752 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-08 23:47:43,752 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-08 23:47:43,756 - DEBUG - üîó Foreign keys for ships: []
2025-11-08 23:47:43,760 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-08 23:47:43,760 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-08 23:47:43,760 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-08 23:47:43,761 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-08 23:47:43,761 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-08 23:47:43,765 - DEBUG - üîó Foreign keys for systems: []
2025-11-08 23:47:43,768 - DEBUG - üîó Foreign keys for users: []
2025-11-08 23:47:43,768 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-08 23:47:43,769 - DEBUG - üîç Relationship Details:
2025-11-08 23:47:43,769 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,769 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-08 23:47:43,769 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,769 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,769 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,769 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-08 23:47:43,769 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,769 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-08 23:47:43,769 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-08 23:47:43,769 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-08 23:47:43,769 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-08 23:47:43,769 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-08 23:47:43,770 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-08 23:47:43,770 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-08 23:47:47,795 - INFO - Database engine created with pool_size=10
2025-11-08 23:47:47,798 - ERROR - Database session error: 'SensorMetadataCreate' object has no attribute 'sensor_id'
2025-11-08 23:47:47,799 - ERROR - Database session error in FastAPI dependency: 500: Internal server error 'SensorMetadataCreate' object has no attribute 'sensor_id'
2025-11-09 00:02:09,030 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:02:09,030 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:02:09,030 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:02:09,196 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:02:09,430 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:09,448 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:09,449 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:09,473 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:09,489 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:09,499 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:02:09,522 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:02:09,529 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:02:09,532 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:02:09,536 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:02:09,539 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:02:09,542 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:02:09,546 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:02:09,549 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:02:09,554 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:02:09,558 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:02:09,562 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:02:09,566 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:02:09,570 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:02:09,573 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:02:09,581 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:02:09,586 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:09,587 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:09,591 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:02:09,592 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:02:09,597 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:09,598 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:09,603 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:09,603 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:02:09,609 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:09,609 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:02:09,613 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:02:09,614 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:02:09,619 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:02:09,619 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:02:09,619 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:02:09,624 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:02:09,624 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:02:09,624 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:02:09,631 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:02:09,638 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:02:09,638 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:02:09,638 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:02:09,638 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:02:09,639 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:02:09,645 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:02:09,650 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:02:09,650 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:02:09,651 - DEBUG - üîç Relationship Details:
2025-11-09 00:02:09,651 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:09,651 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:02:09,651 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:09,651 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:02:09,651 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:02:09,651 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:02:09,651 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:02:09,651 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:02:09,651 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:02:09,651 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:02:09,651 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:02:09,651 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:02:09,652 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:02:09,652 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:02:09,653 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:02:09,653 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:02:10,350 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:10,366 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:10,367 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:02:10,379 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:02:10,384 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:02:10,386 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:02:10,389 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:02:10,392 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:02:10,394 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:02:10,397 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:02:10,399 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:02:10,402 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:02:10,405 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:02:10,408 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:02:10,411 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:02:10,413 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:02:10,416 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:02:10,421 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:02:10,425 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:10,425 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:10,429 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:02:10,429 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:02:10,433 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:10,433 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:10,438 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:10,438 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:02:10,442 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:10,442 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:02:10,446 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:02:10,446 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:02:10,450 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:02:10,450 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:02:10,450 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:02:10,455 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:02:10,455 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:02:10,455 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:02:10,459 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:02:10,463 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:02:10,463 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:02:10,463 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:02:10,463 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:02:10,464 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:02:10,468 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:02:10,472 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:02:10,472 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:02:10,472 - DEBUG - üîç Relationship Details:
2025-11-09 00:02:10,472 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:10,472 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:02:10,472 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:10,472 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:02:10,472 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:02:10,472 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:02:10,472 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:02:10,472 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:02:10,472 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:02:10,472 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:02:10,472 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:02:10,472 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:02:10,472 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:02:10,473 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:02:19,207 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:02:19,207 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:02:19,207 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:02:19,377 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:02:24,807 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:02:24,807 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:02:24,807 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:02:24,990 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:02:25,262 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:25,279 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:25,279 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:25,300 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:25,316 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:25,325 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:02:25,345 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:02:25,351 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:02:25,353 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:02:25,356 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:02:25,359 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:02:25,361 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:02:25,364 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:02:25,366 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:02:25,369 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:02:25,372 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:02:25,375 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:02:25,378 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:02:25,380 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:02:25,383 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:02:25,389 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:02:25,393 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:25,393 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:25,397 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:02:25,397 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:02:25,401 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:25,401 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:25,405 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:25,405 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:02:25,409 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:25,409 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:02:25,413 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:02:25,413 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:02:25,417 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:02:25,417 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:02:25,417 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:02:25,421 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:02:25,421 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:02:25,421 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:02:25,425 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:02:25,429 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:02:25,430 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:02:25,430 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:02:25,430 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:02:25,430 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:02:25,434 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:02:25,438 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:02:25,438 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:02:25,438 - DEBUG - üîç Relationship Details:
2025-11-09 00:02:25,438 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:25,438 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:02:25,438 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:25,438 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:02:25,438 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:02:25,438 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:02:25,438 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:02:25,438 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:02:25,438 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:02:25,438 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:02:25,438 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:02:25,438 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:02:25,438 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:02:25,438 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:02:25,440 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:02:25,440 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:02:26,102 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:26,118 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:26,119 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:02:26,135 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:02:26,141 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:02:26,144 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:02:26,148 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:02:26,152 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:02:26,156 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:02:26,160 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:02:26,163 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:02:26,167 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:02:26,169 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:02:26,172 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:02:26,176 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:02:26,180 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:02:26,185 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:02:26,191 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:02:26,196 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:26,197 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:26,201 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:02:26,201 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:02:26,206 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:26,206 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:26,211 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:26,211 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:02:26,216 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:26,217 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:02:26,221 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:02:26,221 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:02:26,226 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:02:26,227 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:02:26,227 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:02:26,232 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:02:26,232 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:02:26,232 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:02:26,237 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:02:26,242 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:02:26,243 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:02:26,243 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:02:26,243 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:02:26,243 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:02:26,248 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:02:26,253 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:02:26,253 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:02:26,254 - DEBUG - üîç Relationship Details:
2025-11-09 00:02:26,254 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:26,254 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:02:26,254 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:26,254 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:02:26,254 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:02:26,254 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:02:26,254 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:02:26,254 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:02:26,254 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:02:26,254 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:02:26,254 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:02:26,255 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:02:26,255 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:02:26,255 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:02:27,187 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:02:27,187 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:02:27,187 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:02:27,351 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:02:27,582 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:27,597 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:27,597 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:27,613 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:27,627 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:27,636 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:02:27,655 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:02:27,661 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:02:27,663 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:02:27,666 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:02:27,668 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:02:27,671 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:02:27,674 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:02:27,676 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:02:27,679 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:02:27,682 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:02:27,684 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:02:27,687 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:02:27,690 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:02:27,693 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:02:27,698 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:02:27,702 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:27,702 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:27,706 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:02:27,706 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:02:27,710 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:27,710 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:27,714 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:27,714 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:02:27,718 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:27,718 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:02:27,722 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:02:27,722 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:02:27,727 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:02:27,727 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:02:27,727 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:02:27,731 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:02:27,731 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:02:27,731 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:02:27,735 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:02:27,739 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:02:27,739 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:02:27,739 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:02:27,740 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:02:27,740 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:02:27,744 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:02:27,747 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:02:27,747 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:02:27,747 - DEBUG - üîç Relationship Details:
2025-11-09 00:02:27,748 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:27,748 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:02:27,748 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:27,748 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:02:27,748 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:02:27,748 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:02:27,748 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:02:27,748 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:02:27,748 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:02:27,748 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:02:27,748 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:02:27,748 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:02:27,748 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:02:27,748 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:02:27,749 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:02:27,749 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:02:28,395 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:28,410 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:28,411 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:02:28,423 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:02:28,428 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:02:28,430 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:02:28,433 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:02:28,436 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:02:28,438 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:02:28,441 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:02:28,444 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:02:28,446 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:02:28,449 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:02:28,452 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:02:28,455 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:02:28,457 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:02:28,460 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:02:28,465 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:02:28,469 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:28,469 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:28,474 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:02:28,474 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:02:28,478 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:28,478 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:28,482 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:28,482 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:02:28,486 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:28,486 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:02:28,490 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:02:28,490 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:02:28,494 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:02:28,494 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:02:28,494 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:02:28,498 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:02:28,498 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:02:28,498 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:02:28,502 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:02:28,506 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:02:28,506 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:02:28,507 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:02:28,507 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:02:28,507 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:02:28,511 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:02:28,515 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:02:28,515 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:02:28,515 - DEBUG - üîç Relationship Details:
2025-11-09 00:02:28,515 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:28,515 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:02:28,515 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:28,515 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:02:28,515 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:02:28,515 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:02:28,515 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:02:28,515 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:02:28,515 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:02:28,515 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:02:28,515 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:02:28,515 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:02:28,515 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:02:28,515 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:02:37,445 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:02:37,445 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:02:37,445 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:02:37,610 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:02:37,841 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:37,856 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:37,856 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:37,872 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:37,886 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:37,895 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:02:37,945 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:02:37,951 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:02:37,953 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:02:37,956 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:02:37,958 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:02:37,961 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:02:37,963 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:02:37,966 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:02:37,969 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:02:37,971 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:02:37,974 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:02:37,977 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:02:37,979 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:02:37,982 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:02:37,987 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:02:37,991 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:37,991 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:37,995 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:02:37,995 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:02:37,999 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:37,999 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:38,003 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:38,003 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:02:38,007 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:38,007 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:02:38,011 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:02:38,011 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:02:38,015 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:02:38,015 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:02:38,015 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:02:38,019 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:02:38,019 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:02:38,019 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:02:38,023 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:02:38,027 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:02:38,027 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:02:38,027 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:02:38,027 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:02:38,028 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:02:38,031 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:02:38,035 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:02:38,035 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:02:38,035 - DEBUG - üîç Relationship Details:
2025-11-09 00:02:38,035 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,036 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:02:38,036 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,036 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,036 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,036 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:02:38,036 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,036 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:02:38,036 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,036 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:02:38,036 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:02:38,036 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:02:38,036 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:02:38,036 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:02:38,037 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:02:38,037 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:02:38,688 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:02:38,704 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:02:38,705 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:02:38,717 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:02:38,721 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:02:38,724 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:02:38,726 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:02:38,729 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:02:38,731 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:02:38,734 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:02:38,737 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:02:38,740 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:02:38,742 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:02:38,745 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:02:38,748 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:02:38,750 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:02:38,753 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:02:38,758 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:02:38,762 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:38,762 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:38,767 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:02:38,767 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:02:38,771 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:38,771 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:02:38,775 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:38,776 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:02:38,780 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:02:38,780 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:02:38,784 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:02:38,784 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:02:38,788 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:02:38,788 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:02:38,788 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:02:38,792 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:02:38,792 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:02:38,792 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:02:38,797 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:02:38,801 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:02:38,801 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:02:38,801 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:02:38,801 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:02:38,801 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:02:38,805 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:02:38,809 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:02:38,809 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:02:38,809 - DEBUG - üîç Relationship Details:
2025-11-09 00:02:38,809 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,809 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:02:38,809 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,810 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,810 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,810 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:02:38,810 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,810 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:02:38,810 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:02:38,810 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:02:38,810 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:02:38,810 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:02:38,810 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:02:38,810 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:03:16,913 - INFO - Database engine created with pool_size=10
2025-11-09 00:03:17,266 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 00:03:17,267 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 00:03:17,271 - INFO - SQLModel query returned 53 rows
2025-11-09 00:03:17,271 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 00:03:17,271 - DEBUG - Starting to process and group results
2025-11-09 00:03:17,271 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:03:17,271 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 00:03:17,271 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:03:17,271 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 00:03:17,271 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 00:03:17,271 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 00:03:17,271 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:03:17,272 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 00:03:17,272 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 00:03:17,272 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 00:03:17,272 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 00:03:17,273 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 00:03:17,273 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 00:03:17,273 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 00:03:17,273 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 00:03:17,273 - DEBUG - Converting to final data structure
2025-11-09 00:03:17,273 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 00:03:17,273 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 00:03:17,273 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 00:03:17,273 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 00:03:17,273 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 00:03:17,273 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 00:04:29,227 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 00:04:29,228 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 00:04:29,231 - INFO - SQLModel query returned 53 rows
2025-11-09 00:04:29,231 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 00:04:29,231 - DEBUG - Starting to process and group results
2025-11-09 00:04:29,231 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:04:29,231 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 00:04:29,231 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:04:29,231 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 00:04:29,231 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 00:04:29,231 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 00:04:29,231 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:04:29,232 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 00:04:29,232 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 00:04:29,232 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 00:04:29,232 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 00:04:29,232 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 00:04:29,232 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:04:29,232 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 00:04:29,232 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 00:04:29,232 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 00:04:29,232 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 00:04:29,232 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 00:04:29,233 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 00:04:29,233 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 00:04:29,233 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 00:04:29,233 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 00:04:29,233 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 00:04:29,233 - DEBUG - Converting to final data structure
2025-11-09 00:04:29,233 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 00:04:29,233 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 00:04:29,233 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 00:04:29,233 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 00:04:29,233 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 00:04:29,234 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 00:13:39,191 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:13:39,191 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:13:39,192 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:13:39,409 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:13:39,717 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:39,733 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:39,733 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:39,748 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:39,768 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:39,778 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:13:39,798 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:13:39,803 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:13:39,806 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:13:39,809 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:13:39,811 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:13:39,814 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:13:39,816 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:13:39,819 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:13:39,822 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:13:39,824 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:13:39,827 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:13:39,830 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:13:39,832 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:13:39,835 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:13:39,841 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:13:39,845 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:39,845 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:39,849 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:13:39,849 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:13:39,853 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:39,853 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:39,858 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:39,858 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:13:39,862 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:39,862 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:13:39,866 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:13:39,866 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:13:39,870 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:13:39,870 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:13:39,870 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:13:39,874 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:13:39,874 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:13:39,874 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:13:39,878 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:13:39,882 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:13:39,883 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:13:39,883 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:13:39,883 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:13:39,883 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:13:39,887 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:13:39,891 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:13:39,891 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:13:39,891 - DEBUG - üîç Relationship Details:
2025-11-09 00:13:39,891 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:39,891 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:13:39,891 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:39,891 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:13:39,891 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:13:39,891 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:13:39,891 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:13:39,891 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:13:39,891 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:13:39,891 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:13:39,891 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:13:39,891 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:13:39,891 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:13:39,891 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:13:39,892 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:13:39,893 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:13:40,660 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:40,675 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:40,675 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:13:40,688 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:13:40,692 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:13:40,695 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:13:40,697 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:13:40,700 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:13:40,702 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:13:40,705 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:13:40,708 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:13:40,710 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:13:40,713 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:13:40,715 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:13:40,718 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:13:40,721 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:13:40,723 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:13:40,729 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:13:40,733 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:40,733 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:40,737 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:13:40,737 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:13:40,741 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:40,741 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:40,746 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:40,746 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:13:40,751 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:40,751 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:13:40,755 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:13:40,755 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:13:40,759 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:13:40,759 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:13:40,759 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:13:40,764 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:13:40,764 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:13:40,764 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:13:40,768 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:13:40,772 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:13:40,773 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:13:40,773 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:13:40,773 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:13:40,773 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:13:40,777 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:13:40,781 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:13:40,781 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:13:40,781 - DEBUG - üîç Relationship Details:
2025-11-09 00:13:40,781 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:40,781 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:13:40,781 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:40,781 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:13:40,781 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:13:40,781 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:13:40,781 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:13:40,781 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:13:40,781 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:13:40,781 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:13:40,781 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:13:40,782 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:13:40,782 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:13:40,782 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:13:46,227 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:13:46,227 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:13:46,227 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:13:46,392 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:13:46,620 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:46,635 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:46,635 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:46,651 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:46,666 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:46,674 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:13:46,694 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:13:46,700 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:13:46,703 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:13:46,705 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:13:46,708 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:13:46,710 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:13:46,713 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:13:46,716 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:13:46,718 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:13:46,721 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:13:46,724 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:13:46,727 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:13:46,729 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:13:46,732 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:13:46,737 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:13:46,741 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:46,741 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:46,745 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:13:46,745 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:13:46,749 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:46,750 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:46,753 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:46,753 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:13:46,757 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:46,757 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:13:46,761 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:13:46,761 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:13:46,765 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:13:46,766 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:13:46,766 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:13:46,770 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:13:46,770 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:13:46,770 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:13:46,774 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:13:46,778 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:13:46,778 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:13:46,778 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:13:46,778 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:13:46,778 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:13:46,783 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:13:46,787 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:13:46,787 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:13:46,787 - DEBUG - üîç Relationship Details:
2025-11-09 00:13:46,787 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:46,787 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:13:46,788 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:46,788 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:13:46,788 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:13:46,788 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:13:46,788 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:13:46,788 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:13:46,788 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:13:46,788 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:13:46,788 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:13:46,788 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:13:46,788 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:13:46,788 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:13:46,790 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:13:46,790 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:13:47,437 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:47,452 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:47,453 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:13:47,466 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:13:47,471 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:13:47,473 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:13:47,476 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:13:47,479 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:13:47,482 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:13:47,484 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:13:47,487 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:13:47,490 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:13:47,493 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:13:47,496 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:13:47,499 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:13:47,501 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:13:47,504 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:13:47,510 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:13:47,515 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:47,515 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:47,519 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:13:47,519 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:13:47,523 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:47,523 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:47,528 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:47,528 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:13:47,533 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:47,533 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:13:47,538 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:13:47,538 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:13:47,543 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:13:47,543 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:13:47,543 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:13:47,547 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:13:47,547 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:13:47,547 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:13:47,551 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:13:47,556 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:13:47,556 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:13:47,556 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:13:47,556 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:13:47,556 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:13:47,560 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:13:47,564 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:13:47,564 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:13:47,565 - DEBUG - üîç Relationship Details:
2025-11-09 00:13:47,565 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:47,565 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:13:47,565 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:47,565 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:13:47,565 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:13:47,565 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:13:47,565 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:13:47,565 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:13:47,565 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:13:47,565 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:13:47,565 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:13:47,565 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:13:47,566 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:13:47,566 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:13:48,482 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:13:48,483 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:13:48,483 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:13:48,648 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:13:48,882 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:48,897 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:48,897 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:48,913 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:48,927 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:48,936 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:13:48,955 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:13:48,960 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:13:48,963 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:13:48,966 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:13:48,968 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:13:48,971 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:13:48,974 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:13:48,976 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:13:48,979 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:13:48,982 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:13:48,985 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:13:48,988 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:13:48,990 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:13:48,993 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:13:48,998 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:13:49,002 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:49,003 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:49,007 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:13:49,007 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:13:49,011 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:49,011 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:49,015 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:49,015 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:13:49,019 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:49,019 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:13:49,023 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:13:49,023 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:13:49,027 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:13:49,027 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:13:49,028 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:13:49,032 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:13:49,032 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:13:49,032 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:13:49,036 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:13:49,040 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:13:49,040 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:13:49,040 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:13:49,040 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:13:49,040 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:13:49,044 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:13:49,049 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:13:49,049 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:13:49,049 - DEBUG - üîç Relationship Details:
2025-11-09 00:13:49,049 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,049 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:13:49,049 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,049 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,049 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,049 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:13:49,049 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,049 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:13:49,049 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,049 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:13:49,050 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:13:49,050 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:13:49,050 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:13:49,050 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:13:49,051 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:13:49,051 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:13:49,707 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:49,723 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:49,724 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:13:49,736 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:13:49,741 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:13:49,744 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:13:49,747 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:13:49,749 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:13:49,752 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:13:49,754 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:13:49,757 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:13:49,760 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:13:49,763 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:13:49,765 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:13:49,769 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:13:49,771 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:13:49,774 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:13:49,779 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:13:49,783 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:49,783 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:49,788 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:13:49,788 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:13:49,792 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:49,792 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:49,796 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:49,797 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:13:49,801 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:49,801 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:13:49,806 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:13:49,806 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:13:49,810 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:13:49,810 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:13:49,810 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:13:49,814 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:13:49,814 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:13:49,814 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:13:49,818 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:13:49,823 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:13:49,823 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:13:49,823 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:13:49,823 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:13:49,823 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:13:49,827 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:13:49,831 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:13:49,831 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:13:49,831 - DEBUG - üîç Relationship Details:
2025-11-09 00:13:49,831 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,831 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:13:49,831 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,831 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,832 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,832 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:13:49,832 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,832 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:13:49,832 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:13:49,832 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:13:49,832 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:13:49,832 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:13:49,832 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:13:49,832 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:13:56,593 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:13:56,593 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:13:56,593 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:13:56,758 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:13:56,991 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:57,007 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:57,007 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:57,023 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:57,037 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:57,046 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:13:57,065 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:13:57,071 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:13:57,074 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:13:57,077 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:13:57,079 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:13:57,082 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:13:57,084 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:13:57,087 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:13:57,090 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:13:57,093 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:13:57,096 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:13:57,099 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:13:57,101 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:13:57,104 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:13:57,110 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:13:57,114 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:57,115 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:57,118 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:13:57,119 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:13:57,122 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:57,123 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:57,127 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:57,127 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:13:57,131 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:57,131 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:13:57,135 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:13:57,135 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:13:57,139 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:13:57,139 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:13:57,139 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:13:57,144 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:13:57,144 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:13:57,144 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:13:57,149 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:13:57,153 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:13:57,153 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:13:57,153 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:13:57,153 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:13:57,153 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:13:57,158 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:13:57,162 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:13:57,162 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:13:57,162 - DEBUG - üîç Relationship Details:
2025-11-09 00:13:57,162 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,162 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:13:57,162 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,162 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,162 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,162 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:13:57,162 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,162 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:13:57,162 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,162 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:13:57,162 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:13:57,162 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:13:57,162 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:13:57,162 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:13:57,163 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:13:57,164 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:13:57,826 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:13:57,841 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:13:57,842 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:13:57,855 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:13:57,860 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:13:57,862 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:13:57,865 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:13:57,868 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:13:57,870 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:13:57,873 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:13:57,876 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:13:57,879 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:13:57,881 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:13:57,884 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:13:57,887 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:13:57,889 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:13:57,892 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:13:57,897 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:13:57,901 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:57,901 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:57,906 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:13:57,906 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:13:57,911 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:57,911 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:13:57,915 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:57,915 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:13:57,920 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:13:57,920 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:13:57,925 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:13:57,925 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:13:57,929 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:13:57,929 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:13:57,929 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:13:57,933 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:13:57,933 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:13:57,933 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:13:57,937 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:13:57,941 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:13:57,941 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:13:57,941 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:13:57,942 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:13:57,942 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:13:57,946 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:13:57,950 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:13:57,950 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:13:57,950 - DEBUG - üîç Relationship Details:
2025-11-09 00:13:57,950 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,950 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:13:57,950 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,950 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,950 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,950 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:13:57,950 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,950 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:13:57,950 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:13:57,950 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:13:57,950 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:13:57,950 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:13:57,950 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:13:57,950 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:14:05,886 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:14:05,886 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:14:05,886 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:14:06,050 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:14:06,278 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:06,294 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:14:06,294 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:06,309 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:06,325 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:14:06,334 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:14:06,354 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:14:06,359 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:14:06,362 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:14:06,365 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:14:06,367 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:14:06,370 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:14:06,372 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:14:06,375 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:14:06,377 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:14:06,380 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:14:06,383 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:14:06,386 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:14:06,388 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:14:06,391 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:14:06,397 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:14:06,401 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:06,401 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:14:06,405 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:14:06,405 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:14:06,409 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:06,409 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:14:06,413 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:06,413 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:14:06,417 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:06,417 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:14:06,422 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:14:06,422 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:14:06,426 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:14:06,426 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:14:06,426 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:14:06,430 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:14:06,430 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:14:06,430 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:14:06,434 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:14:06,439 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:14:06,439 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:14:06,439 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:14:06,439 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:14:06,439 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:14:06,443 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:14:06,448 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:14:06,448 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:14:06,448 - DEBUG - üîç Relationship Details:
2025-11-09 00:14:06,448 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:14:06,448 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:14:06,448 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:14:06,448 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:14:06,448 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:14:06,448 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:14:06,448 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:14:06,448 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:14:06,448 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:14:06,448 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:14:06,448 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:14:06,448 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:14:06,448 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:14:06,448 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:14:06,449 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:14:06,449 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:14:09,268 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:14:09,268 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:14:09,269 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:14:09,433 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:14:09,663 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:09,679 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:14:09,679 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:09,694 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:09,709 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:14:09,718 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:14:09,737 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:14:09,743 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:14:09,745 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:14:09,748 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:14:09,751 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:14:09,753 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:14:09,756 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:14:09,758 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:14:09,761 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:14:09,764 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:14:09,767 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:14:09,770 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:14:09,772 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:14:09,775 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:14:09,780 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:14:09,785 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:09,785 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:14:09,789 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:14:09,789 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:14:09,793 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:09,793 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:14:09,797 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:09,797 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:14:09,801 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:09,801 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:14:09,806 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:14:09,806 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:14:09,810 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:14:09,810 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:14:09,810 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:14:09,814 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:14:09,814 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:14:09,814 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:14:09,819 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:14:09,823 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:14:09,823 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:14:09,823 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:14:09,823 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:14:09,823 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:14:09,827 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:14:09,831 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:14:09,831 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:14:09,831 - DEBUG - üîç Relationship Details:
2025-11-09 00:14:09,832 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:14:09,832 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:14:09,832 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:14:09,832 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:14:09,832 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:14:09,832 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:14:09,832 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:14:09,832 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:14:09,832 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:14:09,832 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:14:09,832 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:14:09,832 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:14:09,832 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:14:09,832 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:14:09,834 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:14:09,834 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:14:16,724 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:14:16,724 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:14:16,724 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:14:16,891 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:14:17,121 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:17,137 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:14:17,137 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:17,153 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:17,168 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:14:17,177 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:14:17,196 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:14:17,201 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:14:17,204 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:14:17,207 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:14:17,209 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:14:17,212 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:14:17,215 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:14:17,217 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:14:17,220 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:14:17,223 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:14:17,225 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:14:17,228 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:14:17,231 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:14:17,234 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:14:17,240 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:14:17,244 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:17,244 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:14:17,248 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:14:17,248 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:14:17,252 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:17,252 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:14:17,257 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:17,257 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:14:17,261 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:17,261 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:14:17,265 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:14:17,265 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:14:17,269 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:14:17,269 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:14:17,269 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:14:17,274 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:14:17,274 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:14:17,274 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:14:17,278 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:14:17,282 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:14:17,282 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:14:17,282 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:14:17,282 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:14:17,283 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:14:17,287 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:14:17,291 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:14:17,291 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:14:17,291 - DEBUG - üîç Relationship Details:
2025-11-09 00:14:17,291 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:14:17,291 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:14:17,291 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:14:17,292 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:14:17,292 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:14:17,292 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:14:17,292 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:14:17,292 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:14:17,292 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:14:17,292 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:14:17,292 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:14:17,292 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:14:17,292 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:14:17,292 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:14:17,294 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:14:17,294 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:14:46,174 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:14:46,174 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:14:46,174 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:14:46,343 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:14:46,597 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:46,613 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:14:46,613 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:46,629 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:14:46,644 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:14:46,653 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:14:46,673 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:14:46,679 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:14:46,681 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:14:46,684 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:14:46,687 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:14:46,689 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:14:46,692 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:14:46,695 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:14:46,698 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:14:46,701 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:14:46,704 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:14:46,708 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:14:46,711 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:14:46,715 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:14:46,721 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:14:46,727 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:46,727 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:14:46,733 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:14:46,733 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:14:46,739 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:46,739 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:14:46,745 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:46,745 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:14:46,751 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:14:46,751 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:14:46,757 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:14:46,758 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:14:46,763 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:14:46,763 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:14:46,764 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:14:46,769 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:14:46,769 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:14:46,769 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:14:46,773 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:14:46,778 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:14:46,778 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:14:46,778 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:14:46,778 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:14:46,778 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:14:46,783 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:14:46,787 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:14:46,787 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:14:46,787 - DEBUG - üîç Relationship Details:
2025-11-09 00:14:46,787 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:14:46,787 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:14:46,787 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:14:46,788 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:14:46,788 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:14:46,788 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:14:46,788 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:14:46,788 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:14:46,788 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:14:46,788 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:14:46,788 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:14:46,788 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:14:46,788 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:14:46,788 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:14:46,790 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:14:46,790 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:20:10,934 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:20:10,934 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:20:10,934 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:20:11,106 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:20:11,338 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:20:11,354 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:20:11,354 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:20:11,370 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:20:11,385 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:20:11,394 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:20:11,414 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:20:11,419 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:20:11,422 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:20:11,425 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:20:11,427 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:20:11,430 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:20:11,433 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:20:11,435 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:20:11,438 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:20:11,441 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:20:11,444 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:20:11,447 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:20:11,449 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:20:11,452 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:20:11,458 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:20:11,463 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:11,463 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:20:11,468 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:20:11,468 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:20:11,472 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:11,472 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:20:11,476 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:11,476 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:20:11,480 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:11,481 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:20:11,484 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:20:11,484 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:20:11,489 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:20:11,489 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:20:11,489 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:20:11,493 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:20:11,494 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:20:11,494 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:20:11,499 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:20:11,504 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:20:11,504 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:20:11,504 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:20:11,505 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:20:11,505 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:20:11,509 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:20:11,513 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:20:11,514 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:20:11,514 - DEBUG - üîç Relationship Details:
2025-11-09 00:20:11,514 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:20:11,514 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:20:11,514 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:20:11,514 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:20:11,514 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:20:11,514 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:20:11,514 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:20:11,514 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:20:11,514 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:20:11,514 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:20:11,514 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:20:11,514 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:20:11,515 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:20:11,515 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:20:11,516 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:20:11,516 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:20:13,252 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:20:13,252 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:20:13,252 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:20:13,421 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:20:13,652 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:20:13,668 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:20:13,668 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:20:13,683 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:20:13,698 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:20:13,707 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:20:13,727 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:20:13,733 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:20:13,736 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:20:13,738 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:20:13,741 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:20:13,743 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:20:13,746 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:20:13,748 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:20:13,751 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:20:13,754 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:20:13,756 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:20:13,760 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:20:13,762 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:20:13,765 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:20:13,770 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:20:13,774 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:13,774 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:20:13,778 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:20:13,779 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:20:13,782 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:13,783 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:20:13,787 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:13,787 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:20:13,791 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:13,791 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:20:13,795 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:20:13,795 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:20:13,799 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:20:13,799 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:20:13,799 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:20:13,803 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:20:13,803 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:20:13,804 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:20:13,808 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:20:13,812 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:20:13,812 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:20:13,812 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:20:13,812 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:20:13,812 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:20:13,817 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:20:13,821 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:20:13,821 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:20:13,821 - DEBUG - üîç Relationship Details:
2025-11-09 00:20:13,821 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:20:13,821 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:20:13,821 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:20:13,821 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:20:13,822 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:20:13,822 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:20:13,822 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:20:13,822 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:20:13,822 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:20:13,822 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:20:13,822 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:20:13,822 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:20:13,822 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:20:13,822 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:20:13,823 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:20:13,823 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:20:14,769 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:20:14,785 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:20:14,785 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:20:14,798 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:20:14,802 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:20:14,805 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:20:14,807 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:20:14,810 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:20:14,812 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:20:14,815 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:20:14,817 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:20:14,820 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:20:14,823 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:20:14,826 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:20:14,828 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:20:14,831 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:20:14,834 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:20:14,839 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:20:14,843 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:14,843 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:20:14,847 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:20:14,847 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:20:14,851 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:14,851 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:20:14,855 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:14,855 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:20:14,860 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:20:14,860 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:20:14,864 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:20:14,864 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:20:14,868 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:20:14,868 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:20:14,868 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:20:14,872 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:20:14,872 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:20:14,872 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:20:14,877 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:20:14,881 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:20:14,881 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:20:14,881 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:20:14,881 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:20:14,881 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:20:14,885 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:20:14,889 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:20:14,889 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:20:14,889 - DEBUG - üîç Relationship Details:
2025-11-09 00:20:14,889 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:20:14,889 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:20:14,890 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:20:14,890 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:20:14,890 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:20:14,890 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:20:14,890 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:20:14,890 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:20:14,890 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:20:14,890 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:20:14,890 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:20:14,890 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:20:14,890 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:20:14,890 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:36:25,961 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:36:25,962 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:36:25,962 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:36:26,135 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:36:26,381 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:26,397 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:26,397 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:26,413 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:26,429 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:26,438 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:36:26,552 - ERROR - ‚ùå Initialization failed: This Connection is closed
2025-11-09 00:36:26,552 - ERROR - ‚ùå Error type: ResourceClosedError
2025-11-09 00:36:26,818 - ERROR - ‚ùå Full traceback: Traceback (most recent call last):
  File "/home/user/IITB/netra/backend/api/db/schemaAwareSQL.py", line 37, in initialize
    full_schema, relationships = get_schema_information(engine)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/backend/api/db/schemaAwareSQL.py", line 90, in get_schema_information
    inspector = inspect(engine)
                ^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/inspection.py", line 140, in inspect
    ret = reg(subject)
          ^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 313, in _engine_insp
    return Inspector._construct(Inspector._init_engine, bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 246, in _construct
    init(self, bind)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/reflection.py", line 257, in _init_engine
    engine.connect().close()
    ^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3273, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3297, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 915, in __connect
    )._exec_w_sync_on_first_run(self.dbapi_connection, self)
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/event/attr.py", line 483, in _exec_w_sync_on_first_run
    self(*args, **kw)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/event/attr.py", line 497, in __call__
    fn(*args, **kw)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 1997, in go
    return once_fn(*arg, **kw)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 752, in first_connect
    dialect.initialize(c)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/mssql/base.py", line 3250, in initialize
    self._setup_supports_comments(connection)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/mssql/base.py", line 3289, in _setup_supports_comments
    connection.scalar(
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1304, in scalar
    return meth(
           ^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 541, in _execute_on_scalar
    return self._execute_on_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1809, in _execute_context
    conn = self._revalidate_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 678, in _revalidate_connection
    raise exc.ResourceClosedError("This Connection is closed")
sqlalchemy.exc.ResourceClosedError: This Connection is closed

2025-11-09 00:36:28,018 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:36:28,018 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:36:28,018 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:36:28,200 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:36:28,459 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:28,474 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:28,474 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:28,490 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:28,506 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:28,515 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:36:28,534 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:36:28,540 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:36:28,543 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:36:28,545 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:36:28,548 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:36:28,551 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:36:28,553 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:36:28,556 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:36:28,559 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:36:28,562 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:36:28,564 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:36:28,567 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:36:28,570 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:36:28,572 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:36:28,578 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:36:28,582 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:28,582 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:28,586 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:36:28,586 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:36:28,590 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:28,590 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:28,594 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:28,594 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:36:28,598 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:28,598 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:36:28,602 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:36:28,602 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:36:28,606 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:36:28,606 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:36:28,606 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:36:28,611 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:36:28,611 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:36:28,611 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:36:28,617 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:36:28,621 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:36:28,621 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:36:28,621 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:36:28,621 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:36:28,621 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:36:28,625 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:36:28,629 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:36:28,629 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:36:28,629 - DEBUG - üîç Relationship Details:
2025-11-09 00:36:28,629 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:28,629 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:36:28,629 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:28,630 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:36:28,630 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:36:28,630 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:36:28,630 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:36:28,630 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:36:28,630 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:36:28,630 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:36:28,630 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:36:28,630 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:36:28,630 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:36:28,630 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:36:28,631 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:36:28,631 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:36:29,336 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:29,352 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:29,352 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:36:29,365 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:36:29,370 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:36:29,372 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:36:29,375 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:36:29,378 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:36:29,380 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:36:29,383 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:36:29,386 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:36:29,389 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:36:29,391 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:36:29,394 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:36:29,397 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:36:29,399 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:36:29,402 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:36:29,407 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:36:29,411 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:29,411 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:29,416 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:36:29,416 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:36:29,420 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:29,420 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:29,424 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:29,424 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:36:29,428 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:29,429 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:36:29,433 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:36:29,433 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:36:29,437 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:36:29,437 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:36:29,437 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:36:29,441 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:36:29,441 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:36:29,441 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:36:29,445 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:36:29,450 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:36:29,450 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:36:29,450 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:36:29,450 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:36:29,450 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:36:29,454 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:36:29,458 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:36:29,458 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:36:29,458 - DEBUG - üîç Relationship Details:
2025-11-09 00:36:29,458 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:29,458 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:36:29,458 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:29,458 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:36:29,458 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:36:29,458 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:36:29,458 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:36:29,458 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:36:29,459 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:36:29,459 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:36:29,459 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:36:29,459 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:36:29,459 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:36:29,459 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:36:30,440 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:36:30,440 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:36:30,440 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:36:30,609 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:36:30,856 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:30,871 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:30,872 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:30,887 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:30,903 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:30,911 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:36:30,931 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:36:30,939 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:36:30,941 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:36:30,944 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:36:30,947 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:36:30,949 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:36:30,952 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:36:30,955 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:36:30,958 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:36:30,960 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:36:30,963 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:36:30,966 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:36:30,969 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:36:30,972 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:36:30,977 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:36:30,981 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:30,981 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:30,985 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:36:30,985 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:36:30,989 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:30,990 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:30,994 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:30,994 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:36:30,997 - ERROR - ‚ùå Error getting foreign keys for table monthly_utilization: (pyodbc.OperationalError) ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Error code 0x2714 (10004) (SQLExecDirectW)')
[SQL: WITH fk_info AS (
    SELECT
        ischema_ref_con.constraint_schema,
        ischema_ref_con.constraint_name,
        ischema_key_col.ordinal_position,
        ischema_key_col.table_schema,
        ischema_key_col.table_name,
        ischema_ref_con.unique_constraint_schema,
        ischema_ref_con.unique_constraint_name,
        ischema_ref_con.match_option,
        ischema_ref_con.update_rule,
        ischema_ref_con.delete_rule,
        ischema_key_col.column_name AS constrained_column
    FROM
        INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS ischema_ref_con
        INNER JOIN
        INFORMATION_SCHEMA.KEY_COLUMN_USAGE ischema_key_col ON
            ischema_key_col.table_schema = ischema_ref_con.constraint_schema
            AND ischema_key_col.constraint_name =
            ischema_ref_con.constraint_name
    WHERE ischema_key_col.table_name = CAST(? AS NVARCHAR(max))
        AND ischema_key_col.table_schema = CAST(? AS NVARCHAR(max))
),
constraint_info AS (
    SELECT
        ischema_key_col.constraint_schema,
        ischema_key_col.constraint_name,
        ischema_key_col.ordinal_position,
        ischema_key_col.table_schema,
        ischema_key_col.table_name,
        ischema_key_col.column_name
    FROM
        INFORMATION_SCHEMA.KEY_COLUMN_USAGE ischema_key_col
),
index_info AS (
    SELECT
        sys.schemas.name AS index_schema,
        sys.indexes.name AS index_name,
        sys.index_columns.key_ordinal AS ordinal_position,
        sys.schemas.name AS table_schema,
        sys.objects.name AS table_name,
        sys.columns.name AS column_name
    FROM
        sys.indexes
        INNER JOIN
        sys.objects ON
            sys.objects.object_id = sys.indexes.object_id
        INNER JOIN
        sys.schemas ON
            sys.schemas.schema_id = sys.objects.schema_id
        INNER JOIN
        sys.index_columns ON
            sys.index_columns.object_id = sys.objects.object_id
            AND sys.index_columns.index_id = sys.indexes.index_id
        INNER JOIN
        sys.columns ON
            sys.columns.object_id = sys.indexes.object_id
            AND sys.columns.column_id = sys.index_columns.column_id
)
    SELECT
        fk_info.constraint_schema,
        fk_info.constraint_name,
        fk_info.ordinal_position,
        fk_info.constrained_column,
        constraint_info.table_schema AS referred_table_schema,
        constraint_info.table_name AS referred_table_name,
        constraint_info.column_name AS referred_column,
        fk_info.match_option,
        fk_info.update_rule,
        fk_info.delete_rule
    FROM
        fk_info INNER JOIN constraint_info ON
            constraint_info.constraint_schema =
                fk_info.unique_constraint_schema
            AND constraint_info.constraint_name =
                fk_info.unique_constraint_name
            AND constraint_info.ordinal_position = fk_info.ordinal_position
    UNION
    SELECT
        fk_info.constraint_schema,
        fk_info.constraint_name,
        fk_info.ordinal_position,
        fk_info.constrained_column,
        index_info.table_schema AS referred_table_schema,
        index_info.table_name AS referred_table_name,
        index_info.column_name AS referred_column,
        fk_info.match_option,
        fk_info.update_rule,
        fk_info.delete_rule
    FROM
        fk_info INNER JOIN index_info ON
            index_info.index_schema = fk_info.unique_constraint_schema
            AND index_info.index_name = fk_info.unique_constraint_name
            AND index_info.ordinal_position = fk_info.ordinal_position

    ORDER BY fk_info.constraint_schema, fk_info.constraint_name,
        fk_info.ordinal_position
]
[parameters: ('monthly_utilization', 'dbo')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-11-09 00:36:31,007 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:36:31,007 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:36:31,011 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:36:31,011 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:36:31,011 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:36:31,015 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:36:31,015 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:36:31,015 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:36:31,020 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:36:31,025 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:36:31,025 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:36:31,025 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:36:31,025 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:36:31,025 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:36:31,029 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:36:31,033 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:36:31,033 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 13 relationships
2025-11-09 00:36:31,033 - DEBUG - üîç Relationship Details:
2025-11-09 00:36:31,033 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,034 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:36:31,034 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,034 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,034 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:36:31,034 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,034 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:36:31,034 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,034 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:36:31,034 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:36:31,034 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:36:31,034 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:36:31,034 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:36:31,034 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:36:31,034 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:36:31,732 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:31,748 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:31,749 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:36:31,761 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:36:31,766 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:36:31,768 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:36:31,771 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:36:31,774 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:36:31,776 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:36:31,779 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:36:31,783 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:36:31,786 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:36:31,790 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:36:31,793 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:36:31,796 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:36:31,799 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:36:31,801 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:36:31,806 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:36:31,810 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:31,811 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:31,815 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:36:31,815 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:36:31,819 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:31,819 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:31,823 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:31,823 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:36:31,828 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:31,828 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:36:31,832 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:36:31,832 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:36:31,836 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:36:31,836 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:36:31,836 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:36:31,840 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:36:31,840 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:36:31,840 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:36:31,844 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:36:31,848 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:36:31,849 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:36:31,849 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:36:31,849 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:36:31,849 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:36:31,853 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:36:31,857 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:36:31,857 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:36:31,857 - DEBUG - üîç Relationship Details:
2025-11-09 00:36:31,858 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,858 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:36:31,858 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,858 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,858 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,858 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:36:31,858 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,858 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:36:31,858 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:36:31,858 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:36:31,858 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:36:31,858 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:36:31,858 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:36:31,858 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:36:32,802 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:36:32,802 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:36:32,802 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:36:32,970 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:36:33,205 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:33,221 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:33,221 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:33,237 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:33,252 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:33,261 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:36:33,281 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:36:33,287 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:36:33,289 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:36:33,292 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:36:33,294 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:36:33,297 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:36:33,300 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:36:33,302 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:36:33,305 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:36:33,307 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:36:33,310 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:36:33,313 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:36:33,315 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:36:33,318 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:36:33,324 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:36:33,328 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:33,328 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:33,331 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:36:33,332 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:36:33,335 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:33,335 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:33,339 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:33,339 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:36:33,343 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:33,343 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:36:33,347 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:36:33,347 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:36:33,351 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:36:33,351 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:36:33,351 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:36:33,355 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:36:33,355 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:36:33,356 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:36:33,359 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:36:33,364 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:36:33,364 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:36:33,364 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:36:33,364 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:36:33,364 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:36:33,368 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:36:33,372 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:36:33,372 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:36:33,372 - DEBUG - üîç Relationship Details:
2025-11-09 00:36:33,373 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:33,373 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:36:33,373 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:33,373 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:36:33,373 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:36:33,373 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:36:33,373 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:36:33,373 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:36:33,373 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:36:33,373 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:36:33,373 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:36:33,373 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:36:33,373 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:36:33,373 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:36:33,374 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:36:33,374 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:36:34,041 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:36:34,056 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:36:34,057 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:36:34,070 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:36:34,074 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:36:34,077 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:36:34,079 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:36:34,082 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:36:34,084 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:36:34,087 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:36:34,090 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:36:34,092 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:36:34,095 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:36:34,098 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:36:34,101 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:36:34,103 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:36:34,106 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:36:34,112 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:36:34,116 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:34,116 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:34,121 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:36:34,121 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:36:34,125 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:34,125 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:36:34,129 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:34,129 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:36:34,133 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:36:34,133 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:36:34,137 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:36:34,137 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:36:34,141 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:36:34,141 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:36:34,141 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:36:34,145 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:36:34,145 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:36:34,145 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:36:34,149 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:36:34,154 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:36:34,154 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:36:34,154 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:36:34,154 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:36:34,154 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:36:34,160 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:36:34,164 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:36:34,164 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:36:34,164 - DEBUG - üîç Relationship Details:
2025-11-09 00:36:34,164 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:34,164 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:36:34,164 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:36:34,164 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:36:34,164 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:36:34,164 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:36:34,164 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:36:34,164 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:36:34,164 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:36:34,164 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:36:34,164 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:36:34,164 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:36:34,165 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:36:34,165 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:44:49,367 - INFO - Database engine created with pool_size=10
2025-11-09 00:44:50,660 - ERROR - Database session error in FastAPI dependency: 4 validation errors:
  {'type': 'get_attribute_error', 'loc': ('response', 'name'), 'msg': 'Error extracting attribute: DetachedInstanceError: Instance <FailureMode at 0x74146d98e170> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)', 'input': FailureMode(), 'ctx': {'error': 'DetachedInstanceError: Instance <FailureMode at 0x74146d98e170> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)'}}
  {'type': 'get_attribute_error', 'loc': ('response', 'severity'), 'msg': 'Error extracting attribute: DetachedInstanceError: Instance <FailureMode at 0x74146d98e170> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)', 'input': FailureMode(), 'ctx': {'error': 'DetachedInstanceError: Instance <FailureMode at 0x74146d98e170> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)'}}
  {'type': 'get_attribute_error', 'loc': ('response', 'component_id'), 'msg': 'Error extracting attribute: DetachedInstanceError: Instance <FailureMode at 0x74146d98e170> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)', 'input': FailureMode(), 'ctx': {'error': 'DetachedInstanceError: Instance <FailureMode at 0x74146d98e170> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)'}}
  {'type': 'get_attribute_error', 'loc': ('response', 'failure_mode_id'), 'msg': 'Error extracting attribute: DetachedInstanceError: Instance <FailureMode at 0x74146d98e170> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)', 'input': FailureMode(), 'ctx': {'error': 'DetachedInstanceError: Instance <FailureMode at 0x74146d98e170> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)'}}

2025-11-09 00:46:12,818 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:46:12,818 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:46:12,818 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:46:13,016 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:46:13,254 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:46:13,270 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:46:13,270 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:46:13,285 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:46:13,300 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:46:13,309 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:46:13,329 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:46:13,334 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:46:13,337 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:46:13,340 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:46:13,342 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:46:13,345 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:46:13,348 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:46:13,350 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:46:13,353 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:46:13,356 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:46:13,358 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:46:13,361 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:46:13,364 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:46:13,366 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:46:13,372 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:46:13,376 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:46:13,376 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:46:13,381 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:46:13,381 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:46:13,385 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:46:13,385 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:46:13,389 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:46:13,389 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:46:13,393 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:46:13,393 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:46:13,397 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:46:13,397 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:46:13,401 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:46:13,401 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:46:13,401 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:46:13,405 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:46:13,406 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:46:13,406 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:46:13,410 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:46:13,414 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:46:13,414 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:46:13,414 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:46:13,414 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:46:13,414 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:46:13,419 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:46:13,423 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:46:13,423 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:46:13,423 - DEBUG - üîç Relationship Details:
2025-11-09 00:46:13,423 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:46:13,423 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:46:13,423 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:46:13,423 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:46:13,423 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:46:13,423 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:46:13,424 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:46:13,424 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:46:13,424 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:46:13,424 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:46:13,424 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:46:13,424 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:46:13,424 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:46:13,424 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:46:13,426 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:46:13,426 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:46:14,093 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:46:14,108 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:46:14,109 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:46:14,122 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:46:14,127 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:46:14,129 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:46:14,132 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:46:14,135 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:46:14,137 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:46:14,140 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:46:14,143 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:46:14,146 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:46:14,149 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:46:14,151 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:46:14,154 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:46:14,157 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:46:14,160 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:46:14,165 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:46:14,170 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:46:14,170 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:46:14,174 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:46:14,174 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:46:14,179 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:46:14,179 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:46:14,183 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:46:14,183 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:46:14,189 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:46:14,189 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:46:14,193 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:46:14,193 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:46:14,198 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:46:14,198 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:46:14,198 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:46:14,202 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:46:14,202 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:46:14,203 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:46:14,207 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:46:14,212 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:46:14,212 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:46:14,212 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:46:14,212 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:46:14,212 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:46:14,216 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:46:14,221 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:46:14,221 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:46:14,221 - DEBUG - üîç Relationship Details:
2025-11-09 00:46:14,222 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:46:14,222 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:46:14,222 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:46:14,222 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:46:14,222 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:46:14,222 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:46:14,222 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:46:14,222 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:46:14,222 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:46:14,222 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:46:14,222 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:46:14,222 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:46:14,222 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:46:14,223 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:47:00,756 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:47:00,756 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:47:00,756 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:47:00,924 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:47:09,057 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:47:09,057 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:47:09,057 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:47:09,229 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:47:09,501 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:47:09,517 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:47:09,517 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:47:09,534 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:47:09,550 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:47:09,559 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:47:09,579 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:47:09,585 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:47:09,588 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:47:09,591 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:47:09,594 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:47:09,596 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:47:09,599 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:47:09,602 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:47:09,604 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:47:09,607 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:47:09,610 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:47:09,613 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:47:09,615 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:47:09,618 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:47:09,624 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:47:09,628 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:09,628 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:47:09,632 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:47:09,632 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:47:09,636 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:09,636 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:47:09,640 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:09,640 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:47:09,644 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:09,644 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:47:09,648 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:47:09,648 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:47:09,653 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:47:09,653 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:47:09,653 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:47:09,658 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:47:09,658 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:47:09,658 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:47:09,662 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:47:09,666 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:47:09,666 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:47:09,666 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:47:09,666 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:47:09,666 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:47:09,671 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:47:09,675 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:47:09,675 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:47:09,675 - DEBUG - üîç Relationship Details:
2025-11-09 00:47:09,675 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:47:09,675 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:47:09,675 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:47:09,675 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:47:09,675 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:47:09,675 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:47:09,675 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:47:09,675 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:47:09,675 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:47:09,675 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:47:09,675 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:47:09,675 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:47:09,675 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:47:09,676 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:47:09,677 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:47:09,677 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:47:10,361 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:47:10,377 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:47:10,378 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:47:10,391 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:47:10,396 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:47:10,398 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:47:10,401 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:47:10,404 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:47:10,407 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:47:10,409 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:47:10,412 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:47:10,416 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:47:10,418 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:47:10,421 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:47:10,424 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:47:10,427 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:47:10,429 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:47:10,435 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:47:10,440 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:10,440 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:47:10,444 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:47:10,444 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:47:10,448 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:10,448 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:47:10,452 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:10,452 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:47:10,456 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:10,456 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:47:10,460 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:47:10,460 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:47:10,464 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:47:10,465 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:47:10,465 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:47:10,469 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:47:10,469 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:47:10,469 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:47:10,473 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:47:10,478 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:47:10,478 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:47:10,478 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:47:10,478 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:47:10,478 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:47:10,482 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:47:10,487 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:47:10,487 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:47:10,487 - DEBUG - üîç Relationship Details:
2025-11-09 00:47:10,487 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:47:10,487 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:47:10,487 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:47:10,487 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:47:10,487 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:47:10,487 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:47:10,487 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:47:10,487 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:47:10,487 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:47:10,487 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:47:10,487 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:47:10,487 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:47:10,487 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:47:10,488 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:47:16,534 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:47:16,534 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:47:16,534 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:47:16,703 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:47:16,954 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:47:16,970 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:47:16,970 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:47:16,986 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:47:17,002 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:47:17,011 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:47:17,035 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:47:17,041 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:47:17,044 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:47:17,048 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:47:17,051 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:47:17,054 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:47:17,057 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:47:17,060 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:47:17,064 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:47:17,067 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:47:17,071 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:47:17,074 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:47:17,077 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:47:17,081 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:47:17,088 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:47:17,094 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:17,094 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:47:17,100 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:47:17,100 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:47:17,105 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:17,105 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:47:17,109 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:17,109 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:47:17,114 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:17,114 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:47:17,118 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:47:17,118 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:47:17,123 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:47:17,123 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:47:17,123 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:47:17,127 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:47:17,127 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:47:17,127 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:47:17,132 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:47:17,137 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:47:17,137 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:47:17,137 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:47:17,137 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:47:17,137 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:47:17,141 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:47:17,145 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:47:17,146 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:47:17,146 - DEBUG - üîç Relationship Details:
2025-11-09 00:47:17,146 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,146 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:47:17,146 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,146 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,146 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,146 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:47:17,146 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,146 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:47:17,146 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,146 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:47:17,146 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:47:17,147 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:47:17,147 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:47:17,147 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:47:17,148 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:47:17,149 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:47:17,828 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:47:17,844 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:47:17,845 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:47:17,857 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:47:17,862 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:47:17,864 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:47:17,867 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:47:17,870 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:47:17,872 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:47:17,875 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:47:17,878 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:47:17,881 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:47:17,883 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:47:17,886 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:47:17,889 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:47:17,892 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:47:17,895 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:47:17,900 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:47:17,905 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:17,905 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:47:17,909 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:47:17,909 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:47:17,914 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:17,914 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:47:17,918 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:17,919 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:47:17,923 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:47:17,923 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:47:17,928 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:47:17,928 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:47:17,932 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:47:17,932 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:47:17,932 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:47:17,937 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:47:17,937 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:47:17,937 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:47:17,944 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:47:17,950 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:47:17,950 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:47:17,951 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:47:17,951 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:47:17,951 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:47:17,956 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:47:17,961 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:47:17,961 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:47:17,961 - DEBUG - üîç Relationship Details:
2025-11-09 00:47:17,961 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,961 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:47:17,961 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,961 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,961 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,961 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:47:17,962 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,962 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:47:17,962 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:47:17,962 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:47:17,962 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:47:17,962 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:47:17,962 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:47:17,962 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:47:29,429 - INFO - Database engine created with pool_size=10
2025-11-09 00:47:29,461 - ERROR - Database session error: Failure mode with name 'Physical Weardown' already exists for this component
2025-11-09 00:47:29,461 - ERROR - Database session error in FastAPI dependency: Failure mode with name 'Physical Weardown' already exists for this component
2025-11-09 00:48:52,996 - ERROR - Database session error in FastAPI dependency: 4 validation errors:
  {'type': 'get_attribute_error', 'loc': ('response', 'failure_mode_id'), 'msg': 'Error extracting attribute: DetachedInstanceError: Instance <FailureMode at 0x733d396e5db0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)', 'input': FailureMode(), 'ctx': {'error': 'DetachedInstanceError: Instance <FailureMode at 0x733d396e5db0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)'}}
  {'type': 'get_attribute_error', 'loc': ('response', 'name'), 'msg': 'Error extracting attribute: DetachedInstanceError: Instance <FailureMode at 0x733d396e5db0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)', 'input': FailureMode(), 'ctx': {'error': 'DetachedInstanceError: Instance <FailureMode at 0x733d396e5db0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)'}}
  {'type': 'get_attribute_error', 'loc': ('response', 'severity'), 'msg': 'Error extracting attribute: DetachedInstanceError: Instance <FailureMode at 0x733d396e5db0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)', 'input': FailureMode(), 'ctx': {'error': 'DetachedInstanceError: Instance <FailureMode at 0x733d396e5db0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)'}}
  {'type': 'get_attribute_error', 'loc': ('response', 'component_id'), 'msg': 'Error extracting attribute: DetachedInstanceError: Instance <FailureMode at 0x733d396e5db0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)', 'input': FailureMode(), 'ctx': {'error': 'DetachedInstanceError: Instance <FailureMode at 0x733d396e5db0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)'}}

2025-11-09 00:50:55,356 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:50:55,356 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:50:55,356 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:50:55,541 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:50:55,798 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:50:55,814 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:50:55,814 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:50:55,830 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:50:55,845 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:50:55,854 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:50:55,874 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:50:55,880 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:50:55,882 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:50:55,885 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:50:55,888 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:50:55,890 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:50:55,893 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:50:55,895 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:50:55,898 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:50:55,901 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:50:55,903 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:50:55,906 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:50:55,908 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:50:55,911 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:50:55,916 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:50:55,920 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:50:55,920 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:50:55,924 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:50:55,924 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:50:55,928 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:50:55,928 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:50:55,930 - ERROR - ‚ùå Error getting foreign keys for table failure_modes: (pyodbc.OperationalError) ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Error code 0x2714 (10004) (SQLExecDirectW)')
[SQL: WITH fk_info AS (
    SELECT
        ischema_ref_con.constraint_schema,
        ischema_ref_con.constraint_name,
        ischema_key_col.ordinal_position,
        ischema_key_col.table_schema,
        ischema_key_col.table_name,
        ischema_ref_con.unique_constraint_schema,
        ischema_ref_con.unique_constraint_name,
        ischema_ref_con.match_option,
        ischema_ref_con.update_rule,
        ischema_ref_con.delete_rule,
        ischema_key_col.column_name AS constrained_column
    FROM
        INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS ischema_ref_con
        INNER JOIN
        INFORMATION_SCHEMA.KEY_COLUMN_USAGE ischema_key_col ON
            ischema_key_col.table_schema = ischema_ref_con.constraint_schema
            AND ischema_key_col.constraint_name =
            ischema_ref_con.constraint_name
    WHERE ischema_key_col.table_name = CAST(? AS NVARCHAR(max))
        AND ischema_key_col.table_schema = CAST(? AS NVARCHAR(max))
),
constraint_info AS (
    SELECT
        ischema_key_col.constraint_schema,
        ischema_key_col.constraint_name,
        ischema_key_col.ordinal_position,
        ischema_key_col.table_schema,
        ischema_key_col.table_name,
        ischema_key_col.column_name
    FROM
        INFORMATION_SCHEMA.KEY_COLUMN_USAGE ischema_key_col
),
index_info AS (
    SELECT
        sys.schemas.name AS index_schema,
        sys.indexes.name AS index_name,
        sys.index_columns.key_ordinal AS ordinal_position,
        sys.schemas.name AS table_schema,
        sys.objects.name AS table_name,
        sys.columns.name AS column_name
    FROM
        sys.indexes
        INNER JOIN
        sys.objects ON
            sys.objects.object_id = sys.indexes.object_id
        INNER JOIN
        sys.schemas ON
            sys.schemas.schema_id = sys.objects.schema_id
        INNER JOIN
        sys.index_columns ON
            sys.index_columns.object_id = sys.objects.object_id
            AND sys.index_columns.index_id = sys.indexes.index_id
        INNER JOIN
        sys.columns ON
            sys.columns.object_id = sys.indexes.object_id
            AND sys.columns.column_id = sys.index_columns.column_id
)
    SELECT
        fk_info.constraint_schema,
        fk_info.constraint_name,
        fk_info.ordinal_position,
        fk_info.constrained_column,
        constraint_info.table_schema AS referred_table_schema,
        constraint_info.table_name AS referred_table_name,
        constraint_info.column_name AS referred_column,
        fk_info.match_option,
        fk_info.update_rule,
        fk_info.delete_rule
    FROM
        fk_info INNER JOIN constraint_info ON
            constraint_info.constraint_schema =
                fk_info.unique_constraint_schema
            AND constraint_info.constraint_name =
                fk_info.unique_constraint_name
            AND constraint_info.ordinal_position = fk_info.ordinal_position
    UNION
    SELECT
        fk_info.constraint_schema,
        fk_info.constraint_name,
        fk_info.ordinal_position,
        fk_info.constrained_column,
        index_info.table_schema AS referred_table_schema,
        index_info.table_name AS referred_table_name,
        index_info.column_name AS referred_column,
        fk_info.match_option,
        fk_info.update_rule,
        fk_info.delete_rule
    FROM
        fk_info INNER JOIN index_info ON
            index_info.index_schema = fk_info.unique_constraint_schema
            AND index_info.index_name = fk_info.unique_constraint_name
            AND index_info.ordinal_position = fk_info.ordinal_position

    ORDER BY fk_info.constraint_schema, fk_info.constraint_name,
        fk_info.ordinal_position
]
[parameters: ('failure_modes', 'dbo')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-11-09 00:50:55,940 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:50:55,940 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:50:55,944 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:50:55,944 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:50:55,948 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:50:55,948 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:50:55,948 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:50:55,953 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:50:55,953 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:50:55,953 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:50:55,957 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:50:55,962 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:50:55,962 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:50:55,962 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:50:55,962 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:50:55,962 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:50:55,966 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:50:55,970 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:50:55,970 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 13 relationships
2025-11-09 00:50:55,970 - DEBUG - üîç Relationship Details:
2025-11-09 00:50:55,970 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:50:55,970 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:50:55,970 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:50:55,970 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:50:55,970 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:50:55,970 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:50:55,970 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:50:55,970 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:50:55,970 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:50:55,970 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:50:55,970 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:50:55,970 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:50:55,970 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:50:55,971 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:50:55,971 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:50:56,679 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:50:56,696 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:50:56,697 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:50:56,709 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:50:56,713 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:50:56,716 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:50:56,719 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:50:56,722 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:50:56,725 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:50:56,729 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:50:56,732 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:50:56,736 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:50:56,738 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:50:56,741 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:50:56,744 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:50:56,746 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:50:56,749 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:50:56,754 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:50:56,758 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:50:56,758 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:50:56,762 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:50:56,763 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:50:56,766 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:50:56,766 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:50:56,771 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:50:56,771 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:50:56,775 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:50:56,775 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:50:56,779 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:50:56,779 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:50:56,783 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:50:56,783 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:50:56,783 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:50:56,788 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:50:56,788 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:50:56,788 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:50:56,792 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:50:56,796 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:50:56,796 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:50:56,797 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:50:56,797 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:50:56,797 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:50:56,801 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:50:56,805 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:50:56,805 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:50:56,806 - DEBUG - üîç Relationship Details:
2025-11-09 00:50:56,806 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:50:56,806 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:50:56,806 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:50:56,806 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:50:56,806 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:50:56,806 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:50:56,806 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:50:56,806 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:50:56,806 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:50:56,806 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:50:56,806 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:50:56,806 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:50:56,806 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:50:56,807 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:50:57,728 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:50:57,728 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:50:57,728 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:50:57,894 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:51:06,871 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:51:06,872 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:51:06,872 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:51:07,040 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:51:13,472 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:51:13,472 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:51:13,472 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:51:13,643 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:51:13,882 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:51:13,898 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:51:13,898 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:51:13,913 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:51:13,928 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:51:13,937 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:51:13,957 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:51:13,962 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:51:13,965 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:51:13,968 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:51:13,971 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:51:13,973 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:51:13,976 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:51:13,979 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:51:13,981 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:51:13,984 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:51:13,987 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:51:13,990 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:51:13,992 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:51:13,995 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:51:14,001 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:51:14,005 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:14,005 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:51:14,009 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:51:14,009 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:51:14,013 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:14,013 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:51:14,018 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:14,018 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:51:14,022 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:14,022 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:51:14,026 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:51:14,026 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:51:14,030 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:51:14,030 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:51:14,030 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:51:14,034 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:51:14,034 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:51:14,034 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:51:14,039 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:51:14,043 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:51:14,043 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:51:14,043 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:51:14,043 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:51:14,043 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:51:14,047 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:51:14,051 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:51:14,051 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:51:14,051 - DEBUG - üîç Relationship Details:
2025-11-09 00:51:14,051 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,051 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:51:14,051 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,051 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,051 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,051 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:51:14,051 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,051 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:51:14,052 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,052 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:51:14,052 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:51:14,052 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:51:14,052 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:51:14,052 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:51:14,053 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:51:14,053 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:51:14,715 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:51:14,731 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:51:14,731 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:51:14,745 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:51:14,749 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:51:14,752 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:51:14,755 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:51:14,757 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:51:14,760 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:51:14,762 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:51:14,765 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:51:14,768 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:51:14,771 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:51:14,774 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:51:14,777 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:51:14,779 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:51:14,782 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:51:14,787 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:51:14,791 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:14,791 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:51:14,796 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:51:14,796 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:51:14,800 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:14,800 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:51:14,804 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:14,804 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:51:14,808 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:14,808 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:51:14,812 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:51:14,812 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:51:14,817 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:51:14,817 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:51:14,817 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:51:14,821 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:51:14,821 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:51:14,822 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:51:14,826 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:51:14,830 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:51:14,830 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:51:14,830 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:51:14,830 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:51:14,830 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:51:14,834 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:51:14,838 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:51:14,838 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:51:14,838 - DEBUG - üîç Relationship Details:
2025-11-09 00:51:14,838 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,838 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:51:14,838 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,839 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,839 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,839 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:51:14,839 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,839 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:51:14,839 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:51:14,839 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:51:14,839 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:51:14,839 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:51:14,839 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:51:14,839 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:51:20,482 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 00:51:20,482 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 00:51:20,482 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 00:51:20,650 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 00:51:20,886 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:51:20,901 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:51:20,902 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:51:20,918 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:51:20,933 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:51:20,942 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:51:20,961 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:51:20,967 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:51:20,970 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:51:20,972 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:51:20,975 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:51:20,977 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:51:20,980 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:51:20,982 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:51:20,986 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:51:20,988 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:51:20,991 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:51:20,994 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:51:20,996 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:51:20,999 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:51:21,004 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:51:21,008 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:21,008 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:51:21,012 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:51:21,012 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:51:21,016 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:21,016 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:51:21,020 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:21,020 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:51:21,024 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:21,024 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:51:21,028 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:51:21,028 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:51:21,032 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:51:21,032 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:51:21,033 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:51:21,037 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:51:21,037 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:51:21,037 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:51:21,041 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:51:21,045 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:51:21,045 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:51:21,045 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:51:21,045 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:51:21,045 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:51:21,049 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:51:21,054 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:51:21,054 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:51:21,054 - DEBUG - üîç Relationship Details:
2025-11-09 00:51:21,054 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,054 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:51:21,054 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,054 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,054 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,054 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:51:21,054 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,054 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:51:21,054 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,054 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:51:21,054 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:51:21,054 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:51:21,054 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:51:21,054 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:51:21,055 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 00:51:21,055 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 00:51:21,733 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 00:51:21,748 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 00:51:21,749 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 00:51:21,761 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 00:51:21,765 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 00:51:21,768 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 00:51:21,771 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 00:51:21,773 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 00:51:21,776 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 00:51:21,778 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 00:51:21,781 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 00:51:21,784 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 00:51:21,787 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 00:51:21,789 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 00:51:21,792 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 00:51:21,794 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 00:51:21,797 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 00:51:21,802 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 00:51:21,806 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:21,806 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 00:51:21,811 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 00:51:21,811 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 00:51:21,815 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:21,815 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 00:51:21,819 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:21,819 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 00:51:21,823 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 00:51:21,823 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 00:51:21,827 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 00:51:21,827 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 00:51:21,831 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 00:51:21,831 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 00:51:21,831 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 00:51:21,836 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 00:51:21,836 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 00:51:21,836 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 00:51:21,840 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 00:51:21,844 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 00:51:21,844 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 00:51:21,844 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 00:51:21,844 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 00:51:21,844 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 00:51:21,850 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 00:51:21,854 - DEBUG - üîó Foreign keys for users: []
2025-11-09 00:51:21,854 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 00:51:21,854 - DEBUG - üîç Relationship Details:
2025-11-09 00:51:21,854 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,855 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 00:51:21,855 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,855 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,855 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,855 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 00:51:21,855 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,855 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 00:51:21,855 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 00:51:21,855 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 00:51:21,855 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 00:51:21,855 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 00:51:21,855 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 00:51:21,855 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 00:51:51,153 - INFO - Database engine created with pool_size=10
2025-11-09 00:51:51,881 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 00:51:51,882 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 00:51:51,888 - INFO - SQLModel query returned 53 rows
2025-11-09 00:51:51,888 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 00:51:51,888 - DEBUG - Starting to process and group results
2025-11-09 00:51:51,888 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:51:51,888 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 00:51:51,888 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:51:51,888 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 00:51:51,889 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 00:51:51,889 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 00:51:51,889 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:51:51,889 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 00:51:51,889 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 00:51:51,889 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 00:51:51,889 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 00:51:51,889 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 00:51:51,889 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:51:51,889 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 00:51:51,889 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 00:51:51,889 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 00:51:51,890 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 00:51:51,890 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 00:51:51,890 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 00:51:51,890 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 00:51:51,890 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 00:51:51,890 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 00:51:51,890 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 00:51:51,890 - DEBUG - Converting to final data structure
2025-11-09 00:51:51,890 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 00:51:51,890 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 00:51:51,890 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 00:51:51,890 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 00:51:51,891 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 00:51:51,891 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 00:51:52,341 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 00:51:52,341 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 00:51:52,343 - INFO - SQLModel query returned 53 rows
2025-11-09 00:51:52,344 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 00:51:52,344 - DEBUG - Starting to process and group results
2025-11-09 00:51:52,344 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:51:52,344 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 00:51:52,344 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:51:52,344 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 00:51:52,344 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 00:51:52,344 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 00:51:52,344 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:51:52,344 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 00:51:52,344 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 00:51:52,344 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 00:51:52,344 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 00:51:52,345 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 00:51:52,345 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 00:51:52,345 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 00:51:52,346 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 00:51:52,346 - DEBUG - Converting to final data structure
2025-11-09 00:51:52,346 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 00:51:52,346 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 00:51:52,346 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 00:51:52,346 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 00:51:52,346 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 00:51:52,347 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 00:53:12,341 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 00:53:12,342 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 00:53:12,344 - INFO - SQLModel query returned 53 rows
2025-11-09 00:53:12,344 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 00:53:12,345 - DEBUG - Starting to process and group results
2025-11-09 00:53:12,345 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:53:12,345 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 00:53:12,345 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 00:53:12,345 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,345 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,345 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,345 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 00:53:12,345 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 00:53:12,345 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 00:53:12,345 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 00:53:12,346 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 00:53:12,346 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 00:53:12,346 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 00:53:12,346 - DEBUG - Converting to final data structure
2025-11-09 00:53:12,346 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 00:53:12,346 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 00:53:12,346 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 00:53:12,346 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 00:53:12,346 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 00:53:12,346 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 00:53:12,818 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 00:53:12,818 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 00:53:12,820 - INFO - SQLModel query returned 53 rows
2025-11-09 00:53:12,820 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 00:53:12,821 - DEBUG - Starting to process and group results
2025-11-09 00:53:12,821 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:53:12,821 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 00:53:12,821 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,821 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 00:53:12,821 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,821 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,821 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,821 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 00:53:12,821 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 00:53:12,821 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 00:53:12,821 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 00:53:12,821 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 00:53:12,821 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:53:12,822 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 00:53:12,822 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 00:53:12,822 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 00:53:12,822 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 00:53:12,822 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 00:53:12,822 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 00:53:12,822 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 00:53:12,822 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 00:53:12,822 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 00:53:12,822 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 00:53:12,822 - DEBUG - Converting to final data structure
2025-11-09 00:53:12,822 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 00:53:12,823 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 00:53:12,823 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 00:53:12,823 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 00:53:12,823 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 00:53:12,823 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 00:56:26,339 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 00:56:26,340 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 00:56:26,342 - INFO - SQLModel query returned 53 rows
2025-11-09 00:56:26,342 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 00:56:26,342 - DEBUG - Starting to process and group results
2025-11-09 00:56:26,342 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:56:26,342 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 00:56:26,342 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,342 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 00:56:26,342 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,342 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,342 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,343 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,343 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 00:56:26,343 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 00:56:26,343 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 00:56:26,343 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 00:56:26,343 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:56:26,343 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 00:56:26,343 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 00:56:26,343 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 00:56:26,343 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 00:56:26,343 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 00:56:26,344 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 00:56:26,344 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 00:56:26,344 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 00:56:26,344 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 00:56:26,344 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 00:56:26,344 - DEBUG - Converting to final data structure
2025-11-09 00:56:26,344 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 00:56:26,344 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 00:56:26,344 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 00:56:26,344 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 00:56:26,344 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 00:56:26,345 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 00:56:26,727 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 00:56:26,728 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 00:56:26,730 - INFO - SQLModel query returned 53 rows
2025-11-09 00:56:26,730 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 00:56:26,730 - DEBUG - Starting to process and group results
2025-11-09 00:56:26,730 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:56:26,730 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 00:56:26,730 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,730 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 00:56:26,730 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,730 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,730 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,730 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 00:56:26,730 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 00:56:26,730 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 00:56:26,730 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 00:56:26,730 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 00:56:26,731 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 00:56:26,731 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 00:56:26,731 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 00:56:26,731 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 00:56:26,731 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 00:56:26,731 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 00:56:26,731 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 00:56:26,731 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 00:56:26,731 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 00:56:26,731 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 00:56:26,731 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 00:56:26,731 - DEBUG - Converting to final data structure
2025-11-09 00:56:26,731 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 00:56:26,731 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 00:56:26,731 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 00:56:26,731 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 00:56:26,731 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 00:56:26,732 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 01:00:28,533 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 01:00:28,534 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 01:00:28,536 - INFO - SQLModel query returned 53 rows
2025-11-09 01:00:28,536 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 01:00:28,536 - DEBUG - Starting to process and group results
2025-11-09 01:00:28,536 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 01:00:28,536 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 01:00:28,536 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,536 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 01:00:28,536 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,536 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,536 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,536 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,536 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 01:00:28,536 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 01:00:28,536 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 01:00:28,537 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 01:00:28,537 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 01:00:28,537 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 01:00:28,537 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 01:00:28,537 - DEBUG - Converting to final data structure
2025-11-09 01:00:28,537 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 01:00:28,537 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 01:00:28,537 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 01:00:28,537 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 01:00:28,537 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 01:00:28,538 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 01:00:28,929 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 01:00:28,929 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 01:00:28,931 - INFO - SQLModel query returned 53 rows
2025-11-09 01:00:28,931 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 01:00:28,931 - DEBUG - Starting to process and group results
2025-11-09 01:00:28,931 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 01:00:28,931 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 01:00:28,931 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 01:00:28,932 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,932 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,932 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,932 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 01:00:28,932 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 01:00:28,932 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 01:00:28,933 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 01:00:28,933 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 01:00:28,933 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 01:00:28,933 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 01:00:28,933 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 01:00:28,933 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 01:00:28,933 - DEBUG - Converting to final data structure
2025-11-09 01:00:28,933 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 01:00:28,933 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 01:00:28,933 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 01:00:28,933 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 01:00:28,933 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 01:00:28,934 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 13:51:05,516 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-09 13:51:05,516 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-09 13:51:05,516 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-09 13:51:05,680 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-09 13:51:05,931 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 13:51:05,947 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 13:51:05,947 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 13:51:05,962 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 13:51:05,977 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 13:51:05,986 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 13:51:06,128 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 13:51:06,134 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 13:51:06,137 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 13:51:06,140 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 13:51:06,143 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 13:51:06,145 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 13:51:06,148 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 13:51:06,151 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 13:51:06,154 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 13:51:06,157 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 13:51:06,160 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 13:51:06,163 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 13:51:06,165 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 13:51:06,168 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 13:51:06,174 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 13:51:06,178 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 13:51:06,178 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 13:51:06,182 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 13:51:06,182 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 13:51:06,186 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 13:51:06,187 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 13:51:06,191 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 13:51:06,191 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 13:51:06,195 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 13:51:06,195 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 13:51:06,199 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 13:51:06,199 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 13:51:06,203 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 13:51:06,203 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 13:51:06,204 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 13:51:06,208 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 13:51:06,208 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 13:51:06,208 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 13:51:06,212 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 13:51:06,217 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 13:51:06,217 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 13:51:06,217 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 13:51:06,217 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 13:51:06,217 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 13:51:06,221 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 13:51:06,225 - DEBUG - üîó Foreign keys for users: []
2025-11-09 13:51:06,225 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 13:51:06,225 - DEBUG - üîç Relationship Details:
2025-11-09 13:51:06,226 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 13:51:06,226 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 13:51:06,226 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 13:51:06,226 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 13:51:06,226 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 13:51:06,226 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 13:51:06,226 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 13:51:06,226 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 13:51:06,226 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 13:51:06,226 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 13:51:06,226 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 13:51:06,226 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 13:51:06,226 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 13:51:06,226 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 13:51:06,228 - INFO - üìå Loaded conversation memory from disk.
2025-11-09 13:51:06,228 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-09 13:51:07,637 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-09 13:51:07,652 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-09 13:51:07,653 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-09 13:51:07,666 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-09 13:51:07,670 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-09 13:51:07,673 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-09 13:51:07,676 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-09 13:51:07,678 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-09 13:51:07,681 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-09 13:51:07,684 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-09 13:51:07,687 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-09 13:51:07,690 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-09 13:51:07,692 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-09 13:51:07,695 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-09 13:51:07,698 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-09 13:51:07,701 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-09 13:51:07,704 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-09 13:51:07,710 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-09 13:51:07,715 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 13:51:07,715 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-09 13:51:07,720 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-09 13:51:07,720 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-09 13:51:07,724 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 13:51:07,724 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-09 13:51:07,729 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 13:51:07,729 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-09 13:51:07,733 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-09 13:51:07,733 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-09 13:51:07,738 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-09 13:51:07,738 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-09 13:51:07,742 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-09 13:51:07,743 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-09 13:51:07,743 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-09 13:51:07,747 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-09 13:51:07,747 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-09 13:51:07,747 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-09 13:51:07,751 - DEBUG - üîó Foreign keys for ships: []
2025-11-09 13:51:07,756 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-09 13:51:07,756 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-09 13:51:07,756 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-09 13:51:07,756 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-09 13:51:07,756 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-09 13:51:07,761 - DEBUG - üîó Foreign keys for systems: []
2025-11-09 13:51:07,766 - DEBUG - üîó Foreign keys for users: []
2025-11-09 13:51:07,766 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-09 13:51:07,766 - DEBUG - üîç Relationship Details:
2025-11-09 13:51:07,766 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-09 13:51:07,766 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-09 13:51:07,766 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-09 13:51:07,766 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-09 13:51:07,766 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-09 13:51:07,766 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-09 13:51:07,766 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-09 13:51:07,766 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-09 13:51:07,766 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-09 13:51:07,766 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-09 13:51:07,767 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-09 13:51:07,767 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-09 13:51:07,767 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-09 13:51:07,767 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-09 13:52:29,467 - INFO - Database engine created with pool_size=10
2025-11-09 13:52:29,467 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 13:52:29,468 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 13:52:29,499 - INFO - SQLModel query returned 53 rows
2025-11-09 13:52:29,500 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 13:52:29,500 - DEBUG - Starting to process and group results
2025-11-09 13:52:29,500 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 13:52:29,500 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 13:52:29,500 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 13:52:29,500 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 13:52:29,500 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 13:52:29,500 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 13:52:29,500 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 13:52:29,500 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 13:52:29,500 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 13:52:29,500 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 13:52:29,501 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 13:52:29,501 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 13:52:29,501 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 13:52:29,502 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 13:52:29,502 - DEBUG - Converting to final data structure
2025-11-09 13:52:29,502 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 13:52:29,502 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 13:52:29,502 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 13:52:29,502 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 13:52:29,502 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 13:52:29,502 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 15:35:41,992 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 15:35:41,993 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 15:35:41,997 - INFO - SQLModel query returned 53 rows
2025-11-09 15:35:41,997 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 15:35:41,997 - DEBUG - Starting to process and group results
2025-11-09 15:35:41,997 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 15:35:41,997 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 15:35:41,997 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 15:35:41,997 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 15:35:41,997 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 15:35:41,997 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 15:35:41,997 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 15:35:41,997 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 15:35:41,998 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 15:35:41,998 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 15:35:41,998 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 15:35:41,998 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 15:35:41,998 - DEBUG - Converting to final data structure
2025-11-09 15:35:41,998 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 15:35:41,998 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 15:35:41,998 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 15:35:41,998 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 15:35:41,999 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 15:35:41,999 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 15:35:42,404 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 15:35:42,405 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 15:35:42,407 - INFO - SQLModel query returned 53 rows
2025-11-09 15:35:42,408 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 15:35:42,408 - DEBUG - Starting to process and group results
2025-11-09 15:35:42,408 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 15:35:42,408 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 15:35:42,408 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 15:35:42,408 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 15:35:42,408 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 15:35:42,408 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 15:35:42,408 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 15:35:42,408 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 15:35:42,408 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 15:35:42,408 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 15:35:42,408 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 15:35:42,409 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 15:35:42,409 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 15:35:42,409 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 15:35:42,409 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 15:35:42,409 - DEBUG - Converting to final data structure
2025-11-09 15:35:42,410 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 15:35:42,410 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 15:35:42,410 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 15:35:42,410 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 15:35:42,410 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 15:35:42,410 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 20:18:08,180 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 20:18:08,180 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 20:18:08,266 - INFO - SQLModel query returned 53 rows
2025-11-09 20:18:08,266 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 20:18:08,266 - DEBUG - Starting to process and group results
2025-11-09 20:18:08,266 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 20:18:08,266 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 20:18:08,266 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 20:18:08,266 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 20:18:08,266 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 20:18:08,267 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 20:18:08,267 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 20:18:08,267 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 20:18:08,267 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 20:18:08,267 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 20:18:08,267 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 20:18:08,267 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 20:18:08,267 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 20:18:08,267 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 20:18:08,267 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 20:18:08,267 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 20:18:08,267 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 20:18:08,268 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 20:18:08,268 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 20:18:08,268 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 20:18:08,268 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 20:18:08,268 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 20:18:08,268 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 20:18:08,268 - DEBUG - Converting to final data structure
2025-11-09 20:18:08,268 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 20:18:08,268 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 20:18:08,268 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 20:18:08,268 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 20:18:08,268 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 20:18:08,295 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 21:28:37,702 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 21:28:37,702 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 21:28:37,711 - INFO - SQLModel query returned 53 rows
2025-11-09 21:28:37,711 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 21:28:37,711 - DEBUG - Starting to process and group results
2025-11-09 21:28:37,711 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:28:37,711 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 21:28:37,711 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:28:37,711 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 21:28:37,711 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 21:28:37,711 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 21:28:37,711 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:28:37,711 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 21:28:37,711 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 21:28:37,711 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 21:28:37,711 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 21:28:37,711 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 21:28:37,711 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:28:37,711 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 21:28:37,711 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 21:28:37,711 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 21:28:37,712 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 21:28:37,712 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 21:28:37,712 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 21:28:37,712 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 21:28:37,712 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 21:28:37,712 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 21:28:37,712 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 21:28:37,712 - DEBUG - Converting to final data structure
2025-11-09 21:28:37,712 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 21:28:37,712 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 21:28:37,712 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 21:28:37,712 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 21:28:37,712 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 21:28:37,712 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 21:32:30,039 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 21:32:30,040 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 21:32:31,002 - INFO - SQLModel query returned 53 rows
2025-11-09 21:32:31,002 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 21:32:31,002 - DEBUG - Starting to process and group results
2025-11-09 21:32:31,002 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:32:31,002 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 21:32:31,002 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:32:31,002 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 21:32:31,002 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 21:32:31,002 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 21:32:31,003 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:32:31,003 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 21:32:31,003 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 21:32:31,003 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 21:32:31,003 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 21:32:31,003 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 21:32:31,003 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:32:31,003 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 21:32:31,003 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 21:32:31,003 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 21:32:31,003 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 21:32:31,003 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 21:32:31,004 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 21:32:31,004 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 21:32:31,004 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 21:32:31,004 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 21:32:31,004 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 21:32:31,004 - DEBUG - Converting to final data structure
2025-11-09 21:32:31,004 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 21:32:31,004 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 21:32:31,004 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 21:32:31,004 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 21:32:31,004 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 21:32:31,689 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 21:32:57,893 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 21:32:57,894 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 21:32:57,896 - INFO - SQLModel query returned 53 rows
2025-11-09 21:32:57,896 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 21:32:57,896 - DEBUG - Starting to process and group results
2025-11-09 21:32:57,896 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:32:57,896 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 21:32:57,896 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:32:57,897 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 21:32:57,897 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 21:32:57,897 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 21:32:57,897 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:32:57,897 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 21:32:57,897 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 21:32:57,897 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 21:32:57,897 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 21:32:57,897 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 21:32:57,897 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:32:57,897 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 21:32:57,897 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 21:32:57,898 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 21:32:57,898 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 21:32:57,898 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 21:32:57,898 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 21:32:57,898 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 21:32:57,898 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 21:32:57,898 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 21:32:57,898 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 21:32:57,898 - DEBUG - Converting to final data structure
2025-11-09 21:32:57,898 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 21:32:57,898 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 21:32:57,899 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 21:32:57,899 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 21:32:57,899 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 21:32:57,899 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 21:44:45,942 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 21:44:45,942 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 21:44:45,950 - INFO - SQLModel query returned 53 rows
2025-11-09 21:44:45,950 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 21:44:45,950 - DEBUG - Starting to process and group results
2025-11-09 21:44:45,950 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:44:45,950 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 21:44:45,950 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:44:45,950 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 21:44:45,950 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 21:44:45,950 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 21:44:45,950 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:44:45,950 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 21:44:45,950 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 21:44:45,950 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 21:44:45,950 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 21:44:45,950 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 21:44:45,950 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:44:45,950 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 21:44:45,950 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 21:44:45,950 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 21:44:45,951 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 21:44:45,951 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 21:44:45,951 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 21:44:45,951 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 21:44:45,951 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 21:44:45,951 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 21:44:45,951 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 21:44:45,951 - DEBUG - Converting to final data structure
2025-11-09 21:44:45,951 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 21:44:45,951 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 21:44:45,951 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 21:44:45,951 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 21:44:45,951 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 21:44:45,951 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 21:52:34,463 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 21:52:34,463 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 21:52:34,474 - INFO - SQLModel query returned 53 rows
2025-11-09 21:52:34,474 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 21:52:34,474 - DEBUG - Starting to process and group results
2025-11-09 21:52:34,474 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:52:34,474 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 21:52:34,474 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:52:34,474 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 21:52:34,474 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 21:52:34,474 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 21:52:34,474 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 21:52:34,474 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 21:52:34,475 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 21:52:34,475 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 21:52:34,475 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 21:52:34,476 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 21:52:34,476 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 21:52:34,476 - DEBUG - Converting to final data structure
2025-11-09 21:52:34,476 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 21:52:34,476 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 21:52:34,476 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 21:52:34,476 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 21:52:34,476 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 21:52:34,477 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 22:10:26,994 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 22:10:26,994 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 22:10:27,002 - INFO - SQLModel query returned 53 rows
2025-11-09 22:10:27,002 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 22:10:27,002 - DEBUG - Starting to process and group results
2025-11-09 22:10:27,002 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 22:10:27,002 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 22:10:27,002 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 22:10:27,002 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 22:10:27,003 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 22:10:27,003 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 22:10:27,003 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 22:10:27,003 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 22:10:27,003 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 22:10:27,003 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 22:10:27,003 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 22:10:27,003 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 22:10:27,003 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 22:10:27,003 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 22:10:27,003 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 22:10:27,003 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 22:10:27,004 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 22:10:27,004 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 22:10:27,004 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 22:10:27,004 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 22:10:27,004 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 22:10:27,004 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 22:10:27,004 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 22:10:27,004 - DEBUG - Converting to final data structure
2025-11-09 22:10:27,004 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 22:10:27,004 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 22:10:27,004 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 22:10:27,004 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 22:10:27,005 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 22:10:27,005 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 22:15:20,638 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 22:15:20,638 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 22:15:20,640 - INFO - SQLModel query returned 53 rows
2025-11-09 22:15:20,640 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 22:15:20,640 - DEBUG - Starting to process and group results
2025-11-09 22:15:20,640 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 22:15:20,641 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 22:15:20,641 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 22:15:20,641 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 22:15:20,641 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 22:15:20,641 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 22:15:20,641 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 22:15:20,641 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 22:15:20,641 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 22:15:20,641 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 22:15:20,641 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 22:15:20,641 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 22:15:20,641 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 22:15:20,641 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 22:15:20,642 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 22:15:20,642 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 22:15:20,642 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 22:15:20,642 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 22:15:20,642 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 22:15:20,642 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 22:15:20,642 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 22:15:20,642 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 22:15:20,642 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 22:15:20,642 - DEBUG - Converting to final data structure
2025-11-09 22:15:20,642 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 22:15:20,642 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 22:15:20,642 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 22:15:20,643 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 22:15:20,643 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 22:15:20,643 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 22:20:08,452 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 22:20:08,452 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 22:20:08,460 - INFO - SQLModel query returned 53 rows
2025-11-09 22:20:08,460 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 22:20:08,460 - DEBUG - Starting to process and group results
2025-11-09 22:20:08,460 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 22:20:08,460 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 22:20:08,460 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 22:20:08,460 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 22:20:08,460 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 22:20:08,460 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 22:20:08,460 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 22:20:08,461 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 22:20:08,461 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 22:20:08,461 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 22:20:08,461 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 22:20:08,462 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 22:20:08,462 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 22:20:08,462 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 22:20:08,462 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 22:20:08,462 - DEBUG - Converting to final data structure
2025-11-09 22:20:08,462 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 22:20:08,462 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 22:20:08,462 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 22:20:08,462 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 22:20:08,462 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 22:20:08,463 - INFO - Successfully retrieved hierarchical ship data
2025-11-09 22:20:29,723 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-09 22:20:29,724 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-09 22:20:29,726 - INFO - SQLModel query returned 53 rows
2025-11-09 22:20:29,726 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-09 22:20:29,726 - DEBUG - Starting to process and group results
2025-11-09 22:20:29,726 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 22:20:29,726 - DEBUG - Creating new command group: Western Naval Command
2025-11-09 22:20:29,726 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 22:20:29,726 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-09 22:20:29,726 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-09 22:20:29,726 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-09 22:20:29,726 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-09 22:20:29,727 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-09 22:20:29,727 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-09 22:20:29,727 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-09 22:20:29,727 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-09 22:20:29,727 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-09 22:20:29,727 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-09 22:20:29,727 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-09 22:20:29,727 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-09 22:20:29,727 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-09 22:20:29,728 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-09 22:20:29,728 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-09 22:20:29,728 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-09 22:20:29,728 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-09 22:20:29,728 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-09 22:20:29,728 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-09 22:20:29,728 - INFO - Processed 3 unique ships into 1 command groups
2025-11-09 22:20:29,728 - DEBUG - Converting to final data structure
2025-11-09 22:20:29,728 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-09 22:20:29,728 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-09 22:20:29,728 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-09 22:20:29,728 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-09 22:20:29,729 - DEBUG - Command groups: ['Western Naval Command']
2025-11-09 22:20:29,729 - INFO - Successfully retrieved hierarchical ship data
2025-11-10 00:56:26,542 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-10 00:56:26,542 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-10 00:56:26,542 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-10 00:56:26,713 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-10 00:56:26,972 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-10 00:56:26,988 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-10 00:56:26,988 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-10 00:56:27,004 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-10 00:56:27,018 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-10 00:56:27,027 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-10 00:56:27,971 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-10 00:56:27,977 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-10 00:56:27,980 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-10 00:56:27,982 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-10 00:56:27,985 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-10 00:56:27,988 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-10 00:56:27,990 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-10 00:56:27,994 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-10 00:56:27,997 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-10 00:56:28,000 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-10 00:56:28,003 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-10 00:56:28,006 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-10 00:56:28,008 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-10 00:56:28,011 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-10 00:56:28,017 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-10 00:56:28,022 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 00:56:28,022 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-10 00:56:28,026 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-10 00:56:28,027 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-10 00:56:28,031 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 00:56:28,031 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-10 00:56:28,035 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 00:56:28,036 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-10 00:56:28,040 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 00:56:28,040 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-10 00:56:28,044 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-10 00:56:28,044 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-10 00:56:28,049 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-10 00:56:28,049 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-10 00:56:28,049 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-10 00:56:28,053 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-10 00:56:28,053 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-10 00:56:28,053 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-10 00:56:28,058 - DEBUG - üîó Foreign keys for ships: []
2025-11-10 00:56:28,062 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-10 00:56:28,062 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-10 00:56:28,062 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-10 00:56:28,062 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-10 00:56:28,062 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-10 00:56:28,066 - DEBUG - üîó Foreign keys for systems: []
2025-11-10 00:56:28,070 - DEBUG - üîó Foreign keys for users: []
2025-11-10 00:56:28,070 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-10 00:56:28,070 - DEBUG - üîç Relationship Details:
2025-11-10 00:56:28,070 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,071 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-10 00:56:28,071 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,071 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,071 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,071 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-10 00:56:28,071 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,071 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-10 00:56:28,071 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,071 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-10 00:56:28,071 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-10 00:56:28,071 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-10 00:56:28,071 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-10 00:56:28,071 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-10 00:56:28,072 - INFO - üìå Loaded conversation memory from disk.
2025-11-10 00:56:28,072 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-10 00:56:28,771 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-10 00:56:28,787 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-10 00:56:28,787 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-10 00:56:28,800 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-10 00:56:28,804 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-10 00:56:28,806 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-10 00:56:28,809 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-10 00:56:28,811 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-10 00:56:28,814 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-10 00:56:28,816 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-10 00:56:28,819 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-10 00:56:28,822 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-10 00:56:28,824 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-10 00:56:28,827 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-10 00:56:28,830 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-10 00:56:28,833 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-10 00:56:28,835 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-10 00:56:28,840 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-10 00:56:28,844 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 00:56:28,845 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-10 00:56:28,849 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-10 00:56:28,849 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-10 00:56:28,853 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 00:56:28,853 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-10 00:56:28,857 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 00:56:28,857 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-10 00:56:28,861 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 00:56:28,861 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-10 00:56:28,865 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-10 00:56:28,865 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-10 00:56:28,869 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-10 00:56:28,869 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-10 00:56:28,869 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-10 00:56:28,874 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-10 00:56:28,874 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-10 00:56:28,874 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-10 00:56:28,878 - DEBUG - üîó Foreign keys for ships: []
2025-11-10 00:56:28,883 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-10 00:56:28,883 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-10 00:56:28,883 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-10 00:56:28,883 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-10 00:56:28,883 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-10 00:56:28,887 - DEBUG - üîó Foreign keys for systems: []
2025-11-10 00:56:28,891 - DEBUG - üîó Foreign keys for users: []
2025-11-10 00:56:28,891 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-10 00:56:28,891 - DEBUG - üîç Relationship Details:
2025-11-10 00:56:28,891 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,891 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-10 00:56:28,891 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,891 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,891 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,891 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-10 00:56:28,891 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,891 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-10 00:56:28,891 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-10 00:56:28,892 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-10 00:56:28,892 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-10 00:56:28,892 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-10 00:56:28,892 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-10 00:56:28,892 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-10 00:57:11,101 - INFO - Database engine created with pool_size=10
2025-11-10 00:57:11,101 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-10 00:57:11,102 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-10 00:57:11,135 - INFO - SQLModel query returned 53 rows
2025-11-10 00:57:11,135 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-10 00:57:11,135 - DEBUG - Starting to process and group results
2025-11-10 00:57:11,135 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 00:57:11,135 - DEBUG - Creating new command group: Western Naval Command
2025-11-10 00:57:11,135 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 00:57:11,135 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-10 00:57:11,135 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-10 00:57:11,135 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-10 00:57:11,135 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 00:57:11,135 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-10 00:57:11,135 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-10 00:57:11,135 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-10 00:57:11,135 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-10 00:57:11,135 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-10 00:57:11,136 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 00:57:11,136 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-10 00:57:11,136 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-10 00:57:11,136 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-10 00:57:11,136 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-10 00:57:11,136 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-10 00:57:11,136 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-10 00:57:11,136 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-10 00:57:11,136 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-10 00:57:11,136 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-10 00:57:11,136 - INFO - Processed 3 unique ships into 1 command groups
2025-11-10 00:57:11,136 - DEBUG - Converting to final data structure
2025-11-10 00:57:11,136 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-10 00:57:11,136 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-10 00:57:11,136 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-10 00:57:11,136 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-10 00:57:11,136 - DEBUG - Command groups: ['Western Naval Command']
2025-11-10 00:57:11,137 - INFO - Successfully retrieved hierarchical ship data
2025-11-10 12:36:00,994 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-10 12:36:00,995 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-10 12:36:00,995 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-10 12:36:01,159 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-10 12:36:01,388 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-10 12:36:01,403 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-10 12:36:01,403 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-10 12:36:01,418 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-10 12:36:01,433 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-10 12:36:01,442 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-10 12:36:01,522 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-10 12:36:01,528 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-10 12:36:01,531 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-10 12:36:01,533 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-10 12:36:01,536 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-10 12:36:01,539 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-10 12:36:01,541 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-10 12:36:01,544 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-10 12:36:01,547 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-10 12:36:01,549 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-10 12:36:01,552 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-10 12:36:01,556 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-10 12:36:01,558 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-10 12:36:01,561 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-10 12:36:01,566 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-10 12:36:01,571 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 12:36:01,571 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-10 12:36:01,575 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-10 12:36:01,575 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-10 12:36:01,579 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 12:36:01,579 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-10 12:36:01,583 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 12:36:01,583 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-10 12:36:01,587 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 12:36:01,587 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-10 12:36:01,591 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-10 12:36:01,591 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-10 12:36:01,596 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-10 12:36:01,596 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-10 12:36:01,596 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-10 12:36:01,600 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-10 12:36:01,600 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-10 12:36:01,600 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-10 12:36:01,604 - DEBUG - üîó Foreign keys for ships: []
2025-11-10 12:36:01,609 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-10 12:36:01,609 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-10 12:36:01,609 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-10 12:36:01,609 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-10 12:36:01,609 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-10 12:36:01,613 - DEBUG - üîó Foreign keys for systems: []
2025-11-10 12:36:01,617 - DEBUG - üîó Foreign keys for users: []
2025-11-10 12:36:01,617 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-10 12:36:01,617 - DEBUG - üîç Relationship Details:
2025-11-10 12:36:01,617 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-10 12:36:01,617 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-10 12:36:01,617 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-10 12:36:01,617 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-10 12:36:01,617 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-10 12:36:01,618 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-10 12:36:01,618 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-10 12:36:01,618 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-10 12:36:01,618 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-10 12:36:01,618 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-10 12:36:01,618 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-10 12:36:01,618 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-10 12:36:01,618 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-10 12:36:01,618 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-10 12:36:01,619 - INFO - üìå Loaded conversation memory from disk.
2025-11-10 12:36:01,619 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-10 12:36:02,272 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-10 12:36:02,288 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-10 12:36:02,288 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-10 12:36:02,300 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-10 12:36:02,305 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-10 12:36:02,307 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-10 12:36:02,310 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-10 12:36:02,312 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-10 12:36:02,315 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-10 12:36:02,317 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-10 12:36:02,320 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-10 12:36:02,324 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-10 12:36:02,326 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-10 12:36:02,329 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-10 12:36:02,332 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-10 12:36:02,334 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-10 12:36:02,337 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-10 12:36:02,342 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-10 12:36:02,346 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 12:36:02,346 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-10 12:36:02,351 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-10 12:36:02,351 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-10 12:36:02,355 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 12:36:02,355 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-10 12:36:02,359 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 12:36:02,360 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-10 12:36:02,364 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-10 12:36:02,364 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-10 12:36:02,369 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-10 12:36:02,369 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-10 12:36:02,373 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-10 12:36:02,373 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-10 12:36:02,373 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-10 12:36:02,377 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-10 12:36:02,377 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-10 12:36:02,378 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-10 12:36:02,382 - DEBUG - üîó Foreign keys for ships: []
2025-11-10 12:36:02,386 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-10 12:36:02,386 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-10 12:36:02,387 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-10 12:36:02,387 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-10 12:36:02,387 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-10 12:36:02,391 - DEBUG - üîó Foreign keys for systems: []
2025-11-10 12:36:02,395 - DEBUG - üîó Foreign keys for users: []
2025-11-10 12:36:02,395 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-10 12:36:02,396 - DEBUG - üîç Relationship Details:
2025-11-10 12:36:02,396 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-10 12:36:02,396 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-10 12:36:02,396 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-10 12:36:02,396 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-10 12:36:02,396 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-10 12:36:02,396 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-10 12:36:02,396 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-10 12:36:02,396 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-10 12:36:02,396 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-10 12:36:02,396 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-10 12:36:02,396 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-10 12:36:02,396 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-10 12:36:02,396 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-10 12:36:02,396 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-10 12:36:26,153 - INFO - Database engine created with pool_size=10
2025-11-10 12:36:26,153 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-10 12:36:26,154 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-10 12:36:26,184 - INFO - SQLModel query returned 53 rows
2025-11-10 12:36:26,185 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-10 12:36:26,185 - DEBUG - Starting to process and group results
2025-11-10 12:36:26,185 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 12:36:26,185 - DEBUG - Creating new command group: Western Naval Command
2025-11-10 12:36:26,185 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,185 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-10 12:36:26,185 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,185 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,185 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,185 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,185 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-10 12:36:26,185 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-10 12:36:26,185 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-10 12:36:26,186 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-10 12:36:26,186 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-10 12:36:26,186 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-10 12:36:26,186 - INFO - Processed 3 unique ships into 1 command groups
2025-11-10 12:36:26,186 - DEBUG - Converting to final data structure
2025-11-10 12:36:26,186 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-10 12:36:26,187 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-10 12:36:26,187 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-10 12:36:26,187 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-10 12:36:26,187 - DEBUG - Command groups: ['Western Naval Command']
2025-11-10 12:36:26,187 - INFO - Successfully retrieved hierarchical ship data
2025-11-10 12:36:26,539 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-10 12:36:26,539 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-10 12:36:26,542 - INFO - SQLModel query returned 53 rows
2025-11-10 12:36:26,542 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-10 12:36:26,542 - DEBUG - Starting to process and group results
2025-11-10 12:36:26,542 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 12:36:26,542 - DEBUG - Creating new command group: Western Naval Command
2025-11-10 12:36:26,542 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,542 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-10 12:36:26,542 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,542 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,542 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,542 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-10 12:36:26,542 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-10 12:36:26,542 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-10 12:36:26,543 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-10 12:36:26,543 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-10 12:36:26,543 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-10 12:36:26,543 - INFO - Processed 3 unique ships into 1 command groups
2025-11-10 12:36:26,543 - DEBUG - Converting to final data structure
2025-11-10 12:36:26,544 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-10 12:36:26,544 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-10 12:36:26,544 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-10 12:36:26,544 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-10 12:36:26,544 - DEBUG - Command groups: ['Western Naval Command']
2025-11-10 12:36:26,544 - INFO - Successfully retrieved hierarchical ship data
2025-11-10 12:36:29,282 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-10 12:36:29,282 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-10 12:36:29,284 - INFO - SQLModel query returned 53 rows
2025-11-10 12:36:29,285 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-10 12:36:29,285 - DEBUG - Starting to process and group results
2025-11-10 12:36:29,285 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 12:36:29,285 - DEBUG - Creating new command group: Western Naval Command
2025-11-10 12:36:29,285 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 12:36:29,285 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-10 12:36:29,285 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-10 12:36:29,285 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-10 12:36:29,285 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 12:36:29,285 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-10 12:36:29,285 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-10 12:36:29,285 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-10 12:36:29,285 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-10 12:36:29,285 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-10 12:36:29,286 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 12:36:29,286 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-10 12:36:29,286 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-10 12:36:29,286 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-10 12:36:29,286 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-10 12:36:29,286 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-10 12:36:29,286 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-10 12:36:29,286 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-10 12:36:29,286 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-10 12:36:29,286 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-10 12:36:29,286 - INFO - Processed 3 unique ships into 1 command groups
2025-11-10 12:36:29,286 - DEBUG - Converting to final data structure
2025-11-10 12:36:29,287 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-10 12:36:29,287 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-10 12:36:29,287 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-10 12:36:29,287 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-10 12:36:29,287 - DEBUG - Command groups: ['Western Naval Command']
2025-11-10 12:36:29,287 - INFO - Successfully retrieved hierarchical ship data
2025-11-10 12:42:45,602 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-10 12:42:45,602 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-10 12:42:45,610 - INFO - SQLModel query returned 53 rows
2025-11-10 12:42:45,610 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-10 12:42:45,610 - DEBUG - Starting to process and group results
2025-11-10 12:42:45,610 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 12:42:45,610 - DEBUG - Creating new command group: Western Naval Command
2025-11-10 12:42:45,610 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 12:42:45,610 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-10 12:42:45,610 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-10 12:42:45,610 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-10 12:42:45,611 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-10 12:42:45,611 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-10 12:42:45,611 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-10 12:42:45,611 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-10 12:42:45,611 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-10 12:42:45,611 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-10 12:42:45,611 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-10 12:42:45,611 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-10 12:42:45,611 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-10 12:42:45,611 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-10 12:42:45,611 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-10 12:42:45,611 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-10 12:42:45,612 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-10 12:42:45,612 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-10 12:42:45,612 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-10 12:42:45,612 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-10 12:42:45,612 - INFO - Processed 3 unique ships into 1 command groups
2025-11-10 12:42:45,612 - DEBUG - Converting to final data structure
2025-11-10 12:42:45,612 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-10 12:42:45,612 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-10 12:42:45,612 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-10 12:42:45,612 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-10 12:42:45,612 - DEBUG - Command groups: ['Western Naval Command']
2025-11-10 12:42:45,613 - INFO - Successfully retrieved hierarchical ship data
2025-11-11 11:06:44,149 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-11 11:06:44,149 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-11 11:06:44,149 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-11 11:06:44,314 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-11 11:06:44,544 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:06:44,560 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-11 11:06:44,560 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:06:44,575 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:06:44,590 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-11 11:06:44,599 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-11 11:06:45,040 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-11 11:06:45,046 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-11 11:06:45,049 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-11 11:06:45,052 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-11 11:06:45,055 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-11 11:06:45,057 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-11 11:06:45,060 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-11 11:06:45,062 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-11 11:06:45,066 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-11 11:06:45,069 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-11 11:06:45,072 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-11 11:06:45,076 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-11 11:06:45,078 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-11 11:06:45,081 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-11 11:06:45,087 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-11 11:06:45,091 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:06:45,091 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-11 11:06:45,096 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-11 11:06:45,096 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-11 11:06:45,100 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:06:45,100 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-11 11:06:45,104 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:06:45,104 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-11 11:06:45,108 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:06:45,109 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-11 11:06:45,113 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-11 11:06:45,113 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-11 11:06:45,117 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-11 11:06:45,117 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-11 11:06:45,117 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-11 11:06:45,121 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-11 11:06:45,121 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-11 11:06:45,122 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-11 11:06:45,126 - DEBUG - üîó Foreign keys for ships: []
2025-11-11 11:06:45,130 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-11 11:06:45,130 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-11 11:06:45,130 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-11 11:06:45,130 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-11 11:06:45,130 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-11 11:06:45,135 - DEBUG - üîó Foreign keys for systems: []
2025-11-11 11:06:45,139 - DEBUG - üîó Foreign keys for users: []
2025-11-11 11:06:45,139 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-11 11:06:45,139 - DEBUG - üîç Relationship Details:
2025-11-11 11:06:45,139 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,139 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-11 11:06:45,139 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,139 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,139 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,139 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-11 11:06:45,139 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,139 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-11 11:06:45,139 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,139 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-11 11:06:45,139 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-11 11:06:45,139 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-11 11:06:45,140 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-11 11:06:45,140 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-11 11:06:45,141 - INFO - üìå Loaded conversation memory from disk.
2025-11-11 11:06:45,141 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-11 11:06:45,820 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:06:45,835 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-11 11:06:45,836 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-11 11:06:45,848 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-11 11:06:45,853 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-11 11:06:45,855 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-11 11:06:45,858 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-11 11:06:45,861 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-11 11:06:45,864 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-11 11:06:45,866 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-11 11:06:45,869 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-11 11:06:45,872 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-11 11:06:45,875 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-11 11:06:45,878 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-11 11:06:45,881 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-11 11:06:45,883 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-11 11:06:45,886 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-11 11:06:45,891 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-11 11:06:45,896 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:06:45,896 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-11 11:06:45,901 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-11 11:06:45,901 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-11 11:06:45,905 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:06:45,905 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-11 11:06:45,909 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:06:45,909 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-11 11:06:45,913 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:06:45,913 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-11 11:06:45,917 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-11 11:06:45,917 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-11 11:06:45,921 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-11 11:06:45,921 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-11 11:06:45,921 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-11 11:06:45,925 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-11 11:06:45,926 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-11 11:06:45,926 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-11 11:06:45,930 - DEBUG - üîó Foreign keys for ships: []
2025-11-11 11:06:45,935 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-11 11:06:45,935 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-11 11:06:45,935 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-11 11:06:45,935 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-11 11:06:45,935 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-11 11:06:45,939 - DEBUG - üîó Foreign keys for systems: []
2025-11-11 11:06:45,944 - DEBUG - üîó Foreign keys for users: []
2025-11-11 11:06:45,944 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-11 11:06:45,944 - DEBUG - üîç Relationship Details:
2025-11-11 11:06:45,944 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,944 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-11 11:06:45,944 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,944 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,944 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,944 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-11 11:06:45,944 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,944 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-11 11:06:45,944 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-11 11:06:45,944 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-11 11:06:45,944 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-11 11:06:45,944 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-11 11:06:45,944 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-11 11:06:45,944 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-11 11:07:23,139 - INFO - Database engine created with pool_size=10
2025-11-11 11:07:23,139 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-11 11:07:23,140 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-11 11:07:23,171 - INFO - SQLModel query returned 53 rows
2025-11-11 11:07:23,171 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-11 11:07:23,172 - DEBUG - Starting to process and group results
2025-11-11 11:07:23,172 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 11:07:23,172 - DEBUG - Creating new command group: Western Naval Command
2025-11-11 11:07:23,172 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 11:07:23,172 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-11 11:07:23,172 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-11 11:07:23,172 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-11 11:07:23,172 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 11:07:23,172 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-11 11:07:23,172 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-11 11:07:23,172 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-11 11:07:23,172 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-11 11:07:23,172 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-11 11:07:23,172 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 11:07:23,172 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-11 11:07:23,172 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-11 11:07:23,172 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-11 11:07:23,173 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-11 11:07:23,173 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-11 11:07:23,173 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-11 11:07:23,173 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-11 11:07:23,173 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-11 11:07:23,173 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-11 11:07:23,173 - INFO - Processed 3 unique ships into 1 command groups
2025-11-11 11:07:23,173 - DEBUG - Converting to final data structure
2025-11-11 11:07:23,173 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-11 11:07:23,173 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-11 11:07:23,173 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-11 11:07:23,173 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-11 11:07:23,174 - DEBUG - Command groups: ['Western Naval Command']
2025-11-11 11:07:23,174 - INFO - Successfully retrieved hierarchical ship data
2025-11-11 11:34:25,510 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-11 11:34:25,511 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-11 11:34:25,511 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-11 11:34:25,678 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-11 11:34:25,915 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:34:25,931 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-11 11:34:25,931 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:34:25,946 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:34:25,961 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-11 11:34:25,970 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-11 11:34:26,096 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-11 11:34:26,102 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-11 11:34:26,105 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-11 11:34:26,108 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-11 11:34:26,111 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-11 11:34:26,113 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-11 11:34:26,116 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-11 11:34:26,119 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-11 11:34:26,123 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-11 11:34:26,127 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-11 11:34:26,130 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-11 11:34:26,133 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-11 11:34:26,135 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-11 11:34:26,138 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-11 11:34:26,144 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-11 11:34:26,148 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:34:26,149 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-11 11:34:26,153 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-11 11:34:26,153 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-11 11:34:26,157 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:34:26,157 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-11 11:34:26,161 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:34:26,161 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-11 11:34:26,166 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:34:26,166 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-11 11:34:26,170 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-11 11:34:26,170 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-11 11:34:26,174 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-11 11:34:26,174 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-11 11:34:26,174 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-11 11:34:26,178 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-11 11:34:26,178 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-11 11:34:26,178 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-11 11:34:26,183 - DEBUG - üîó Foreign keys for ships: []
2025-11-11 11:34:26,187 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-11 11:34:26,187 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-11 11:34:26,187 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-11 11:34:26,187 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-11 11:34:26,187 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-11 11:34:26,191 - DEBUG - üîó Foreign keys for systems: []
2025-11-11 11:34:26,195 - DEBUG - üîó Foreign keys for users: []
2025-11-11 11:34:26,195 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-11 11:34:26,195 - DEBUG - üîç Relationship Details:
2025-11-11 11:34:26,196 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,196 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-11 11:34:26,196 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,196 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,196 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,196 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-11 11:34:26,196 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,196 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-11 11:34:26,196 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,196 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-11 11:34:26,196 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-11 11:34:26,196 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-11 11:34:26,196 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-11 11:34:26,196 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-11 11:34:26,197 - INFO - üìå Loaded conversation memory from disk.
2025-11-11 11:34:26,197 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-11 11:34:26,857 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:34:26,873 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-11 11:34:26,874 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-11 11:34:26,887 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-11 11:34:26,891 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-11 11:34:26,894 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-11 11:34:26,897 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-11 11:34:26,900 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-11 11:34:26,902 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-11 11:34:26,905 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-11 11:34:26,907 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-11 11:34:26,910 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-11 11:34:26,913 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-11 11:34:26,916 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-11 11:34:26,919 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-11 11:34:26,921 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-11 11:34:26,924 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-11 11:34:26,930 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-11 11:34:26,935 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:34:26,935 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-11 11:34:26,939 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-11 11:34:26,939 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-11 11:34:26,943 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:34:26,943 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-11 11:34:26,947 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:34:26,947 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-11 11:34:26,952 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:34:26,952 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-11 11:34:26,956 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-11 11:34:26,956 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-11 11:34:26,960 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-11 11:34:26,960 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-11 11:34:26,960 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-11 11:34:26,965 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-11 11:34:26,965 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-11 11:34:26,965 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-11 11:34:26,969 - DEBUG - üîó Foreign keys for ships: []
2025-11-11 11:34:26,974 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-11 11:34:26,974 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-11 11:34:26,974 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-11 11:34:26,974 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-11 11:34:26,974 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-11 11:34:26,978 - DEBUG - üîó Foreign keys for systems: []
2025-11-11 11:34:26,982 - DEBUG - üîó Foreign keys for users: []
2025-11-11 11:34:26,982 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-11 11:34:26,982 - DEBUG - üîç Relationship Details:
2025-11-11 11:34:26,982 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,982 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-11 11:34:26,982 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,982 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,983 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,983 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-11 11:34:26,983 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,983 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-11 11:34:26,983 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-11 11:34:26,983 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-11 11:34:26,983 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-11 11:34:26,983 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-11 11:34:26,983 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-11 11:34:26,983 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-11 11:34:39,110 - INFO - Database engine created with pool_size=10
2025-11-11 11:34:39,111 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-11 11:34:39,111 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-11 11:34:39,142 - INFO - SQLModel query returned 53 rows
2025-11-11 11:34:39,142 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-11 11:34:39,142 - DEBUG - Starting to process and group results
2025-11-11 11:34:39,142 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 11:34:39,143 - DEBUG - Creating new command group: Western Naval Command
2025-11-11 11:34:39,143 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 11:34:39,143 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-11 11:34:39,143 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-11 11:34:39,143 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-11 11:34:39,143 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 11:34:39,143 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-11 11:34:39,143 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-11 11:34:39,143 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-11 11:34:39,143 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-11 11:34:39,143 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-11 11:34:39,143 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 11:34:39,144 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-11 11:34:39,144 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-11 11:34:39,144 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-11 11:34:39,144 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-11 11:34:39,144 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-11 11:34:39,144 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-11 11:34:39,144 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-11 11:34:39,144 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-11 11:34:39,144 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-11 11:34:39,144 - INFO - Processed 3 unique ships into 1 command groups
2025-11-11 11:34:39,144 - DEBUG - Converting to final data structure
2025-11-11 11:34:39,144 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-11 11:34:39,144 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-11 11:34:39,145 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-11 11:34:39,145 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-11 11:34:39,145 - DEBUG - Command groups: ['Western Naval Command']
2025-11-11 11:34:39,145 - INFO - Successfully retrieved hierarchical ship data
2025-11-11 11:38:02,395 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:38:02,412 - INFO - üìå User authenticated: {'role': 'Admin/ INSMA', 'user_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'username': 'jake'}
2025-11-11 11:38:02,413 - INFO - üì® Chat request: what is the reliability of...
2025-11-11 11:38:02,413 - INFO - üöÄ Creating ChatOrchestrator instance...
2025-11-11 11:38:02,486 - DEBUG - Starting new HTTP connection (1): localhost:11434
2025-11-11 11:38:02,487 - DEBUG - http://localhost:11434 "GET /api/tags HTTP/1.1" 200 1373
2025-11-11 11:38:02,488 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:38:02,504 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-11 11:38:02,504 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:38:02,519 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:38:02,533 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-11 11:38:02,534 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-11 11:38:02,546 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-11 11:38:02,551 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-11 11:38:02,553 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-11 11:38:02,556 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-11 11:38:02,558 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-11 11:38:02,561 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-11 11:38:02,563 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-11 11:38:02,566 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-11 11:38:02,568 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-11 11:38:02,571 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-11 11:38:02,574 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-11 11:38:02,577 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-11 11:38:02,579 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-11 11:38:02,582 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-11 11:38:02,587 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-11 11:38:02,591 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:38:02,591 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-11 11:38:02,595 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-11 11:38:02,595 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-11 11:38:02,599 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:38:02,599 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-11 11:38:02,603 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:38:02,603 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-11 11:38:02,607 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-11 11:38:02,607 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-11 11:38:02,611 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-11 11:38:02,611 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-11 11:38:02,615 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-11 11:38:02,616 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-11 11:38:02,616 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-11 11:38:02,620 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-11 11:38:02,620 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-11 11:38:02,620 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-11 11:38:02,624 - DEBUG - üîó Foreign keys for ships: []
2025-11-11 11:38:02,628 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-11 11:38:02,628 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-11 11:38:02,628 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-11 11:38:02,628 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-11 11:38:02,628 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-11 11:38:02,632 - DEBUG - üîó Foreign keys for systems: []
2025-11-11 11:38:02,636 - DEBUG - üîó Foreign keys for users: []
2025-11-11 11:38:02,636 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-11 11:38:02,637 - DEBUG - üîç Relationship Details:
2025-11-11 11:38:02,637 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:38:02,637 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-11 11:38:02,637 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-11 11:38:02,637 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-11 11:38:02,637 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-11 11:38:02,637 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-11 11:38:02,637 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-11 11:38:02,637 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-11 11:38:02,637 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-11 11:38:02,637 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-11 11:38:02,637 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-11 11:38:02,637 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-11 11:38:02,637 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-11 11:38:02,637 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-11 11:38:02,638 - INFO - üìå Loaded conversation memory from disk.
2025-11-11 11:38:02,638 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-11 11:38:02,638 - INFO - ‚úÖ ChatOrchestrator instance created successfully!
2025-11-11 11:38:02,638 - INFO - ‚úÖ Got ChatOrchestrator
2025-11-11 11:38:04,250 - INFO - ‚úÖ Got response from ChatOrchestrator - Intent: RELIABILITY
2025-11-11 11:38:24,573 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 11:38:24,588 - INFO - üìå User authenticated: {'role': 'Admin/ INSMA', 'user_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'username': 'jake'}
2025-11-11 11:38:24,588 - INFO - üì® Chat request: what is the reliability of gt 1 on ins one over 48...
2025-11-11 11:38:24,588 - INFO - ‚úÖ Got ChatOrchestrator
2025-11-11 11:38:24,618 - DEBUG - connect_tcp.started host='localhost' port=11434 local_address=None timeout=60.0 socket_options=None
2025-11-11 11:38:24,619 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7591c235f550>
2025-11-11 11:38:24,619 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-11-11 11:38:24,619 - DEBUG - send_request_headers.complete
2025-11-11 11:38:24,619 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-11-11 11:38:24,620 - DEBUG - send_request_body.complete
2025-11-11 11:38:24,620 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-11-11 11:39:24,622 - DEBUG - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-11-11 11:39:24,622 - DEBUG - response_closed.started
2025-11-11 11:39:24,622 - DEBUG - response_closed.complete
2025-11-11 11:39:24,623 - INFO - ‚úÖ Got response from ChatOrchestrator - Intent: RELIABILITY
2025-11-11 11:39:42,335 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-11 11:39:42,335 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-11 11:39:42,648 - INFO - SQLModel query returned 53 rows
2025-11-11 11:39:42,648 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-11 11:39:42,648 - DEBUG - Starting to process and group results
2025-11-11 11:39:42,648 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 11:39:42,648 - DEBUG - Creating new command group: Western Naval Command
2025-11-11 11:39:42,648 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-11 11:39:42,649 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-11 11:39:42,649 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-11 11:39:42,649 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 11:39:42,649 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-11 11:39:42,649 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-11 11:39:42,649 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-11 11:39:42,649 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-11 11:39:42,649 - INFO - Processed 3 unique ships into 1 command groups
2025-11-11 11:39:42,650 - DEBUG - Converting to final data structure
2025-11-11 11:39:42,650 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-11 11:39:42,650 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-11 11:39:42,650 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-11 11:39:42,650 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-11 11:39:42,650 - DEBUG - Command groups: ['Western Naval Command']
2025-11-11 11:39:42,650 - INFO - Successfully retrieved hierarchical ship data
2025-11-11 13:25:46,791 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-11 13:25:46,791 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-11 13:25:46,893 - INFO - SQLModel query returned 53 rows
2025-11-11 13:25:46,893 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-11 13:25:46,893 - DEBUG - Starting to process and group results
2025-11-11 13:25:46,893 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 13:25:46,893 - DEBUG - Creating new command group: Western Naval Command
2025-11-11 13:25:46,893 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 13:25:46,893 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-11 13:25:46,893 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-11 13:25:46,893 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-11 13:25:46,893 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 13:25:46,893 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-11 13:25:46,893 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-11 13:25:46,893 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-11 13:25:46,893 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-11 13:25:46,893 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-11 13:25:46,893 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 13:25:46,894 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-11 13:25:46,894 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-11 13:25:46,894 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-11 13:25:46,894 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-11 13:25:46,894 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-11 13:25:46,894 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-11 13:25:46,894 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-11 13:25:46,894 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-11 13:25:46,894 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-11 13:25:46,894 - INFO - Processed 3 unique ships into 1 command groups
2025-11-11 13:25:46,894 - DEBUG - Converting to final data structure
2025-11-11 13:25:46,894 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-11 13:25:46,894 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-11 13:25:46,894 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-11 13:25:46,894 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-11 13:25:46,894 - DEBUG - Command groups: ['Western Naval Command']
2025-11-11 13:25:46,954 - INFO - Successfully retrieved hierarchical ship data
2025-11-11 14:17:59,266 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-11 14:17:59,309 - INFO - üìå User authenticated: {'role': 'Admin/ INSMA', 'user_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'username': 'jake'}
2025-11-11 14:17:59,309 - INFO - üì® Chat request: what is the reliability of gt 1 on ins one over 48...
2025-11-11 14:17:59,309 - INFO - ‚úÖ Got ChatOrchestrator
2025-11-11 14:17:59,450 - DEBUG - connect_tcp.started host='localhost' port=11434 local_address=None timeout=60.0 socket_options=None
2025-11-11 14:17:59,451 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7591ba9b4290>
2025-11-11 14:17:59,451 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-11-11 14:17:59,451 - DEBUG - send_request_headers.complete
2025-11-11 14:17:59,451 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-11-11 14:17:59,451 - DEBUG - send_request_body.complete
2025-11-11 14:17:59,452 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-11-11 14:18:45,577 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 11 Nov 2025 08:48:45 GMT'), (b'Content-Length', b'538')])
2025-11-11 14:18:45,578 - INFO - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-11-11 14:18:45,578 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-11-11 14:18:45,578 - DEBUG - receive_response_body.complete
2025-11-11 14:18:45,578 - DEBUG - response_closed.started
2025-11-11 14:18:45,578 - DEBUG - response_closed.complete
2025-11-11 14:18:45,579 - DEBUG - close.started
2025-11-11 14:18:45,579 - DEBUG - close.complete
2025-11-11 14:18:45,582 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-11 14:18:45,583 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-11 14:18:45,584 - INFO - SQLModel query returned 53 rows
2025-11-11 14:18:45,585 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-11 14:18:45,585 - DEBUG - Starting to process and group results
2025-11-11 14:18:45,585 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 14:18:45,585 - DEBUG - Creating new command group: Western Naval Command
2025-11-11 14:18:45,585 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 14:18:45,585 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-11 14:18:45,585 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-11 14:18:45,585 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-11 14:18:45,585 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 14:18:45,585 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-11 14:18:45,585 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-11 14:18:45,585 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-11 14:18:45,585 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-11 14:18:45,585 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-11 14:18:45,586 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 14:18:45,586 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-11 14:18:45,586 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-11 14:18:45,586 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-11 14:18:45,586 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-11 14:18:45,586 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-11 14:18:45,586 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-11 14:18:45,586 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-11 14:18:45,586 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-11 14:18:45,586 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-11 14:18:45,586 - INFO - Processed 3 unique ships into 1 command groups
2025-11-11 14:18:45,587 - DEBUG - Converting to final data structure
2025-11-11 14:18:45,587 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-11 14:18:45,587 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-11 14:18:45,587 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-11 14:18:45,587 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-11 14:18:45,587 - DEBUG - Command groups: ['Western Naval Command']
2025-11-11 14:18:45,587 - INFO - Successfully retrieved hierarchical ship data
2025-11-11 14:18:45,626 - INFO - ‚úÖ Got response from ChatOrchestrator - Intent: RELIABILITY
2025-11-11 14:35:27,567 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-11 14:35:27,568 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-11 14:35:27,725 - INFO - SQLModel query returned 53 rows
2025-11-11 14:35:27,725 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-11 14:35:27,725 - DEBUG - Starting to process and group results
2025-11-11 14:35:27,725 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 14:35:27,725 - DEBUG - Creating new command group: Western Naval Command
2025-11-11 14:35:27,725 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 14:35:27,725 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-11 14:35:27,725 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-11 14:35:27,725 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-11 14:35:27,726 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 14:35:27,726 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-11 14:35:27,726 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-11 14:35:27,726 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-11 14:35:27,726 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-11 14:35:27,726 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-11 14:35:27,726 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 14:35:27,726 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-11 14:35:27,726 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-11 14:35:27,726 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-11 14:35:27,726 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-11 14:35:27,726 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-11 14:35:27,727 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-11 14:35:27,727 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-11 14:35:27,727 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-11 14:35:27,727 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-11 14:35:27,727 - INFO - Processed 3 unique ships into 1 command groups
2025-11-11 14:35:27,727 - DEBUG - Converting to final data structure
2025-11-11 14:35:27,727 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-11 14:35:27,727 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-11 14:35:27,727 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-11 14:35:27,727 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-11 14:35:27,727 - DEBUG - Command groups: ['Western Naval Command']
2025-11-11 14:35:27,756 - INFO - Successfully retrieved hierarchical ship data
2025-11-11 14:38:06,595 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-11 14:38:06,596 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-11 14:38:06,598 - INFO - SQLModel query returned 53 rows
2025-11-11 14:38:06,598 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-11 14:38:06,598 - DEBUG - Starting to process and group results
2025-11-11 14:38:06,598 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 14:38:06,598 - DEBUG - Creating new command group: Western Naval Command
2025-11-11 14:38:06,598 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 14:38:06,598 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-11 14:38:06,598 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-11 14:38:06,598 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-11 14:38:06,598 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 14:38:06,598 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-11 14:38:06,598 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-11 14:38:06,598 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-11 14:38:06,598 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-11 14:38:06,598 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-11 14:38:06,598 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 14:38:06,598 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-11 14:38:06,598 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-11 14:38:06,598 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-11 14:38:06,599 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-11 14:38:06,599 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-11 14:38:06,599 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-11 14:38:06,599 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-11 14:38:06,599 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-11 14:38:06,599 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-11 14:38:06,599 - INFO - Processed 3 unique ships into 1 command groups
2025-11-11 14:38:06,599 - DEBUG - Converting to final data structure
2025-11-11 14:38:06,599 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-11 14:38:06,599 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-11 14:38:06,599 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-11 14:38:06,599 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-11 14:38:06,599 - DEBUG - Command groups: ['Western Naval Command']
2025-11-11 14:38:06,599 - INFO - Successfully retrieved hierarchical ship data
2025-11-11 14:46:42,036 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-11 14:46:42,036 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-11 14:46:42,044 - INFO - SQLModel query returned 53 rows
2025-11-11 14:46:42,044 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-11 14:46:42,044 - DEBUG - Starting to process and group results
2025-11-11 14:46:42,044 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 14:46:42,044 - DEBUG - Creating new command group: Western Naval Command
2025-11-11 14:46:42,044 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 14:46:42,044 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-11 14:46:42,044 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-11 14:46:42,045 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-11 14:46:42,045 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-11 14:46:42,045 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-11 14:46:42,045 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-11 14:46:42,045 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-11 14:46:42,045 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-11 14:46:42,045 - INFO - Processed 3 unique ships into 1 command groups
2025-11-11 14:46:42,045 - DEBUG - Converting to final data structure
2025-11-11 14:46:42,045 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-11 14:46:42,046 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-11 14:46:42,046 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-11 14:46:42,046 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-11 14:46:42,046 - DEBUG - Command groups: ['Western Naval Command']
2025-11-11 14:46:42,046 - INFO - Successfully retrieved hierarchical ship data
2025-11-12 12:56:37,253 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-12 12:56:37,253 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-12 12:56:37,253 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-12 12:56:37,696 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-12 12:56:38,877 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-12 12:56:38,956 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-12 12:56:38,956 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-12 12:56:38,975 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-12 12:56:38,991 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-12 12:56:39,063 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-12 12:56:39,590 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-12 12:56:39,596 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-12 12:56:39,599 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-12 12:56:39,601 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-12 12:56:39,604 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-12 12:56:39,607 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-12 12:56:39,610 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-12 12:56:39,612 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-12 12:56:39,616 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-12 12:56:39,618 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-12 12:56:39,621 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-12 12:56:39,625 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-12 12:56:39,627 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-12 12:56:39,630 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-12 12:56:39,636 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-12 12:56:39,641 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 12:56:39,641 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-12 12:56:39,645 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-12 12:56:39,645 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-12 12:56:39,649 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 12:56:39,649 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-12 12:56:39,653 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 12:56:39,653 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-12 12:56:39,658 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 12:56:39,658 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-12 12:56:39,662 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-12 12:56:39,662 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-12 12:56:39,666 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-12 12:56:39,666 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-12 12:56:39,666 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-12 12:56:39,670 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-12 12:56:39,670 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-12 12:56:39,670 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-12 12:56:39,674 - DEBUG - üîó Foreign keys for ships: []
2025-11-12 12:56:39,679 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-12 12:56:39,679 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-12 12:56:39,679 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-12 12:56:39,679 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-12 12:56:39,679 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-12 12:56:39,683 - DEBUG - üîó Foreign keys for systems: []
2025-11-12 12:56:39,687 - DEBUG - üîó Foreign keys for users: []
2025-11-12 12:56:39,688 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-12 12:56:39,688 - DEBUG - üîç Relationship Details:
2025-11-12 12:56:39,688 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-12 12:56:39,688 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-12 12:56:39,688 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-12 12:56:39,688 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-12 12:56:39,688 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-12 12:56:39,688 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-12 12:56:39,688 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-12 12:56:39,688 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-12 12:56:39,688 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-12 12:56:39,688 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-12 12:56:39,688 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-12 12:56:39,688 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-12 12:56:39,688 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-12 12:56:39,688 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-12 12:56:39,707 - INFO - üìå Loaded conversation memory from disk.
2025-11-12 12:56:39,707 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-12 12:56:46,525 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-12 12:56:46,541 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-12 12:56:46,541 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-12 12:56:46,554 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-12 12:56:46,559 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-12 12:56:46,562 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-12 12:56:46,565 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-12 12:56:46,568 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-12 12:56:46,571 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-12 12:56:46,574 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-12 12:56:46,577 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-12 12:56:46,580 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-12 12:56:46,583 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-12 12:56:46,586 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-12 12:56:46,589 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-12 12:56:46,592 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-12 12:56:46,595 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-12 12:56:46,600 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-12 12:56:46,605 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 12:56:46,605 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-12 12:56:46,609 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-12 12:56:46,609 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-12 12:56:46,613 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 12:56:46,613 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-12 12:56:46,617 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 12:56:46,617 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-12 12:56:46,622 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 12:56:46,622 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-12 12:56:46,626 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-12 12:56:46,626 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-12 12:56:46,631 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-12 12:56:46,631 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-12 12:56:46,631 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-12 12:56:46,635 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-12 12:56:46,635 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-12 12:56:46,635 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-12 12:56:46,640 - DEBUG - üîó Foreign keys for ships: []
2025-11-12 12:56:46,644 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-12 12:56:46,644 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-12 12:56:46,644 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-12 12:56:46,645 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-12 12:56:46,645 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-12 12:56:46,649 - DEBUG - üîó Foreign keys for systems: []
2025-11-12 12:56:46,653 - DEBUG - üîó Foreign keys for users: []
2025-11-12 12:56:46,653 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-12 12:56:46,653 - DEBUG - üîç Relationship Details:
2025-11-12 12:56:46,653 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-12 12:56:46,653 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-12 12:56:46,654 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-12 12:56:46,654 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-12 12:56:46,654 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-12 12:56:46,654 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-12 12:56:46,654 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-12 12:56:46,654 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-12 12:56:46,654 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-12 12:56:46,654 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-12 12:56:46,654 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-12 12:56:46,654 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-12 12:56:46,654 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-12 12:56:46,654 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-12 13:01:32,675 - INFO - Database engine created with pool_size=10
2025-11-12 13:01:32,675 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-12 13:01:32,676 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-12 13:01:32,800 - INFO - SQLModel query returned 53 rows
2025-11-12 13:01:32,800 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-12 13:01:32,800 - DEBUG - Starting to process and group results
2025-11-12 13:01:32,800 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-12 13:01:32,800 - DEBUG - Creating new command group: Western Naval Command
2025-11-12 13:01:32,800 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-12 13:01:32,800 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-12 13:01:32,801 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-12 13:01:32,801 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-12 13:01:32,801 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-12 13:01:32,801 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-12 13:01:32,801 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-12 13:01:32,801 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-12 13:01:32,801 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-12 13:01:32,801 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-12 13:01:32,801 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-12 13:01:32,801 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-12 13:01:32,801 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-12 13:01:32,801 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-12 13:01:32,802 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-12 13:01:32,802 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-12 13:01:32,802 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-12 13:01:32,802 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-12 13:01:32,802 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-12 13:01:32,802 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-12 13:01:32,802 - INFO - Processed 3 unique ships into 1 command groups
2025-11-12 13:01:32,802 - DEBUG - Converting to final data structure
2025-11-12 13:01:32,802 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-12 13:01:32,802 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-12 13:01:32,802 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-12 13:01:32,803 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-12 13:01:32,803 - DEBUG - Command groups: ['Western Naval Command']
2025-11-12 13:01:32,803 - INFO - Successfully retrieved hierarchical ship data
2025-11-12 20:58:28,247 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-12 20:58:28,247 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-12 20:58:28,247 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-12 20:58:28,832 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-12 20:58:29,293 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-12 20:58:29,308 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-12 20:58:29,308 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-12 20:58:29,324 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-12 20:58:29,339 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-12 20:58:29,354 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-12 20:58:29,525 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-12 20:58:29,531 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-12 20:58:29,534 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-12 20:58:29,536 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-12 20:58:29,539 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-12 20:58:29,541 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-12 20:58:29,544 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-12 20:58:29,547 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-12 20:58:29,550 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-12 20:58:29,553 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-12 20:58:29,555 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-12 20:58:29,558 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-12 20:58:29,561 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-12 20:58:29,564 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-12 20:58:29,569 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-12 20:58:29,573 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 20:58:29,573 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-12 20:58:29,577 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-12 20:58:29,577 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-12 20:58:29,581 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 20:58:29,581 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-12 20:58:29,585 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 20:58:29,586 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-12 20:58:29,589 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 20:58:29,590 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-12 20:58:29,594 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-12 20:58:29,594 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-12 20:58:29,598 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-12 20:58:29,598 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-12 20:58:29,598 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-12 20:58:29,602 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-12 20:58:29,602 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-12 20:58:29,602 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-12 20:58:29,606 - DEBUG - üîó Foreign keys for ships: []
2025-11-12 20:58:29,611 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-12 20:58:29,611 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-12 20:58:29,611 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-12 20:58:29,611 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-12 20:58:29,611 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-12 20:58:29,615 - DEBUG - üîó Foreign keys for systems: []
2025-11-12 20:58:29,619 - DEBUG - üîó Foreign keys for users: []
2025-11-12 20:58:29,619 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-12 20:58:29,619 - DEBUG - üîç Relationship Details:
2025-11-12 20:58:29,619 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-12 20:58:29,619 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-12 20:58:29,619 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-12 20:58:29,619 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-12 20:58:29,619 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-12 20:58:29,619 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-12 20:58:29,619 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-12 20:58:29,619 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-12 20:58:29,619 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-12 20:58:29,619 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-12 20:58:29,619 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-12 20:58:29,620 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-12 20:58:29,620 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-12 20:58:29,620 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-12 20:58:29,648 - INFO - üìå Loaded conversation memory from disk.
2025-11-12 20:58:29,648 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-12 20:58:31,188 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-12 20:58:31,203 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-12 20:58:31,204 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-12 20:58:31,218 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-12 20:58:31,223 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-12 20:58:31,226 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-12 20:58:31,229 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-12 20:58:31,232 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-12 20:58:31,235 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-12 20:58:31,238 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-12 20:58:31,242 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-12 20:58:31,244 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-12 20:58:31,247 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-12 20:58:31,250 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-12 20:58:31,254 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-12 20:58:31,257 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-12 20:58:31,260 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-12 20:58:31,266 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-12 20:58:31,270 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 20:58:31,271 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-12 20:58:31,275 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-12 20:58:31,275 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-12 20:58:31,279 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 20:58:31,279 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-12 20:58:31,283 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 20:58:31,284 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-12 20:58:31,288 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-12 20:58:31,288 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-12 20:58:31,292 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-12 20:58:31,292 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-12 20:58:31,296 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-12 20:58:31,296 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-12 20:58:31,296 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-12 20:58:31,301 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-12 20:58:31,301 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-12 20:58:31,301 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-12 20:58:31,305 - DEBUG - üîó Foreign keys for ships: []
2025-11-12 20:58:31,309 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-12 20:58:31,310 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-12 20:58:31,310 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-12 20:58:31,310 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-12 20:58:31,310 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-12 20:58:31,314 - DEBUG - üîó Foreign keys for systems: []
2025-11-12 20:58:31,318 - DEBUG - üîó Foreign keys for users: []
2025-11-12 20:58:31,318 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-12 20:58:31,318 - DEBUG - üîç Relationship Details:
2025-11-12 20:58:31,318 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-12 20:58:31,318 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-12 20:58:31,318 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-12 20:58:31,318 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-12 20:58:31,318 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-12 20:58:31,318 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-12 20:58:31,319 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-12 20:58:31,319 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-12 20:58:31,319 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-12 20:58:31,319 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-12 20:58:31,319 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-12 20:58:31,319 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-12 20:58:31,319 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-12 20:58:31,319 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-12 20:59:31,883 - INFO - Database engine created with pool_size=10
2025-11-12 20:59:31,884 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-12 20:59:31,884 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-12 20:59:31,916 - INFO - SQLModel query returned 53 rows
2025-11-12 20:59:31,917 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-12 20:59:31,917 - DEBUG - Starting to process and group results
2025-11-12 20:59:31,917 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-12 20:59:31,917 - DEBUG - Creating new command group: Western Naval Command
2025-11-12 20:59:31,917 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-12 20:59:31,917 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-12 20:59:31,917 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-12 20:59:31,917 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-12 20:59:31,917 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-12 20:59:31,917 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-12 20:59:31,917 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-12 20:59:31,917 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-12 20:59:31,918 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-12 20:59:31,918 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-12 20:59:31,918 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-12 20:59:31,919 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-12 20:59:31,919 - INFO - Processed 3 unique ships into 1 command groups
2025-11-12 20:59:31,919 - DEBUG - Converting to final data structure
2025-11-12 20:59:31,919 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-12 20:59:31,919 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-12 20:59:31,919 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-12 20:59:31,919 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-12 20:59:31,919 - DEBUG - Command groups: ['Western Naval Command']
2025-11-12 20:59:31,920 - INFO - Successfully retrieved hierarchical ship data
2025-11-12 21:00:20,296 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-12 21:00:20,297 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-12 21:00:20,299 - INFO - SQLModel query returned 53 rows
2025-11-12 21:00:20,299 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-12 21:00:20,299 - DEBUG - Starting to process and group results
2025-11-12 21:00:20,299 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-12 21:00:20,299 - DEBUG - Creating new command group: Western Naval Command
2025-11-12 21:00:20,299 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-12 21:00:20,299 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-12 21:00:20,299 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-12 21:00:20,299 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-12 21:00:20,299 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-12 21:00:20,299 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-12 21:00:20,299 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-12 21:00:20,300 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-12 21:00:20,300 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-12 21:00:20,300 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-12 21:00:20,300 - INFO - Processed 3 unique ships into 1 command groups
2025-11-12 21:00:20,300 - DEBUG - Converting to final data structure
2025-11-12 21:00:20,300 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-12 21:00:20,300 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-12 21:00:20,300 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-12 21:00:20,300 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-12 21:00:20,301 - DEBUG - Command groups: ['Western Naval Command']
2025-11-12 21:00:20,301 - INFO - Successfully retrieved hierarchical ship data
2025-11-12 21:00:28,924 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-12 21:00:28,924 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-12 21:00:28,926 - INFO - SQLModel query returned 53 rows
2025-11-12 21:00:28,926 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-12 21:00:28,926 - DEBUG - Starting to process and group results
2025-11-12 21:00:28,926 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-12 21:00:28,926 - DEBUG - Creating new command group: Western Naval Command
2025-11-12 21:00:28,926 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-12 21:00:28,926 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-12 21:00:28,927 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-12 21:00:28,927 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-12 21:00:28,927 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-12 21:00:28,927 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-12 21:00:28,927 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-12 21:00:28,927 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-12 21:00:28,927 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-12 21:00:28,927 - INFO - Processed 3 unique ships into 1 command groups
2025-11-12 21:00:28,928 - DEBUG - Converting to final data structure
2025-11-12 21:00:28,928 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-12 21:00:28,928 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-12 21:00:28,928 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-12 21:00:28,928 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-12 21:00:28,928 - DEBUG - Command groups: ['Western Naval Command']
2025-11-12 21:00:28,928 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 11:27:58,820 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:27:58,820 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:27:58,820 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:27:58,986 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:27:59,214 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:27:59,230 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:27:59,230 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:27:59,245 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:27:59,259 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:27:59,268 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:27:59,681 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:27:59,687 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:27:59,690 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:27:59,693 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:27:59,696 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:27:59,699 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:27:59,702 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:27:59,705 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:27:59,708 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:27:59,711 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:27:59,714 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:27:59,717 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:27:59,720 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:27:59,723 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:27:59,729 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:27:59,734 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:27:59,734 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:27:59,739 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:27:59,739 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:27:59,748 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:27:59,748 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:27:59,752 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:27:59,752 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:27:59,756 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:27:59,757 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:27:59,761 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:27:59,761 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:27:59,765 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:27:59,765 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:27:59,765 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:27:59,770 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:27:59,770 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:27:59,770 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:27:59,774 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:27:59,778 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:27:59,779 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:27:59,779 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:27:59,779 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:27:59,779 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:27:59,783 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:27:59,787 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:27:59,787 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:27:59,788 - DEBUG - üîç Relationship Details:
2025-11-13 11:27:59,788 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:27:59,788 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:27:59,788 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:27:59,788 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:27:59,788 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:27:59,788 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:27:59,788 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:27:59,788 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:27:59,788 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:27:59,788 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:27:59,788 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:27:59,788 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:27:59,788 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:27:59,789 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:27:59,790 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:27:59,790 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:28:00,443 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:28:00,460 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:28:00,461 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:28:00,477 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:28:00,482 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:28:00,484 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:28:00,487 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:28:00,492 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:28:00,495 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:28:00,497 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:28:00,500 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:28:00,503 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:28:00,506 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:28:00,508 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:28:00,511 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:28:00,514 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:28:00,517 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:28:00,532 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:28:00,536 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:28:00,536 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:28:00,541 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:28:00,541 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:28:00,545 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:28:00,545 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:28:00,549 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:28:00,549 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:28:00,554 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:28:00,554 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:28:00,558 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:28:00,558 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:28:00,562 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:28:00,562 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:28:00,562 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:28:00,566 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:28:00,566 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:28:00,566 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:28:00,570 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:28:00,575 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:28:00,575 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:28:00,575 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:28:00,575 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:28:00,575 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:28:00,579 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:28:00,583 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:28:00,584 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:28:00,584 - DEBUG - üîç Relationship Details:
2025-11-13 11:28:00,584 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:28:00,584 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:28:00,584 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:28:00,584 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:28:00,584 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:28:00,584 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:28:00,584 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:28:00,584 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:28:00,584 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:28:00,584 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:28:00,584 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:28:00,584 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:28:00,584 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:28:00,584 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:28:34,143 - INFO - Database engine created with pool_size=10
2025-11-13 11:28:34,143 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 11:28:34,144 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 11:28:34,176 - INFO - SQLModel query returned 53 rows
2025-11-13 11:28:34,176 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 11:28:34,176 - DEBUG - Starting to process and group results
2025-11-13 11:28:34,176 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 11:28:34,176 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 11:28:34,176 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 11:28:34,177 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 11:28:34,177 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 11:28:34,177 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 11:28:34,177 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 11:28:34,177 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 11:28:34,177 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 11:28:34,177 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 11:28:34,178 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 11:28:34,178 - DEBUG - Converting to final data structure
2025-11-13 11:28:34,178 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 11:28:34,178 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 11:28:34,178 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 11:28:34,178 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 11:28:34,178 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 11:28:34,178 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 11:43:28,454 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:43:28,454 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:43:28,454 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:43:28,942 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:43:29,714 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:43:29,741 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:43:29,741 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:43:29,757 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:43:29,773 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:43:29,812 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:43:30,302 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:43:30,308 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:43:30,311 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:43:30,314 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:43:30,317 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:43:30,320 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:43:30,323 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:43:30,326 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:43:30,329 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:43:30,332 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:43:30,335 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:43:30,338 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:43:30,341 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:43:30,344 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:43:30,350 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:43:30,355 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:43:30,356 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:43:30,360 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:43:30,360 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:43:30,365 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:43:30,365 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:43:30,369 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:43:30,369 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:43:30,374 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:43:30,374 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:43:30,378 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:43:30,378 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:43:30,382 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:43:30,382 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:43:30,382 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:43:30,386 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:43:30,386 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:43:30,386 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:43:30,390 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:43:30,395 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:43:30,395 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:43:30,395 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:43:30,395 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:43:30,395 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:43:30,400 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:43:30,404 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:43:30,404 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:43:30,404 - DEBUG - üîç Relationship Details:
2025-11-13 11:43:30,404 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:43:30,404 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:43:30,404 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:43:30,405 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:43:30,405 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:43:30,405 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:43:30,405 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:43:30,405 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:43:30,405 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:43:30,405 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:43:30,405 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:43:30,405 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:43:30,405 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:43:30,405 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:43:30,502 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:43:30,503 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:43:36,027 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:43:36,042 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:43:36,043 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:43:36,056 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:43:36,061 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:43:36,063 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:43:36,066 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:43:36,070 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:43:36,073 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:43:36,075 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:43:36,078 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:43:36,081 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:43:36,084 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:43:36,086 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:43:36,089 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:43:36,092 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:43:36,095 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:43:36,100 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:43:36,104 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:43:36,105 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:43:36,109 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:43:36,109 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:43:36,114 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:43:36,114 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:43:36,119 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:43:36,119 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:43:36,124 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:43:36,124 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:43:36,129 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:43:36,129 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:43:36,133 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:43:36,134 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:43:36,134 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:43:36,138 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:43:36,138 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:43:36,138 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:43:36,143 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:43:36,147 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:43:36,147 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:43:36,148 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:43:36,148 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:43:36,148 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:43:36,152 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:43:36,157 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:43:36,157 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:43:36,157 - DEBUG - üîç Relationship Details:
2025-11-13 11:43:36,158 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:43:36,158 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:43:36,158 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:43:36,158 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:43:36,158 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:43:36,158 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:43:36,158 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:43:36,158 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:43:36,158 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:43:36,158 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:43:36,158 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:43:36,158 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:43:36,158 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:43:36,158 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:46:00,446 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:00,446 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:00,446 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:00,612 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:04,713 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:04,713 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:04,713 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:04,878 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:12,856 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:12,856 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:12,856 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:13,044 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:14,376 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:14,376 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:14,376 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:14,550 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:17,449 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:17,449 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:17,449 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:17,633 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:18,687 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:18,687 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:18,687 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:18,853 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:21,985 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:21,985 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:21,985 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:22,155 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:24,510 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:24,510 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:24,510 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:24,684 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:31,364 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:31,364 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:31,364 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:31,533 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:46:50,909 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:46:50,909 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:46:50,909 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:46:51,449 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:47:14,115 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:47:14,115 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:47:14,115 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:47:21,569 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:47:21,569 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:47:21,569 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:47:22,782 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:47:22,783 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:47:22,783 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:47:24,605 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:47:24,605 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:47:24,606 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:47:26,420 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:47:26,420 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:47:26,420 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:47:26,593 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:47:37,233 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:47:37,233 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:47:37,233 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:47:37,448 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:47:45,677 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:47:45,677 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:47:45,677 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:47:45,848 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:47:46,932 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:47:46,933 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:47:46,933 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:47:47,101 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:48:04,439 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:48:04,439 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:48:04,439 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:48:04,619 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:48:04,862 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:04,878 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:04,878 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:04,896 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:04,912 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:04,922 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:48:04,942 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:48:04,948 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:48:04,950 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:48:04,954 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:48:04,957 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:48:04,959 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:48:04,962 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:48:04,965 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:48:04,968 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:48:04,970 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:48:04,974 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:48:04,977 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:48:04,979 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:48:04,982 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:48:04,988 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:48:04,992 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:04,992 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:04,996 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:48:04,996 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:48:05,000 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:05,001 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:05,005 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:05,005 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:48:05,009 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:05,009 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:48:05,013 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:48:05,013 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:48:05,018 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:48:05,018 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:48:05,018 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:48:05,022 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:48:05,022 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:48:05,022 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:48:05,026 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:48:05,031 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:48:05,031 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:48:05,031 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:48:05,031 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:48:05,031 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:48:05,035 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:48:05,039 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:48:05,039 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:48:05,039 - DEBUG - üîç Relationship Details:
2025-11-13 11:48:05,039 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,039 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:48:05,040 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,040 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,040 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,040 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:48:05,040 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,040 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:48:05,040 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,040 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:48:05,040 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:48:05,040 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:48:05,040 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:48:05,040 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:48:05,040 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:48:05,040 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:48:05,691 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:05,706 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:05,706 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:48:05,719 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:48:05,723 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:48:05,725 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:48:05,728 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:48:05,731 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:48:05,733 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:48:05,736 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:48:05,738 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:48:05,741 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:48:05,744 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:48:05,747 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:48:05,750 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:48:05,752 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:48:05,755 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:48:05,760 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:48:05,765 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:05,765 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:05,769 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:48:05,769 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:48:05,773 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:05,773 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:05,777 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:05,777 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:48:05,782 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:05,782 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:48:05,787 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:48:05,787 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:48:05,791 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:48:05,791 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:48:05,791 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:48:05,796 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:48:05,796 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:48:05,796 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:48:05,800 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:48:05,804 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:48:05,804 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:48:05,804 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:48:05,804 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:48:05,804 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:48:05,808 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:48:05,812 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:48:05,812 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:48:05,813 - DEBUG - üîç Relationship Details:
2025-11-13 11:48:05,813 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,813 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:48:05,813 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,813 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,813 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,813 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:48:05,813 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,813 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:48:05,813 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:48:05,813 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:48:05,813 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:48:05,813 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:48:05,813 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:48:05,814 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:48:33,908 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:48:33,908 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:48:33,908 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:48:34,086 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:48:34,321 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:34,337 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:34,337 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:34,352 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:34,367 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:34,375 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:48:34,395 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:48:34,400 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:48:34,403 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:48:34,406 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:48:34,408 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:48:34,411 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:48:34,413 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:48:34,416 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:48:34,419 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:48:34,422 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:48:34,425 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:48:34,428 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:48:34,430 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:48:34,433 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:48:34,439 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:48:34,443 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:34,443 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:34,448 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:48:34,448 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:48:34,452 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:34,452 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:34,456 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:34,456 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:48:34,461 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:34,461 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:48:34,465 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:48:34,465 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:48:34,470 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:48:34,470 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:48:34,470 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:48:34,474 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:48:34,474 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:48:34,475 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:48:34,479 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:48:34,483 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:48:34,483 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:48:34,483 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:48:34,483 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:48:34,483 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:48:34,487 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:48:34,492 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:48:34,492 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:48:34,492 - DEBUG - üîç Relationship Details:
2025-11-13 11:48:34,492 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:34,492 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:48:34,492 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:34,492 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:48:34,492 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:48:34,492 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:48:34,492 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:48:34,493 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:48:34,493 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:48:34,493 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:48:34,493 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:48:34,493 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:48:34,493 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:48:34,493 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:48:34,494 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:48:34,494 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:48:35,152 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:35,167 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:35,168 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:48:35,180 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:48:35,184 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:48:35,187 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:48:35,190 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:48:35,192 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:48:35,195 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:48:35,197 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:48:35,200 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:48:35,203 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:48:35,205 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:48:35,209 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:48:35,212 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:48:35,214 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:48:35,218 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:48:35,223 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:48:35,227 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:35,227 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:35,232 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:48:35,232 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:48:35,236 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:35,236 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:35,240 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:35,240 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:48:35,245 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:35,245 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:48:35,250 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:48:35,250 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:48:35,254 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:48:35,254 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:48:35,254 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:48:35,258 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:48:35,258 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:48:35,258 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:48:35,263 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:48:35,267 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:48:35,267 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:48:35,267 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:48:35,267 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:48:35,267 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:48:35,271 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:48:35,275 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:48:35,275 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:48:35,275 - DEBUG - üîç Relationship Details:
2025-11-13 11:48:35,276 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:35,276 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:48:35,276 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:35,276 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:48:35,276 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:48:35,276 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:48:35,276 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:48:35,276 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:48:35,276 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:48:35,276 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:48:35,276 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:48:35,276 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:48:35,276 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:48:35,276 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:48:46,054 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:48:46,054 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:48:46,054 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:48:46,226 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:48:46,460 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:46,476 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:46,476 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:46,491 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:46,505 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:46,514 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:48:46,533 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:48:46,539 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:48:46,542 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:48:46,544 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:48:46,547 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:48:46,550 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:48:46,553 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:48:46,555 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:48:46,558 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:48:46,561 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:48:46,565 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:48:46,568 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:48:46,571 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:48:46,574 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:48:46,580 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:48:46,584 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:46,584 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:46,589 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:48:46,589 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:48:46,593 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:46,593 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:46,597 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:46,597 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:48:46,602 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:46,602 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:48:46,606 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:48:46,606 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:48:46,610 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:48:46,610 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:48:46,610 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:48:46,615 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:48:46,615 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:48:46,615 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:48:46,619 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:48:46,623 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:48:46,623 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:48:46,623 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:48:46,624 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:48:46,624 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:48:46,628 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:48:46,632 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:48:46,632 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:48:46,632 - DEBUG - üîç Relationship Details:
2025-11-13 11:48:46,632 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:46,632 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:48:46,632 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:46,632 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:48:46,632 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:48:46,632 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:48:46,633 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:48:46,633 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:48:46,633 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:48:46,633 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:48:46,633 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:48:46,633 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:48:46,633 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:48:46,633 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:48:46,634 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:48:46,634 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:48:47,288 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:47,303 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:47,304 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:48:47,316 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:48:47,321 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:48:47,324 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:48:47,328 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:48:47,331 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:48:47,334 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:48:47,336 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:48:47,339 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:48:47,342 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:48:47,344 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:48:47,347 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:48:47,350 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:48:47,352 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:48:47,355 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:48:47,360 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:48:47,363 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:47,364 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:47,368 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:48:47,368 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:48:47,372 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:47,372 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:47,376 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:47,376 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:48:47,381 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:47,381 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:48:47,385 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:48:47,385 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:48:47,389 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:48:47,389 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:48:47,389 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:48:47,393 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:48:47,393 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:48:47,394 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:48:47,398 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:48:47,402 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:48:47,402 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:48:47,402 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:48:47,402 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:48:47,402 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:48:47,407 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:48:47,411 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:48:47,411 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:48:47,411 - DEBUG - üîç Relationship Details:
2025-11-13 11:48:47,411 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:47,411 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:48:47,411 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:47,411 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:48:47,411 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:48:47,411 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:48:47,411 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:48:47,411 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:48:47,411 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:48:47,412 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:48:47,412 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:48:47,412 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:48:47,412 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:48:47,412 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:48:50,643 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:48:50,643 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:48:50,643 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:48:50,810 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:48:51,052 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:51,067 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:51,068 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:51,083 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:51,098 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:51,107 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:48:51,127 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:48:51,133 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:48:51,136 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:48:51,139 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:48:51,142 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:48:51,144 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:48:51,147 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:48:51,150 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:48:51,153 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:48:51,156 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:48:51,159 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:48:51,163 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:48:51,166 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:48:51,169 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:48:51,174 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:48:51,179 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:51,179 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:51,183 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:48:51,183 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:48:51,187 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:51,187 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:51,191 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:51,191 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:48:51,196 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:51,196 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:48:51,200 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:48:51,200 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:48:51,204 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:48:51,204 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:48:51,204 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:48:51,208 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:48:51,208 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:48:51,208 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:48:51,213 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:48:51,217 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:48:51,217 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:48:51,217 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:48:51,217 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:48:51,217 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:48:51,222 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:48:51,226 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:48:51,226 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:48:51,226 - DEBUG - üîç Relationship Details:
2025-11-13 11:48:51,226 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:51,226 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:48:51,226 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:51,226 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:48:51,226 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:48:51,226 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:48:51,226 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:48:51,226 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:48:51,227 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:48:51,227 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:48:51,227 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:48:51,227 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:48:51,227 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:48:51,227 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:48:51,227 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:48:51,227 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:48:51,907 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:48:51,923 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:48:51,924 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:48:51,941 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:48:51,947 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:48:51,951 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:48:51,955 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:48:51,959 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:48:51,962 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:48:51,966 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:48:51,969 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:48:51,972 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:48:51,975 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:48:51,977 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:48:51,980 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:48:51,983 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:48:51,986 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:48:51,992 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:48:51,996 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:51,996 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:52,001 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:48:52,001 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:48:52,005 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:52,005 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:48:52,009 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:52,009 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:48:52,014 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:48:52,014 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:48:52,018 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:48:52,018 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:48:52,022 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:48:52,022 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:48:52,022 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:48:52,026 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:48:52,026 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:48:52,026 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:48:52,031 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:48:52,035 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:48:52,035 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:48:52,035 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:48:52,035 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:48:52,035 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:48:52,039 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:48:52,043 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:48:52,043 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:48:52,043 - DEBUG - üîç Relationship Details:
2025-11-13 11:48:52,043 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:52,043 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:48:52,044 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:48:52,044 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:48:52,044 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:48:52,044 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:48:52,044 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:48:52,044 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:48:52,044 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:48:52,044 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:48:52,044 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:48:52,044 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:48:52,044 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:48:52,044 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:49:34,483 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:49:34,483 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:49:34,483 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:49:34,650 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:49:34,885 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:34,901 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:34,901 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:34,916 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:34,931 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:34,940 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:49:34,959 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:49:34,965 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:49:34,968 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:49:34,970 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:49:34,973 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:49:34,975 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:49:34,978 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:49:34,981 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:49:34,983 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:49:34,986 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:49:34,989 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:49:34,992 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:49:34,995 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:49:34,998 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:49:35,003 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:49:35,007 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:35,008 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:35,012 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:49:35,012 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:49:35,016 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:35,016 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:35,021 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:35,021 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:49:35,025 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:35,025 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:49:35,029 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:49:35,029 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:49:35,033 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:49:35,033 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:49:35,033 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:49:35,037 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:49:35,037 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:49:35,037 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:49:35,041 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:49:35,045 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:49:35,046 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:49:35,046 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:49:35,046 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:49:35,046 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:49:35,050 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:49:35,054 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:49:35,054 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:49:35,054 - DEBUG - üîç Relationship Details:
2025-11-13 11:49:35,054 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,054 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:49:35,055 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,055 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,055 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,055 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:49:35,055 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,055 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:49:35,055 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,055 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:49:35,055 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:49:35,055 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:49:35,055 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:49:35,055 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:49:35,055 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:49:35,055 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:49:35,721 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:35,736 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:35,737 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:49:35,749 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:49:35,753 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:49:35,756 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:49:35,758 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:49:35,761 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:49:35,763 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:49:35,766 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:49:35,769 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:49:35,772 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:49:35,774 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:49:35,777 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:49:35,780 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:49:35,782 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:49:35,785 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:49:35,790 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:49:35,795 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:35,795 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:35,799 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:49:35,799 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:49:35,803 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:35,803 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:35,807 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:35,807 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:49:35,812 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:35,812 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:49:35,816 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:49:35,816 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:49:35,820 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:49:35,821 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:49:35,821 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:49:35,825 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:49:35,826 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:49:35,826 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:49:35,830 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:49:35,835 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:49:35,835 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:49:35,835 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:49:35,835 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:49:35,835 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:49:35,839 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:49:35,844 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:49:35,844 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:49:35,844 - DEBUG - üîç Relationship Details:
2025-11-13 11:49:35,844 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,844 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:49:35,844 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,844 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,844 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,844 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:49:35,844 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,844 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:49:35,844 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:49:35,844 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:49:35,844 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:49:35,844 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:49:35,844 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:49:35,845 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:49:37,374 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:49:37,375 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:49:37,375 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:49:37,569 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:49:37,821 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:37,837 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:37,837 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:37,853 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:37,868 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:37,877 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:49:37,897 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:49:37,903 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:49:37,907 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:49:37,910 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:49:37,914 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:49:37,918 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:49:37,921 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:49:37,924 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:49:37,927 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:49:37,930 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:49:37,933 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:49:37,936 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:49:37,939 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:49:37,942 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:49:37,949 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:49:37,955 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:37,955 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:37,959 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:49:37,959 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:49:37,963 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:37,963 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:37,968 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:37,968 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:49:37,972 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:37,972 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:49:37,976 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:49:37,976 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:49:37,981 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:49:37,981 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:49:37,981 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:49:37,985 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:49:37,985 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:49:37,985 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:49:37,989 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:49:37,994 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:49:37,994 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:49:37,994 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:49:37,994 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:49:37,994 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:49:37,998 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:49:38,002 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:49:38,002 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:49:38,003 - DEBUG - üîç Relationship Details:
2025-11-13 11:49:38,003 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,003 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:49:38,003 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,003 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,003 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,003 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:49:38,003 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,003 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:49:38,003 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,003 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:49:38,003 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:49:38,003 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:49:38,003 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:49:38,004 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:49:38,004 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:49:38,004 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:49:38,663 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:38,678 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:38,679 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:49:38,691 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:49:38,695 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:49:38,698 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:49:38,701 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:49:38,703 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:49:38,706 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:49:38,708 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:49:38,711 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:49:38,714 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:49:38,717 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:49:38,719 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:49:38,722 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:49:38,725 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:49:38,728 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:49:38,733 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:49:38,737 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:38,737 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:38,741 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:49:38,741 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:49:38,745 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:38,745 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:38,749 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:38,749 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:49:38,754 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:38,754 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:49:38,758 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:49:38,759 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:49:38,763 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:49:38,763 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:49:38,763 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:49:38,768 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:49:38,768 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:49:38,768 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:49:38,773 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:49:38,778 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:49:38,778 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:49:38,778 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:49:38,778 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:49:38,779 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:49:38,783 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:49:38,788 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:49:38,788 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:49:38,788 - DEBUG - üîç Relationship Details:
2025-11-13 11:49:38,788 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,788 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:49:38,788 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,788 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,788 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,788 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:49:38,789 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,789 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:49:38,789 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:49:38,789 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:49:38,789 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:49:38,789 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:49:38,789 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:49:38,789 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:49:39,703 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:49:39,703 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:49:39,704 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:49:39,871 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:49:40,104 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:40,120 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:40,120 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:40,135 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:40,150 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:40,159 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:49:40,178 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:49:40,183 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:49:40,186 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:49:40,189 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:49:40,192 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:49:40,194 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:49:40,197 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:49:40,200 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:49:40,202 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:49:40,205 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:49:40,208 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:49:40,211 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:49:40,214 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:49:40,217 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:49:40,222 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:49:40,226 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:40,226 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:40,230 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:49:40,230 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:49:40,234 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:40,234 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:40,238 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:40,238 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:49:40,242 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:40,242 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:49:40,246 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:49:40,246 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:49:40,250 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:49:40,250 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:49:40,251 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:49:40,255 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:49:40,255 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:49:40,255 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:49:40,259 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:49:40,263 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:49:40,263 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:49:40,263 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:49:40,263 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:49:40,263 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:49:40,268 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:49:40,272 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:49:40,272 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:49:40,272 - DEBUG - üîç Relationship Details:
2025-11-13 11:49:40,272 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:40,272 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:49:40,272 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:40,272 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:49:40,272 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:49:40,272 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:49:40,272 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:49:40,272 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:49:40,272 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:49:40,272 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:49:40,272 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:49:40,273 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:49:40,273 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:49:40,273 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:49:40,273 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:49:40,274 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:49:40,940 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:49:40,955 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:49:40,956 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:49:40,968 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:49:40,973 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:49:40,975 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:49:40,978 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:49:40,981 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:49:40,983 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:49:40,986 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:49:40,989 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:49:40,991 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:49:40,994 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:49:40,997 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:49:41,000 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:49:41,002 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:49:41,005 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:49:41,010 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:49:41,014 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:41,015 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:41,019 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:49:41,019 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:49:41,024 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:41,024 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:49:41,028 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:41,028 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:49:41,033 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:49:41,033 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:49:41,037 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:49:41,037 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:49:41,042 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:49:41,042 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:49:41,042 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:49:41,047 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:49:41,047 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:49:41,047 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:49:41,051 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:49:41,056 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:49:41,056 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:49:41,056 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:49:41,056 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:49:41,056 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:49:41,061 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:49:41,065 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:49:41,065 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:49:41,066 - DEBUG - üîç Relationship Details:
2025-11-13 11:49:41,066 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:41,066 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:49:41,066 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:49:41,066 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:49:41,066 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:49:41,066 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:49:41,066 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:49:41,066 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:49:41,066 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:49:41,066 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:49:41,067 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:49:41,067 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:49:41,067 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:49:41,067 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:49:50,383 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:49:50,383 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:49:50,383 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:49:50,560 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:49:51,778 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:49:51,778 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:49:51,778 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:49:51,943 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:49:55,335 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:49:55,335 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:49:55,335 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:49:55,506 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:50:14,843 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:50:14,843 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:50:14,843 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:50:15,018 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:50:15,257 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:15,272 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:15,272 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:15,288 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:15,302 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:15,311 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:15,331 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:15,336 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:15,339 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:15,342 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:15,345 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:15,347 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:15,350 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:15,352 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:15,355 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:15,358 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:15,361 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:15,365 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:15,367 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:15,370 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:15,375 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:15,379 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:15,380 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:15,383 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:15,384 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:15,387 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:15,388 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:15,391 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:15,392 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:15,395 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:15,395 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:15,399 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:15,399 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:15,403 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:15,404 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:15,404 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:15,408 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:15,408 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:15,408 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:15,412 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:15,416 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:15,416 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:15,416 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:15,416 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:15,416 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:15,421 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:50:15,425 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:15,425 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:15,425 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:15,425 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:15,425 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:15,425 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:15,425 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:15,425 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:15,425 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:15,425 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:15,425 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:15,425 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:15,425 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:15,425 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:15,425 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:15,425 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:15,425 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:15,426 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:50:15,426 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:50:16,117 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:16,132 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:16,133 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:16,145 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:16,149 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:16,152 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:16,154 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:16,157 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:16,159 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:16,162 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:16,165 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:16,168 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:16,170 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:16,173 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:16,176 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:16,178 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:16,181 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:16,186 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:16,190 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:16,190 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:16,194 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:16,194 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:16,198 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:16,198 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:16,202 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:16,202 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:16,206 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:16,206 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:16,210 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:16,211 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:16,215 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:16,215 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:16,215 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:16,219 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:16,219 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:16,219 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:16,223 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:16,227 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:16,227 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:16,227 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:16,227 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:16,227 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:16,232 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:50:16,236 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:16,236 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:16,236 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:16,236 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:16,236 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:16,236 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:16,236 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:16,236 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:16,236 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:16,236 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:16,236 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:16,236 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:16,236 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:16,236 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:16,236 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:16,236 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:16,236 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:19,874 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:50:19,874 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:50:19,874 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:50:20,050 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:50:20,289 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:20,304 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:20,305 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:20,320 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:20,335 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:20,344 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:20,365 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:20,371 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:20,374 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:20,376 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:20,379 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:20,381 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:20,384 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:20,387 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:20,390 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:20,393 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:20,396 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:20,399 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:20,402 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:20,405 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:20,410 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:20,414 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:20,414 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:20,419 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:20,419 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:20,423 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:20,423 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:20,427 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:20,427 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:20,431 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:20,432 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:20,436 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:20,436 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:20,440 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:20,440 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:20,440 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:20,444 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:20,444 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:20,444 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:20,448 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:20,453 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:20,453 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:20,453 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:20,453 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:20,453 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:20,457 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:50:20,461 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:20,461 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:20,461 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:20,461 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:20,461 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:20,461 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:20,461 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:20,461 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:20,462 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:20,462 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:20,462 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:20,462 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:20,462 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:20,462 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:20,462 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:20,462 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:20,462 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:20,463 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:50:20,463 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:50:21,122 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:21,137 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:21,138 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:21,153 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:21,158 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:21,161 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:21,164 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:21,166 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:21,169 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:21,171 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:21,175 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:21,177 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:21,180 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:21,182 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:21,185 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:21,188 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:21,190 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:21,195 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:21,200 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:21,200 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:21,204 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:21,204 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:21,208 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:21,208 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:21,212 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:21,212 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:21,216 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:21,216 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:21,220 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:21,220 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:21,224 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:21,224 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:21,224 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:21,227 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:21,228 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:21,228 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:21,232 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:21,236 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:21,236 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:21,236 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:21,236 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:21,236 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:21,241 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:50:21,245 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:21,245 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:21,245 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:21,245 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:21,245 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:21,245 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:21,245 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:21,245 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:21,245 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:21,245 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:21,245 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:21,245 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:21,245 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:21,245 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:21,245 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:21,245 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:21,245 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:48,444 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:50:48,444 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:50:48,444 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:50:48,639 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:50:48,883 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:48,898 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:48,899 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:48,914 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:48,928 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:48,937 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:48,956 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:48,962 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:48,965 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:48,967 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:48,970 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:48,972 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:48,975 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:48,977 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:48,980 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:48,983 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:48,986 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:48,989 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:48,992 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:48,995 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:49,000 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:49,004 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:49,004 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:49,008 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:49,008 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:49,012 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:49,012 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:49,016 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:49,017 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:49,020 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:49,021 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:49,025 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:49,025 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:49,029 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:49,029 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:49,029 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:49,033 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:49,033 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:49,033 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:49,037 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:49,042 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:49,042 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:49,042 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:49,042 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:49,042 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:49,044 - ERROR - ‚ùå Error getting foreign keys for table systems: (pyodbc.OperationalError) ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Error code 0x2714 (10004) (SQLExecDirectW)')
[SQL: WITH fk_info AS (
    SELECT
        ischema_ref_con.constraint_schema,
        ischema_ref_con.constraint_name,
        ischema_key_col.ordinal_position,
        ischema_key_col.table_schema,
        ischema_key_col.table_name,
        ischema_ref_con.unique_constraint_schema,
        ischema_ref_con.unique_constraint_name,
        ischema_ref_con.match_option,
        ischema_ref_con.update_rule,
        ischema_ref_con.delete_rule,
        ischema_key_col.column_name AS constrained_column
    FROM
        INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS ischema_ref_con
        INNER JOIN
        INFORMATION_SCHEMA.KEY_COLUMN_USAGE ischema_key_col ON
            ischema_key_col.table_schema = ischema_ref_con.constraint_schema
            AND ischema_key_col.constraint_name =
            ischema_ref_con.constraint_name
    WHERE ischema_key_col.table_name = CAST(? AS NVARCHAR(max))
        AND ischema_key_col.table_schema = CAST(? AS NVARCHAR(max))
),
constraint_info AS (
    SELECT
        ischema_key_col.constraint_schema,
        ischema_key_col.constraint_name,
        ischema_key_col.ordinal_position,
        ischema_key_col.table_schema,
        ischema_key_col.table_name,
        ischema_key_col.column_name
    FROM
        INFORMATION_SCHEMA.KEY_COLUMN_USAGE ischema_key_col
),
index_info AS (
    SELECT
        sys.schemas.name AS index_schema,
        sys.indexes.name AS index_name,
        sys.index_columns.key_ordinal AS ordinal_position,
        sys.schemas.name AS table_schema,
        sys.objects.name AS table_name,
        sys.columns.name AS column_name
    FROM
        sys.indexes
        INNER JOIN
        sys.objects ON
            sys.objects.object_id = sys.indexes.object_id
        INNER JOIN
        sys.schemas ON
            sys.schemas.schema_id = sys.objects.schema_id
        INNER JOIN
        sys.index_columns ON
            sys.index_columns.object_id = sys.objects.object_id
            AND sys.index_columns.index_id = sys.indexes.index_id
        INNER JOIN
        sys.columns ON
            sys.columns.object_id = sys.indexes.object_id
            AND sys.columns.column_id = sys.index_columns.column_id
)
    SELECT
        fk_info.constraint_schema,
        fk_info.constraint_name,
        fk_info.ordinal_position,
        fk_info.constrained_column,
        constraint_info.table_schema AS referred_table_schema,
        constraint_info.table_name AS referred_table_name,
        constraint_info.column_name AS referred_column,
        fk_info.match_option,
        fk_info.update_rule,
        fk_info.delete_rule
    FROM
        fk_info INNER JOIN constraint_info ON
            constraint_info.constraint_schema =
                fk_info.unique_constraint_schema
            AND constraint_info.constraint_name =
                fk_info.unique_constraint_name
            AND constraint_info.ordinal_position = fk_info.ordinal_position
    UNION
    SELECT
        fk_info.constraint_schema,
        fk_info.constraint_name,
        fk_info.ordinal_position,
        fk_info.constrained_column,
        index_info.table_schema AS referred_table_schema,
        index_info.table_name AS referred_table_name,
        index_info.column_name AS referred_column,
        fk_info.match_option,
        fk_info.update_rule,
        fk_info.delete_rule
    FROM
        fk_info INNER JOIN index_info ON
            index_info.index_schema = fk_info.unique_constraint_schema
            AND index_info.index_name = fk_info.unique_constraint_name
            AND index_info.ordinal_position = fk_info.ordinal_position

    ORDER BY fk_info.constraint_schema, fk_info.constraint_name,
        fk_info.ordinal_position
]
[parameters: ('systems', 'dbo')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-11-13 11:50:49,057 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:49,057 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:49,057 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:49,057 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,057 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:49,057 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,057 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,057 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,057 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:49,057 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,058 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:49,058 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,058 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:49,058 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:49,058 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:49,058 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:49,058 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:49,058 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:50:49,058 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:50:49,729 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:49,744 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:49,745 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:49,757 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:49,762 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:49,764 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:49,767 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:49,769 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:49,772 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:49,774 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:49,778 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:49,781 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:49,783 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:49,786 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:49,789 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:49,791 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:49,794 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:49,800 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:49,804 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:49,804 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:49,808 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:49,808 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:49,813 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:49,813 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:49,817 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:49,817 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:49,821 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:49,821 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:49,825 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:49,825 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:49,829 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:49,830 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:49,830 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:49,834 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:49,834 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:49,834 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:49,838 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:49,842 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:49,842 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:49,842 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:49,843 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:49,843 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:49,847 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:50:49,851 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:49,851 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:49,851 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:49,851 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,851 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:49,851 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,851 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,851 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,851 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:49,851 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,851 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:49,851 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:49,851 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:49,851 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:49,851 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:49,851 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:49,851 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:50,765 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:50:50,765 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:50:50,765 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:50:50,931 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:50:51,164 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:51,180 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:51,180 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:51,195 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:51,210 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:51,218 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:51,238 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:51,243 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:51,246 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:51,249 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:51,251 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:51,254 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:51,256 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:51,259 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:51,262 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:51,265 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:51,268 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:51,271 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:51,274 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:51,277 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:51,282 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:51,286 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:51,286 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:51,290 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:51,290 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:51,294 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:51,294 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:51,298 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:51,299 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:51,302 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:51,302 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:51,307 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:51,307 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:51,311 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:51,311 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:51,311 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:51,315 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:51,315 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:51,316 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:51,320 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:51,324 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:51,324 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:51,324 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:51,324 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:51,324 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:51,328 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:50:51,332 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:51,332 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:51,332 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:51,332 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:51,332 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:51,332 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:51,332 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:51,333 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:51,333 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:51,333 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:51,333 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:51,333 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:51,333 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:51,333 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:51,333 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:51,333 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:51,333 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:51,334 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:50:51,334 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:50:51,999 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:52,014 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:52,014 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:52,028 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:52,033 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:52,035 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:52,038 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:52,041 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:52,043 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:52,046 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:52,049 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:52,052 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:52,055 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:52,058 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:52,061 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:52,063 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:52,066 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:52,071 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:52,076 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:52,076 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:52,080 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:52,080 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:52,084 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:52,084 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:52,088 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:52,088 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:52,092 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:52,092 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:52,096 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:52,096 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:52,101 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:52,101 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:52,101 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:52,105 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:52,105 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:52,105 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:52,109 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:52,114 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:52,114 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:52,114 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:52,114 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:52,114 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:52,118 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:50:52,122 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:52,122 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:52,122 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:52,122 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:52,122 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:52,122 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:52,123 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:52,123 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:52,123 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:52,123 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:52,123 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:52,123 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:52,123 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:52,123 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:52,123 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:52,123 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:52,123 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:58,822 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:50:58,822 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:50:58,822 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:50:58,997 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:50:59,269 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:59,285 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:59,286 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:59,312 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:50:59,328 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:50:59,338 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:50:59,359 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:50:59,366 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:50:59,369 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:50:59,373 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:50:59,376 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:50:59,379 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:50:59,383 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:50:59,386 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:50:59,389 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:50:59,393 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:50:59,397 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:50:59,401 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:50:59,403 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:50:59,407 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:50:59,413 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:50:59,418 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:59,419 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:59,423 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:50:59,424 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:50:59,428 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:59,428 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:50:59,434 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:59,434 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:50:59,440 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:50:59,440 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:50:59,444 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:50:59,445 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:50:59,450 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:50:59,450 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:50:59,450 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:50:59,455 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:50:59,455 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:50:59,456 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:50:59,460 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:50:59,465 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:50:59,465 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:50:59,466 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:50:59,466 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:50:59,466 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:50:59,470 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:50:59,475 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:50:59,476 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:50:59,476 - DEBUG - üîç Relationship Details:
2025-11-13 11:50:59,476 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:59,476 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:50:59,476 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:50:59,476 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:50:59,476 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:50:59,476 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:50:59,476 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:50:59,476 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:50:59,476 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:50:59,476 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:50:59,476 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:50:59,476 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:50:59,476 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:50:59,476 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:50:59,477 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:50:59,477 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:51:00,187 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:00,213 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:00,214 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:51:00,230 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:51:00,239 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:51:00,244 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:51:00,247 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:51:00,250 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:51:00,253 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:51:00,255 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:51:00,258 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:51:00,261 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:51:00,264 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:51:00,268 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:51:00,271 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:51:00,273 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:51:00,276 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:51:00,282 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:51:00,286 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:00,286 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:00,290 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:51:00,290 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:51:00,295 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:00,295 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:00,299 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:00,299 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:51:00,303 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:00,303 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:51:00,307 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:51:00,307 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:51:00,311 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:51:00,311 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:51:00,311 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:51:00,315 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:51:00,316 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:51:00,316 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:51:00,320 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:51:00,324 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:51:00,324 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:51:00,324 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:51:00,324 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:51:00,324 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:51:00,328 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:51:00,333 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:51:00,333 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:51:00,333 - DEBUG - üîç Relationship Details:
2025-11-13 11:51:00,333 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:00,333 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:51:00,333 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:00,333 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:51:00,333 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:51:00,333 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:51:00,333 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:51:00,333 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:51:00,333 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:51:00,334 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:51:00,334 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:51:00,334 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:51:00,334 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:51:00,334 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:51:01,257 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:51:01,258 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:51:01,258 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:51:01,424 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:51:01,659 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:01,674 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:01,674 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:01,690 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:01,705 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:01,716 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:51:01,738 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:51:01,745 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:51:01,748 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:51:01,752 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:51:01,756 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:51:01,759 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:51:01,764 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:51:01,768 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:51:01,774 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:51:01,779 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:51:01,784 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:51:01,789 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:51:01,793 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:51:01,798 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:51:01,806 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:51:01,812 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:01,812 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:01,817 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:51:01,817 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:51:01,823 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:01,823 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:01,828 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:01,828 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:51:01,834 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:01,834 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:51:01,840 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:51:01,840 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:51:01,845 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:51:01,845 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:51:01,845 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:51:01,851 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:51:01,852 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:51:01,852 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:51:01,857 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:51:01,862 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:51:01,862 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:51:01,862 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:51:01,862 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:51:01,862 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:51:01,867 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:51:01,872 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:51:01,872 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:51:01,872 - DEBUG - üîç Relationship Details:
2025-11-13 11:51:01,872 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:01,872 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:51:01,873 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:01,873 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:51:01,873 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:51:01,873 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:51:01,873 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:51:01,873 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:51:01,873 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:51:01,873 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:51:01,873 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:51:01,873 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:51:01,873 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:51:01,873 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:51:01,874 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:51:01,874 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:51:02,548 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:02,563 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:02,564 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:51:02,576 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:51:02,581 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:51:02,583 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:51:02,586 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:51:02,588 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:51:02,591 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:51:02,593 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:51:02,596 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:51:02,599 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:51:02,602 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:51:02,604 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:51:02,607 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:51:02,610 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:51:02,612 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:51:02,617 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:51:02,622 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:02,622 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:02,626 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:51:02,626 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:51:02,630 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:02,630 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:02,634 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:02,634 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:51:02,638 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:02,638 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:51:02,642 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:51:02,642 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:51:02,647 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:51:02,647 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:51:02,647 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:51:02,651 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:51:02,651 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:51:02,651 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:51:02,656 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:51:02,660 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:51:02,661 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:51:02,661 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:51:02,661 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:51:02,661 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:51:02,665 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:51:02,669 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:51:02,669 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:51:02,669 - DEBUG - üîç Relationship Details:
2025-11-13 11:51:02,669 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:02,669 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:51:02,669 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:02,669 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:51:02,669 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:51:02,669 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:51:02,670 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:51:02,670 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:51:02,670 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:51:02,670 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:51:02,670 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:51:02,670 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:51:02,670 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:51:02,670 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:51:14,351 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:51:14,352 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:51:14,352 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:51:14,526 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:51:14,767 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:14,783 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:14,783 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:14,799 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:14,814 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:14,823 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:51:14,843 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:51:14,849 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:51:14,851 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:51:14,854 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:51:14,857 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:51:14,859 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:51:14,862 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:51:14,864 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:51:14,868 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:51:14,870 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:51:14,874 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:51:14,877 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:51:14,879 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:51:14,882 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:51:14,888 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:51:14,892 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:14,892 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:14,896 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:51:14,896 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:51:14,900 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:14,900 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:14,904 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:14,904 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:51:14,908 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:14,909 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:51:14,913 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:51:14,913 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:51:14,917 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:51:14,917 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:51:14,917 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:51:14,921 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:51:14,921 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:51:14,921 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:51:14,926 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:51:14,932 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:51:14,932 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:51:14,932 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:51:14,932 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:51:14,932 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:51:14,937 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:51:14,941 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:51:14,941 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:51:14,942 - DEBUG - üîç Relationship Details:
2025-11-13 11:51:14,942 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:14,942 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:51:14,942 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:14,942 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:51:14,942 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:51:14,942 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:51:14,942 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:51:14,942 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:51:14,942 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:51:14,942 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:51:14,942 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:51:14,942 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:51:14,942 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:51:14,942 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:51:14,943 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:51:14,943 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:51:15,615 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:15,631 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:15,632 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:51:15,644 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:51:15,649 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:51:15,652 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:51:15,654 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:51:15,657 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:51:15,660 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:51:15,662 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:51:15,666 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:51:15,669 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:51:15,672 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:51:15,674 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:51:15,677 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:51:15,680 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:51:15,683 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:51:15,688 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:51:15,692 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:15,692 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:15,697 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:51:15,697 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:51:15,701 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:15,701 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:15,705 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:15,705 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:51:15,710 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:15,710 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:51:15,714 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:51:15,714 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:51:15,719 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:51:15,719 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:51:15,719 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:51:15,723 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:51:15,723 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:51:15,723 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:51:15,727 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:51:15,731 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:51:15,731 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:51:15,731 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:51:15,731 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:51:15,731 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:51:15,736 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:51:15,740 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:51:15,740 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:51:15,740 - DEBUG - üîç Relationship Details:
2025-11-13 11:51:15,740 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:15,740 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:51:15,740 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:15,740 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:51:15,740 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:51:15,740 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:51:15,740 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:51:15,740 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:51:15,740 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:51:15,740 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:51:15,741 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:51:15,741 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:51:15,741 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:51:15,741 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:51:28,385 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 11:51:28,385 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 11:51:28,385 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 11:51:28,564 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 11:51:28,801 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:28,816 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:28,816 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:28,832 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:28,846 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:28,855 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:51:28,875 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:51:28,880 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:51:28,883 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:51:28,886 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:51:28,888 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:51:28,891 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:51:28,893 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:51:28,896 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:51:28,899 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:51:28,902 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:51:28,905 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:51:28,908 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:51:28,911 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:51:28,913 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:51:28,919 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:51:28,923 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:28,923 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:28,927 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:51:28,927 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:51:28,931 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:28,931 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:28,935 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:28,936 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:51:28,939 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:28,939 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:51:28,943 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:51:28,943 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:51:28,947 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:51:28,947 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:51:28,948 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:51:28,952 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:51:28,952 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:51:28,952 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:51:28,956 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:51:28,960 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:51:28,960 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:51:28,960 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:51:28,961 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:51:28,961 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:51:28,965 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:51:28,968 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:51:28,968 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:51:28,969 - DEBUG - üîç Relationship Details:
2025-11-13 11:51:28,969 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:28,969 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:51:28,969 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:28,969 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:51:28,969 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:51:28,969 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:51:28,969 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:51:28,969 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:51:28,969 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:51:28,969 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:51:28,969 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:51:28,969 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:51:28,969 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:51:28,970 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 11:51:28,970 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 11:51:28,970 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 11:51:29,627 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 11:51:29,643 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 11:51:29,643 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 11:51:29,655 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 11:51:29,660 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 11:51:29,662 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 11:51:29,665 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 11:51:29,667 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 11:51:29,670 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 11:51:29,672 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 11:51:29,675 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 11:51:29,678 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 11:51:29,681 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 11:51:29,683 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 11:51:29,686 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 11:51:29,689 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 11:51:29,691 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 11:51:29,696 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 11:51:29,700 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:29,701 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:29,705 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 11:51:29,705 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 11:51:29,709 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:29,709 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 11:51:29,713 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:29,713 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 11:51:29,718 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 11:51:29,718 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 11:51:29,722 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 11:51:29,722 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 11:51:29,726 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 11:51:29,726 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 11:51:29,726 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 11:51:29,730 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 11:51:29,730 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 11:51:29,730 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 11:51:29,734 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 11:51:29,738 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 11:51:29,738 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 11:51:29,738 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 11:51:29,738 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 11:51:29,738 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 11:51:29,743 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 11:51:29,748 - DEBUG - üîó Foreign keys for users: []
2025-11-13 11:51:29,748 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 11:51:29,748 - DEBUG - üîç Relationship Details:
2025-11-13 11:51:29,748 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:29,748 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 11:51:29,748 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 11:51:29,748 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 11:51:29,749 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 11:51:29,749 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 11:51:29,749 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 11:51:29,749 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 11:51:29,749 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 11:51:29,749 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 11:51:29,749 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 11:51:29,749 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 11:51:29,749 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 11:51:29,749 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:07:05,735 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:07:05,735 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:07:05,735 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:07:05,901 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:07:06,178 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:07:06,193 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:07:06,193 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:07:06,209 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:07:06,224 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:07:06,270 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:07:06,312 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:07:06,318 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:07:06,320 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:07:06,323 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:07:06,325 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:07:06,328 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:07:06,330 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:07:06,333 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:07:06,336 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:07:06,339 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:07:06,342 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:07:06,345 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:07:06,347 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:07:06,350 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:07:06,355 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:07:06,360 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:07:06,360 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:07:06,364 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:07:06,364 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:07:06,368 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:07:06,368 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:07:06,373 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:07:06,373 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:07:06,377 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:07:06,377 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:07:06,381 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:07:06,381 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:07:06,385 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:07:06,385 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:07:06,385 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:07:06,390 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:07:06,390 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:07:06,390 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:07:06,394 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:07:06,398 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:07:06,398 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:07:06,398 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:07:06,398 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:07:06,398 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:07:06,402 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:07:06,407 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:07:06,407 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:07:06,407 - DEBUG - üîç Relationship Details:
2025-11-13 13:07:06,407 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:07:06,407 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:07:06,407 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:07:06,407 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:07:06,407 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:07:06,407 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:07:06,407 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:07:06,408 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:07:06,408 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:07:06,408 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:07:06,408 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:07:06,408 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:07:06,408 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:07:06,408 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:07:06,408 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:07:06,408 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:07:07,272 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:07:07,287 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:07:07,288 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:07:07,301 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:07:07,305 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:07:07,308 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:07:07,310 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:07:07,313 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:07:07,315 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:07:07,318 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:07:07,321 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:07:07,324 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:07:07,327 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:07:07,329 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:07:07,332 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:07:07,335 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:07:07,338 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:07:07,344 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:07:07,348 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:07:07,348 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:07:07,353 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:07:07,353 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:07:07,357 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:07:07,358 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:07:07,362 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:07:07,362 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:07:07,367 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:07:07,367 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:07:07,371 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:07:07,371 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:07:07,376 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:07:07,376 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:07:07,376 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:07:07,380 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:07:07,380 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:07:07,380 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:07:07,385 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:07:07,389 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:07:07,389 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:07:07,389 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:07:07,389 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:07:07,389 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:07:07,393 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:07:07,397 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:07:07,397 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:07:07,398 - DEBUG - üîç Relationship Details:
2025-11-13 13:07:07,398 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:07:07,398 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:07:07,398 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:07:07,398 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:07:07,398 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:07:07,398 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:07:07,398 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:07:07,398 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:07:07,398 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:07:07,398 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:07:07,398 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:07:07,398 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:07:07,399 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:07:07,399 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:09:34,914 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:09:34,915 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:09:34,915 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:09:35,088 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:09:35,348 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:09:35,365 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:09:35,365 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:09:35,382 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:09:35,397 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:09:35,407 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:09:35,432 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:09:35,439 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:09:35,443 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:09:35,447 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:09:35,452 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:09:35,456 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:09:35,461 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:09:35,466 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:09:35,472 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:09:35,477 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:09:35,481 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:09:35,486 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:09:35,490 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:09:35,493 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:09:35,501 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:09:35,506 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:09:35,506 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:09:35,512 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:09:35,512 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:09:35,519 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:09:35,519 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:09:35,524 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:09:35,524 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:09:35,530 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:09:35,531 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:09:35,535 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:09:35,535 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:09:35,539 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:09:35,539 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:09:35,539 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:09:35,543 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:09:35,543 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:09:35,543 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:09:35,548 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:09:35,552 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:09:35,552 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:09:35,552 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:09:35,552 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:09:35,552 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:09:35,556 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:09:35,561 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:09:35,561 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:09:35,561 - DEBUG - üîç Relationship Details:
2025-11-13 13:09:35,561 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:09:35,561 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:09:35,562 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:09:35,562 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:09:35,562 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:09:35,562 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:09:35,562 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:09:35,562 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:09:35,562 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:09:35,562 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:09:35,562 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:09:35,562 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:09:35,562 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:09:35,562 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:09:35,563 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:09:35,564 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:09:36,303 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:09:36,319 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:09:36,320 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:09:36,332 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:09:36,336 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:09:36,339 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:09:36,342 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:09:36,344 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:09:36,347 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:09:36,349 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:09:36,353 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:09:36,356 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:09:36,358 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:09:36,361 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:09:36,364 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:09:36,367 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:09:36,370 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:09:36,375 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:09:36,380 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:09:36,380 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:09:36,384 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:09:36,384 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:09:36,389 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:09:36,389 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:09:36,393 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:09:36,393 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:09:36,397 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:09:36,397 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:09:36,401 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:09:36,402 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:09:36,406 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:09:36,406 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:09:36,406 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:09:36,410 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:09:36,410 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:09:36,410 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:09:36,414 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:09:36,419 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:09:36,419 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:09:36,419 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:09:36,419 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:09:36,419 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:09:36,423 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:09:36,427 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:09:36,427 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:09:36,427 - DEBUG - üîç Relationship Details:
2025-11-13 13:09:36,427 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:09:36,428 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:09:36,428 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:09:36,428 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:09:36,428 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:09:36,428 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:09:36,428 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:09:36,428 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:09:36,428 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:09:36,428 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:09:36,428 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:09:36,428 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:09:36,428 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:09:36,428 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:09:37,340 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:09:37,340 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:09:37,340 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:09:37,506 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:10:01,952 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:10:01,952 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:10:01,952 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:10:02,134 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:10:02,375 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:10:02,391 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:10:02,391 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:10:02,407 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:10:02,422 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:10:02,430 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:10:02,449 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:10:02,455 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:10:02,458 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:10:02,461 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:10:02,463 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:10:02,466 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:10:02,468 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:10:02,471 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:10:02,474 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:10:02,477 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:10:02,481 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:10:02,484 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:10:02,486 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:10:02,489 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:10:02,495 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:10:02,499 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:10:02,499 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:10:02,503 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:10:02,503 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:10:02,507 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:10:02,507 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:10:02,511 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:10:02,511 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:10:02,516 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:10:02,516 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:10:02,520 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:10:02,520 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:10:02,524 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:10:02,524 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:10:02,524 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:10:02,528 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:10:02,528 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:10:02,528 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:10:02,532 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:10:02,536 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:10:02,537 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:10:02,537 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:10:02,537 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:10:02,537 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:10:02,541 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:10:02,545 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:10:02,545 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:10:02,545 - DEBUG - üîç Relationship Details:
2025-11-13 13:10:02,545 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:10:02,545 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:10:02,545 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:10:02,545 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:10:02,545 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:10:02,545 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:10:02,545 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:10:02,545 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:10:02,545 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:10:02,545 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:10:02,546 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:10:02,546 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:10:02,546 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:10:02,546 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:10:02,546 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:10:02,546 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:10:03,204 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:10:03,219 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:10:03,220 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:10:03,234 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:10:03,238 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:10:03,241 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:10:03,244 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:10:03,246 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:10:03,249 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:10:03,252 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:10:03,255 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:10:03,258 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:10:03,261 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:10:03,263 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:10:03,267 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:10:03,269 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:10:03,273 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:10:03,278 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:10:03,283 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:10:03,283 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:10:03,288 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:10:03,288 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:10:03,292 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:10:03,292 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:10:03,297 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:10:03,297 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:10:03,301 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:10:03,301 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:10:03,305 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:10:03,305 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:10:03,309 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:10:03,309 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:10:03,309 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:10:03,314 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:10:03,314 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:10:03,314 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:10:03,319 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:10:03,323 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:10:03,323 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:10:03,323 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:10:03,323 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:10:03,323 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:10:03,327 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:10:03,332 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:10:03,332 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:10:03,332 - DEBUG - üîç Relationship Details:
2025-11-13 13:10:03,332 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:10:03,332 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:10:03,332 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:10:03,332 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:10:03,332 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:10:03,332 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:10:03,332 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:10:03,333 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:10:03,333 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:10:03,333 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:10:03,333 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:10:03,333 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:10:03,333 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:10:03,333 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:35,213 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:11:35,213 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:11:35,213 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:11:35,381 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:11:35,623 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:35,639 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:35,640 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:35,657 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:35,673 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:35,683 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:35,707 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:35,714 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:35,718 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:35,721 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:35,725 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:35,728 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:35,731 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:35,735 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:35,738 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:35,742 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:35,746 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:35,751 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:35,754 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:35,758 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:35,766 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:35,770 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:35,770 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:35,776 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:35,776 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:35,781 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:35,781 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:35,787 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:35,787 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:35,792 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:35,792 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:35,799 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:35,799 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:35,806 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:35,806 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:35,806 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:35,812 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:35,812 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:35,812 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:35,817 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:35,822 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:35,822 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:35,822 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:35,822 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:35,822 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:35,828 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:35,834 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:35,834 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:35,834 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:35,834 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:35,834 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:35,834 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:35,834 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:35,834 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:35,834 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:35,834 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:35,835 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:35,835 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:35,835 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:35,835 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:35,835 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:35,835 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:35,835 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:35,836 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:11:35,836 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:11:36,673 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:36,689 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:36,690 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:36,705 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:36,710 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:36,714 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:36,718 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:36,723 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:36,727 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:36,731 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:36,738 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:36,743 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:36,747 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:36,752 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:36,756 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:36,760 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:36,763 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:36,772 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:36,780 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:36,780 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:36,786 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:36,786 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:36,792 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:36,792 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:36,797 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:36,797 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:36,802 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:36,802 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:36,808 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:36,808 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:36,813 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:36,813 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:36,813 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:36,818 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:36,818 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:36,818 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:36,823 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:36,828 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:36,829 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:36,829 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:36,829 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:36,829 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:36,834 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:36,839 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:36,839 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:36,839 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:36,839 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:36,839 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:36,839 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:36,839 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:36,839 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:36,839 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:36,839 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:36,839 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:36,839 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:36,839 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:36,840 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:36,840 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:36,840 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:36,840 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:37,769 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:11:38,026 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:11:38,026 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:11:38,197 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:11:38,434 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:38,450 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:38,450 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:38,466 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:38,481 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:38,490 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:38,509 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:38,515 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:38,517 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:38,520 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:38,523 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:38,525 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:38,528 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:38,531 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:38,534 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:38,536 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:38,540 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:38,543 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:38,545 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:38,548 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:38,554 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:38,558 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:38,558 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:38,562 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:38,562 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:38,566 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:38,566 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:38,570 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:38,570 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:38,574 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:38,574 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:38,578 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:38,578 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:38,582 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:38,582 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:38,582 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:38,586 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:38,587 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:38,587 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:38,591 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:38,595 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:38,595 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:38,595 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:38,595 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:38,595 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:38,599 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:38,603 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:38,603 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:38,604 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:38,604 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:38,604 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:38,604 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:38,604 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:38,604 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:38,604 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:38,604 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:38,604 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:38,604 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:38,604 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:38,604 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:38,604 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:38,604 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:38,604 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:38,605 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:11:38,605 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:11:39,272 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:39,288 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:39,288 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:39,301 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:39,305 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:39,308 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:39,311 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:39,314 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:39,316 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:39,319 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:39,322 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:39,325 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:39,328 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:39,331 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:39,334 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:39,337 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:39,340 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:39,345 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:39,350 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:39,350 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:39,354 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:39,354 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:39,358 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:39,359 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:39,362 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:39,363 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:39,367 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:39,367 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:39,371 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:39,371 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:39,376 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:39,376 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:39,376 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:39,381 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:39,381 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:39,381 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:39,385 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:39,389 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:39,389 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:39,389 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:39,390 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:39,390 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:39,394 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:39,398 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:39,398 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:39,398 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:39,398 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:39,398 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:39,398 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:39,398 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:39,398 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:39,398 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:39,398 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:39,398 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:39,398 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:39,399 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:39,399 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:39,399 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:39,399 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:39,399 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:40,310 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:11:40,311 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:11:40,311 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:11:40,476 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:11:40,704 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:40,719 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:40,720 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:40,735 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:40,749 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:40,758 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:40,778 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:40,783 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:40,786 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:40,789 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:40,791 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:40,794 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:40,796 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:40,799 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:40,802 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:40,804 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:40,808 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:40,811 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:40,813 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:40,816 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:40,821 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:40,825 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:40,825 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:40,829 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:40,830 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:40,834 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:40,834 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:40,838 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:40,838 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:40,842 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:40,842 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:40,846 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:40,846 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:40,850 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:40,850 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:40,850 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:40,854 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:40,854 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:40,854 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:40,858 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:40,862 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:40,862 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:40,862 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:40,862 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:40,863 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:40,867 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:40,871 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:40,871 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:40,871 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:40,871 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:40,871 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:40,871 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:40,871 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:40,871 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:40,871 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:40,871 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:40,872 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:40,872 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:40,872 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:40,872 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:40,872 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:40,872 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:40,872 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:40,873 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:11:40,873 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:11:41,523 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:41,538 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:41,539 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:41,551 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:41,555 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:41,558 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:41,561 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:41,563 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:41,566 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:41,568 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:41,572 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:41,574 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:41,577 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:41,580 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:41,583 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:41,585 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:41,588 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:41,593 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:41,597 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:41,597 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:41,602 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:41,602 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:41,606 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:41,606 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:41,610 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:41,610 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:41,614 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:41,614 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:41,618 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:41,618 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:41,622 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:41,622 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:41,622 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:41,626 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:41,626 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:41,627 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:41,630 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:41,635 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:41,635 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:41,635 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:41,635 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:41,635 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:41,640 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:41,644 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:41,644 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:41,644 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:41,644 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:41,644 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:41,644 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:41,644 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:41,644 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:41,644 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:41,644 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:41,644 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:41,644 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:41,644 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:41,644 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:41,645 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:41,645 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:41,645 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:45,072 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:11:45,072 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:11:45,072 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:11:45,242 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:11:45,475 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:45,490 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:45,490 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:45,506 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:45,520 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:45,529 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:45,548 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:45,554 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:45,557 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:45,559 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:45,562 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:45,564 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:45,567 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:45,570 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:45,573 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:45,575 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:45,579 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:45,582 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:45,584 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:45,587 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:45,592 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:45,596 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:45,597 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:45,601 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:45,601 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:45,605 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:45,605 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:45,609 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:45,609 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:45,613 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:45,613 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:45,617 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:45,617 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:45,621 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:45,621 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:45,621 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:45,625 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:45,625 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:45,625 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:45,629 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:45,634 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:45,634 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:45,634 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:45,634 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:45,634 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:45,638 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:45,642 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:45,642 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:45,642 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:45,642 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:45,642 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:45,642 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:45,642 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:45,643 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:45,643 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:45,643 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:45,643 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:45,643 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:45,643 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:45,643 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:45,643 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:45,643 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:45,643 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:45,644 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:11:45,644 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:11:46,320 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:46,335 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:46,336 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:46,348 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:46,353 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:46,355 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:46,358 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:46,361 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:46,363 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:46,366 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:46,369 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:46,373 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:46,375 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:46,378 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:46,381 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:46,384 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:46,387 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:46,392 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:46,396 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:46,396 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:46,400 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:46,400 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:46,404 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:46,404 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:46,408 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:46,408 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:46,412 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:46,413 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:46,417 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:46,417 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:46,421 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:46,421 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:46,421 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:46,425 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:46,425 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:46,425 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:46,430 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:46,435 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:46,435 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:46,435 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:46,435 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:46,435 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:46,439 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:46,443 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:46,443 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:46,444 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:46,444 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:46,444 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:46,444 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:46,444 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:46,444 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:46,444 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:46,444 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:46,444 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:46,444 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:46,444 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:46,444 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:46,444 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:46,444 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:46,445 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:47,362 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:11:47,362 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:11:47,362 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:11:47,534 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:11:50,416 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:11:50,416 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:11:50,416 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:11:50,583 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:11:50,818 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:50,834 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:50,834 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:50,850 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:50,865 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:50,873 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:50,893 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:50,898 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:50,901 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:50,904 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:50,907 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:50,909 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:50,912 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:50,914 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:50,917 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:50,920 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:50,923 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:50,926 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:50,929 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:50,932 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:50,937 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:50,941 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:50,941 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:50,945 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:50,945 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:50,949 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:50,949 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:50,953 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:50,953 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:50,957 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:50,957 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:50,961 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:50,961 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:50,966 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:50,966 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:50,966 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:50,970 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:50,970 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:50,970 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:50,974 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:50,978 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:50,978 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:50,978 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:50,978 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:50,979 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:50,983 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:50,987 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:50,987 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:50,987 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:50,987 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:50,987 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:50,987 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:50,988 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:50,988 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:50,988 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:50,988 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:50,988 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:50,988 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:50,988 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:50,988 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:50,988 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:50,988 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:50,988 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:11:50,989 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:11:50,989 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:11:51,654 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:11:51,669 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:11:51,670 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:11:51,682 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:11:51,686 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:11:51,689 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:11:51,692 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:11:51,694 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:11:51,697 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:11:51,699 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:11:51,703 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:11:51,706 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:11:51,708 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:11:51,711 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:11:51,714 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:11:51,716 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:11:51,719 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:11:51,724 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:11:51,728 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:51,728 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:51,733 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:11:51,733 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:11:51,737 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:51,737 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:11:51,741 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:51,741 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:11:51,745 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:11:51,745 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:11:51,750 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:11:51,750 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:11:51,754 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:11:51,754 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:11:51,754 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:11:51,758 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:11:51,759 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:11:51,759 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:11:51,763 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:11:51,767 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:11:51,767 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:11:51,767 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:11:51,767 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:11:51,767 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:11:51,772 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:11:51,776 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:11:51,776 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:11:51,776 - DEBUG - üîç Relationship Details:
2025-11-13 13:11:51,777 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:51,777 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:11:51,777 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:11:51,777 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:11:51,777 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:11:51,777 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:11:51,777 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:11:51,777 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:11:51,777 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:11:51,777 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:11:51,777 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:11:51,777 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:11:51,777 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:11:51,777 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:13:05,750 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:13:05,750 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:13:05,750 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:13:05,927 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:13:06,382 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:06,398 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:06,398 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:06,417 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:06,432 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:06,441 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:13:06,461 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:13:06,467 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:13:06,470 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:13:06,473 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:13:06,475 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:13:06,478 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:13:06,480 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:13:06,483 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:13:06,486 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:13:06,488 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:13:06,492 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:13:06,495 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:13:06,498 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:13:06,501 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:13:06,509 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:13:06,513 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:06,513 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:06,518 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:13:06,518 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:13:06,522 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:06,522 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:06,526 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:06,526 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:13:06,530 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:06,530 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:13:06,534 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:13:06,534 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:13:06,538 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:13:06,538 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:13:06,538 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:13:06,542 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:13:06,543 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:13:06,543 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:13:06,547 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:13:06,551 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:13:06,551 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:13:06,551 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:13:06,551 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:13:06,551 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:13:06,555 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:13:06,559 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:13:06,559 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:13:06,559 - DEBUG - üîç Relationship Details:
2025-11-13 13:13:06,560 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:06,560 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:13:06,560 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:06,560 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:13:06,560 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:13:06,560 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:13:06,560 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:13:06,560 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:13:06,560 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:13:06,560 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:13:06,560 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:13:06,560 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:13:06,560 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:13:06,560 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:13:06,561 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:13:06,561 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:13:07,237 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:07,253 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:07,254 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:13:07,266 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:13:07,271 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:13:07,273 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:13:07,276 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:13:07,279 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:13:07,281 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:13:07,284 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:13:07,287 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:13:07,290 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:13:07,293 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:13:07,296 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:13:07,299 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:13:07,301 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:13:07,304 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:13:07,309 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:13:07,314 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:07,314 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:07,318 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:13:07,318 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:13:07,322 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:07,322 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:07,326 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:07,326 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:13:07,330 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:07,330 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:13:07,334 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:13:07,334 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:13:07,338 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:13:07,338 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:13:07,338 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:13:07,342 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:13:07,342 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:13:07,342 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:13:07,346 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:13:07,350 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:13:07,350 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:13:07,350 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:13:07,350 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:13:07,350 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:13:07,355 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:13:07,359 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:13:07,359 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:13:07,359 - DEBUG - üîç Relationship Details:
2025-11-13 13:13:07,359 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:07,359 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:13:07,359 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:07,359 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:13:07,359 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:13:07,359 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:13:07,359 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:13:07,359 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:13:07,359 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:13:07,359 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:13:07,359 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:13:07,359 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:13:07,360 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:13:07,360 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:13:19,496 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:13:19,496 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:13:19,496 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:13:19,672 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:13:19,932 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:19,947 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:19,948 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:19,963 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:19,978 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:19,987 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:13:20,007 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:13:20,012 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:13:20,015 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:13:20,018 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:13:20,021 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:13:20,023 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:13:20,026 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:13:20,029 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:13:20,032 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:13:20,035 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:13:20,038 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:13:20,041 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:13:20,044 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:13:20,047 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:13:20,052 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:13:20,056 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:20,057 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:20,061 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:13:20,061 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:13:20,066 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:20,066 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:20,070 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:20,070 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:13:20,074 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:20,074 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:13:20,078 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:13:20,078 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:13:20,083 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:13:20,083 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:13:20,083 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:13:20,087 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:13:20,087 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:13:20,087 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:13:20,091 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:13:20,096 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:13:20,096 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:13:20,096 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:13:20,096 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:13:20,096 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:13:20,101 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:13:20,105 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:13:20,105 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:13:20,105 - DEBUG - üîç Relationship Details:
2025-11-13 13:13:20,106 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,106 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:13:20,106 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,106 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,106 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,106 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:13:20,106 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,106 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:13:20,106 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,106 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:13:20,106 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:13:20,106 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:13:20,106 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:13:20,106 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:13:20,107 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:13:20,107 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:13:20,775 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:20,790 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:20,791 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:13:20,803 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:13:20,807 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:13:20,810 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:13:20,813 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:13:20,815 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:13:20,818 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:13:20,820 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:13:20,824 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:13:20,827 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:13:20,829 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:13:20,832 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:13:20,835 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:13:20,838 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:13:20,841 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:13:20,846 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:13:20,850 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:20,850 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:20,854 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:13:20,854 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:13:20,859 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:20,859 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:20,863 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:20,863 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:13:20,867 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:20,867 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:13:20,871 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:13:20,871 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:13:20,875 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:13:20,875 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:13:20,876 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:13:20,879 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:13:20,880 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:13:20,880 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:13:20,884 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:13:20,888 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:13:20,888 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:13:20,888 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:13:20,888 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:13:20,888 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:13:20,892 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:13:20,896 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:13:20,896 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:13:20,897 - DEBUG - üîç Relationship Details:
2025-11-13 13:13:20,897 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,897 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:13:20,897 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,897 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,897 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,897 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:13:20,897 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,897 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:13:20,897 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:13:20,897 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:13:20,897 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:13:20,897 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:13:20,897 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:13:20,897 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:13:21,824 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:13:21,824 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:13:21,824 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:13:21,992 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:13:22,227 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:22,243 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:22,243 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:22,259 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:22,274 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:22,283 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:13:22,303 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:13:22,309 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:13:22,311 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:13:22,314 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:13:22,317 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:13:22,320 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:13:22,322 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:13:22,325 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:13:22,328 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:13:22,330 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:13:22,334 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:13:22,337 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:13:22,339 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:13:22,342 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:13:22,347 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:13:22,351 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:22,351 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:22,357 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:13:22,358 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:13:22,362 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:22,362 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:22,366 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:22,366 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:13:22,370 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:22,371 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:13:22,375 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:13:22,375 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:13:22,379 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:13:22,379 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:13:22,379 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:13:22,383 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:13:22,383 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:13:22,383 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:13:22,387 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:13:22,392 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:13:22,392 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:13:22,392 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:13:22,392 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:13:22,392 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:13:22,396 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:13:22,400 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:13:22,400 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:13:22,401 - DEBUG - üîç Relationship Details:
2025-11-13 13:13:22,401 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:22,401 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:13:22,401 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:22,401 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:13:22,401 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:13:22,401 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:13:22,401 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:13:22,401 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:13:22,401 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:13:22,401 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:13:22,401 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:13:22,401 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:13:22,401 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:13:22,401 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:13:22,402 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:13:22,402 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:13:23,069 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:13:23,085 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:13:23,086 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:13:23,098 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:13:23,103 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:13:23,105 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:13:23,108 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:13:23,110 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:13:23,113 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:13:23,115 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:13:23,119 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:13:23,122 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:13:23,124 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:13:23,127 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:13:23,130 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:13:23,133 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:13:23,136 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:13:23,141 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:13:23,146 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:23,146 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:23,150 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:13:23,150 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:13:23,154 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:23,155 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:13:23,159 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:23,159 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:13:23,163 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:13:23,163 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:13:23,167 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:13:23,167 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:13:23,171 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:13:23,171 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:13:23,171 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:13:23,176 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:13:23,176 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:13:23,176 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:13:23,180 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:13:23,184 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:13:23,184 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:13:23,185 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:13:23,185 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:13:23,185 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:13:23,189 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:13:23,193 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:13:23,193 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:13:23,193 - DEBUG - üîç Relationship Details:
2025-11-13 13:13:23,193 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:23,194 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:13:23,194 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:13:23,194 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:13:23,194 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:13:23,194 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:13:23,194 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:13:23,194 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:13:23,194 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:13:23,194 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:13:23,194 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:13:23,194 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:13:23,194 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:13:23,194 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:14:32,033 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:14:32,033 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:14:32,033 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:14:32,211 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:14:32,449 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:14:32,465 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:14:32,465 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:14:32,481 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:14:32,496 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:14:32,505 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:14:32,524 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:14:32,530 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:14:32,533 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:14:32,535 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:14:32,538 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:14:32,541 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:14:32,543 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:14:32,546 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:14:32,549 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:14:32,552 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:14:32,555 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:14:32,558 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:14:32,561 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:14:32,564 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:14:32,569 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:14:32,573 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:32,573 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:14:32,577 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:14:32,577 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:14:32,581 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:32,581 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:14:32,585 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:32,585 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:14:32,589 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:32,589 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:14:32,593 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:14:32,593 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:14:32,597 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:14:32,598 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:14:32,598 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:14:32,602 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:14:32,602 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:14:32,602 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:14:32,606 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:14:32,610 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:14:32,610 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:14:32,610 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:14:32,610 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:14:32,611 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:14:32,615 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:14:32,619 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:14:32,619 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:14:32,619 - DEBUG - üîç Relationship Details:
2025-11-13 13:14:32,619 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:14:32,619 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:14:32,619 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:14:32,619 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:14:32,620 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:14:32,620 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:14:32,620 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:14:32,620 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:14:32,620 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:14:32,620 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:14:32,620 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:14:32,620 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:14:32,620 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:14:32,620 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:14:32,621 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:14:32,621 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:14:33,286 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:14:33,301 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:14:33,302 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:14:33,315 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:14:33,320 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:14:33,322 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:14:33,325 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:14:33,327 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:14:33,330 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:14:33,332 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:14:33,336 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:14:33,339 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:14:33,341 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:14:33,344 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:14:33,347 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:14:33,349 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:14:33,352 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:14:33,357 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:14:33,361 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:33,361 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:14:33,366 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:14:33,366 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:14:33,370 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:33,370 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:14:33,374 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:33,374 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:14:33,378 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:33,378 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:14:33,383 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:14:33,383 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:14:33,387 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:14:33,387 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:14:33,387 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:14:33,391 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:14:33,391 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:14:33,391 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:14:33,396 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:14:33,400 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:14:33,400 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:14:33,400 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:14:33,400 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:14:33,400 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:14:33,404 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:14:33,408 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:14:33,408 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:14:33,409 - DEBUG - üîç Relationship Details:
2025-11-13 13:14:33,409 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:14:33,409 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:14:33,409 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:14:33,409 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:14:33,409 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:14:33,409 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:14:33,409 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:14:33,409 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:14:33,409 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:14:33,409 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:14:33,409 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:14:33,409 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:14:33,409 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:14:33,409 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:14:35,957 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:14:35,958 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:14:35,958 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:14:36,128 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:14:36,366 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:14:36,382 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:14:36,382 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:14:36,398 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:14:36,413 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:14:36,422 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:14:36,441 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:14:36,447 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:14:36,450 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:14:36,452 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:14:36,455 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:14:36,458 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:14:36,460 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:14:36,463 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:14:36,466 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:14:36,468 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:14:36,472 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:14:36,475 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:14:36,477 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:14:36,480 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:14:36,485 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:14:36,489 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:36,489 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:14:36,493 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:14:36,493 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:14:36,497 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:36,497 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:14:36,501 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:36,502 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:14:36,505 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:36,505 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:14:36,509 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:14:36,509 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:14:36,513 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:14:36,513 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:14:36,513 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:14:36,517 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:14:36,517 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:14:36,517 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:14:36,521 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:14:36,526 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:14:36,526 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:14:36,526 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:14:36,526 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:14:36,526 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:14:36,530 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:14:36,534 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:14:36,534 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:14:36,534 - DEBUG - üîç Relationship Details:
2025-11-13 13:14:36,534 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:14:36,534 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:14:36,534 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:14:36,534 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:14:36,534 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:14:36,534 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:14:36,534 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:14:36,535 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:14:36,535 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:14:36,535 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:14:36,535 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:14:36,535 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:14:36,535 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:14:36,535 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:14:36,535 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:14:36,536 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:14:37,207 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:14:37,223 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:14:37,223 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:14:37,237 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:14:37,243 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:14:37,246 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:14:37,250 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:14:37,253 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:14:37,256 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:14:37,259 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:14:37,263 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:14:37,266 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:14:37,269 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:14:37,272 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:14:37,276 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:14:37,278 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:14:37,281 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:14:37,287 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:14:37,291 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:37,292 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:14:37,296 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:14:37,296 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:14:37,300 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:37,300 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:14:37,305 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:37,305 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:14:37,310 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:14:37,310 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:14:37,317 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:14:37,317 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:14:37,322 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:14:37,322 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:14:37,322 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:14:37,327 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:14:37,327 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:14:37,327 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:14:37,331 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:14:37,336 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:14:37,336 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:14:37,336 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:14:37,336 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:14:37,336 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:14:37,341 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:14:37,345 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:14:37,345 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:14:37,346 - DEBUG - üîç Relationship Details:
2025-11-13 13:14:37,346 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:14:37,346 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:14:37,346 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:14:37,346 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:14:37,346 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:14:37,346 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:14:37,346 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:14:37,346 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:14:37,346 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:14:37,346 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:14:37,346 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:14:37,346 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:14:37,346 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:14:37,347 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:19:22,680 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:19:22,680 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:19:22,680 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:19:22,870 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:19:32,262 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:19:32,262 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:19:32,262 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:19:32,431 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:19:44,197 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:19:44,197 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:19:44,197 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:19:44,371 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:19:44,604 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:19:44,619 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:19:44,619 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:19:44,635 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:19:44,650 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:19:44,659 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:19:44,679 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:19:44,685 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:19:44,688 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:19:44,691 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:19:44,693 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:19:44,696 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:19:44,699 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:19:44,701 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:19:44,705 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:19:44,707 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:19:44,711 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:19:44,714 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:19:44,716 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:19:44,719 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:19:44,725 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:19:44,729 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:19:44,729 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:19:44,733 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:19:44,733 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:19:44,737 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:19:44,737 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:19:44,741 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:19:44,741 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:19:44,745 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:19:44,745 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:19:44,749 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:19:44,749 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:19:44,754 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:19:44,754 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:19:44,754 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:19:44,758 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:19:44,758 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:19:44,758 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:19:44,762 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:19:44,766 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:19:44,767 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:19:44,767 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:19:44,767 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:19:44,767 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:19:44,771 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:19:44,775 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:19:44,775 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:19:44,775 - DEBUG - üîç Relationship Details:
2025-11-13 13:19:44,775 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:19:44,775 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:19:44,775 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:19:44,776 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:19:44,776 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:19:44,776 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:19:44,776 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:19:44,776 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:19:44,776 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:19:44,776 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:19:44,776 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:19:44,776 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:19:44,776 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:19:44,776 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:19:44,777 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:19:44,777 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:19:45,436 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:19:45,452 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:19:45,452 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:19:45,465 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:19:45,469 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:19:45,472 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:19:45,474 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:19:45,477 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:19:45,479 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:19:45,482 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:19:45,485 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:19:45,488 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:19:45,491 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:19:45,493 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:19:45,496 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:19:45,498 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:19:45,501 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:19:45,506 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:19:45,510 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:19:45,510 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:19:45,514 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:19:45,514 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:19:45,518 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:19:45,519 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:19:45,523 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:19:45,523 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:19:45,527 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:19:45,527 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:19:45,531 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:19:45,531 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:19:45,535 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:19:45,535 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:19:45,535 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:19:45,539 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:19:45,539 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:19:45,539 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:19:45,543 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:19:45,548 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:19:45,548 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:19:45,548 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:19:45,548 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:19:45,548 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:19:45,552 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:19:45,556 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:19:45,556 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:19:45,557 - DEBUG - üîç Relationship Details:
2025-11-13 13:19:45,557 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:19:45,557 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:19:45,557 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:19:45,557 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:19:45,557 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:19:45,557 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:19:45,557 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:19:45,557 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:19:45,557 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:19:45,557 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:19:45,557 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:19:45,557 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:19:45,557 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:19:45,557 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:20:11,866 - INFO - Database engine created with pool_size=10
2025-11-13 13:20:12,448 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 13:22:17,594 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:22:17,594 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:22:17,594 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:22:17,769 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:22:18,007 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:18,023 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:18,023 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:18,038 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:18,053 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:18,062 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:22:18,081 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:22:18,087 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:22:18,090 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:22:18,093 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:22:18,095 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:22:18,098 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:22:18,101 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:22:18,103 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:22:18,106 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:22:18,109 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:22:18,113 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:22:18,116 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:22:18,118 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:22:18,121 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:22:18,127 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:22:18,131 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:18,131 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:18,135 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:22:18,135 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:22:18,139 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:18,139 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:18,143 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:18,143 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:22:18,147 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:18,147 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:22:18,151 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:22:18,151 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:22:18,155 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:22:18,155 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:22:18,155 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:22:18,159 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:22:18,159 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:22:18,160 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:22:18,163 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:22:18,167 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:22:18,167 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:22:18,168 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:22:18,168 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:22:18,168 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:22:18,172 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:22:18,175 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:22:18,175 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:22:18,176 - DEBUG - üîç Relationship Details:
2025-11-13 13:22:18,176 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:18,176 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:22:18,176 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:18,176 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:22:18,176 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:22:18,176 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:22:18,176 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:22:18,176 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:22:18,176 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:22:18,176 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:22:18,176 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:22:18,176 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:22:18,176 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:22:18,176 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:22:18,177 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:22:18,177 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:22:18,889 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:18,905 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:18,906 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:22:18,919 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:22:18,924 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:22:18,928 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:22:18,931 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:22:18,934 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:22:18,937 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:22:18,940 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:22:18,944 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:22:18,947 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:22:18,951 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:22:18,954 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:22:18,959 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:22:18,963 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:22:18,966 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:22:18,972 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:22:18,977 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:18,977 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:18,981 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:22:18,981 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:22:18,986 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:18,986 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:18,991 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:18,992 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:22:18,997 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:18,997 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:22:19,002 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:22:19,002 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:22:19,008 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:22:19,008 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:22:19,008 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:22:19,013 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:22:19,013 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:22:19,013 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:22:19,019 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:22:19,024 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:22:19,024 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:22:19,024 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:22:19,024 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:22:19,024 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:22:19,029 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:22:19,034 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:22:19,034 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:22:19,034 - DEBUG - üîç Relationship Details:
2025-11-13 13:22:19,034 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:19,034 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:22:19,034 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:19,034 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:22:19,035 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:22:19,035 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:22:19,035 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:22:19,035 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:22:19,035 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:22:19,035 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:22:19,035 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:22:19,035 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:22:19,035 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:22:19,035 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:22:19,969 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:22:19,969 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:22:19,969 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:22:20,137 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:22:20,375 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:20,391 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:20,391 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:20,407 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:20,423 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:20,432 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:22:20,454 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:22:20,460 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:22:20,464 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:22:20,467 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:22:20,470 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:22:20,472 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:22:20,475 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:22:20,478 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:22:20,481 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:22:20,484 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:22:20,488 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:22:20,491 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:22:20,494 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:22:20,497 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:22:20,502 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:22:20,506 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:20,506 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:20,510 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:22:20,510 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:22:20,515 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:20,515 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:20,519 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:20,519 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:22:20,524 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:20,524 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:22:20,528 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:22:20,528 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:22:20,532 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:22:20,532 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:22:20,532 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:22:20,536 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:22:20,536 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:22:20,536 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:22:20,540 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:22:20,545 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:22:20,545 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:22:20,545 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:22:20,545 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:22:20,545 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:22:20,549 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:22:20,553 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:22:20,553 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:22:20,553 - DEBUG - üîç Relationship Details:
2025-11-13 13:22:20,553 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:20,554 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:22:20,554 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:20,554 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:22:20,554 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:22:20,554 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:22:20,554 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:22:20,554 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:22:20,554 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:22:20,554 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:22:20,554 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:22:20,554 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:22:20,554 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:22:20,554 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:22:20,554 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:22:20,555 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:22:21,215 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:21,231 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:21,232 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:22:21,245 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:22:21,249 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:22:21,252 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:22:21,255 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:22:21,257 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:22:21,260 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:22:21,263 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:22:21,266 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:22:21,269 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:22:21,272 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:22:21,275 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:22:21,278 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:22:21,280 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:22:21,283 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:22:21,289 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:22:21,294 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:21,294 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:21,298 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:22:21,298 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:22:21,302 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:21,302 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:21,307 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:21,307 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:22:21,312 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:21,312 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:22:21,316 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:22:21,317 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:22:21,321 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:22:21,321 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:22:21,322 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:22:21,326 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:22:21,326 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:22:21,326 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:22:21,330 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:22:21,334 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:22:21,335 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:22:21,335 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:22:21,335 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:22:21,335 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:22:21,339 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:22:21,343 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:22:21,343 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:22:21,343 - DEBUG - üîç Relationship Details:
2025-11-13 13:22:21,343 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:21,344 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:22:21,344 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:21,344 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:22:21,344 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:22:21,344 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:22:21,344 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:22:21,344 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:22:21,344 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:22:21,344 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:22:21,344 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:22:21,344 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:22:21,344 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:22:21,344 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:22:26,174 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:22:26,174 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:22:26,175 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:22:26,340 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:22:26,572 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:26,587 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:26,587 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:26,602 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:26,617 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:26,626 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:22:26,645 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:22:26,651 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:22:26,654 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:22:26,656 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:22:26,659 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:22:26,661 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:22:26,664 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:22:26,666 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:22:26,669 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:22:26,672 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:22:26,675 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:22:26,678 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:22:26,680 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:22:26,683 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:22:26,688 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:22:26,693 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:26,693 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:26,697 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:22:26,697 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:22:26,701 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:26,701 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:26,705 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:26,705 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:22:26,709 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:26,709 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:22:26,713 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:22:26,713 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:22:26,717 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:22:26,717 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:22:26,717 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:22:26,721 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:22:26,721 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:22:26,721 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:22:26,725 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:22:26,729 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:22:26,730 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:22:26,730 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:22:26,730 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:22:26,730 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:22:26,734 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:22:26,737 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:22:26,738 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:22:26,738 - DEBUG - üîç Relationship Details:
2025-11-13 13:22:26,738 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:26,738 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:22:26,738 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:26,738 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:22:26,738 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:22:26,738 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:22:26,738 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:22:26,738 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:22:26,738 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:22:26,738 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:22:26,738 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:22:26,738 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:22:26,738 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:22:26,738 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:22:26,739 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:22:26,739 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:22:27,394 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:27,409 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:27,410 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:22:27,422 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:22:27,427 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:22:27,429 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:22:27,432 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:22:27,435 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:22:27,437 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:22:27,440 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:22:27,443 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:22:27,446 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:22:27,448 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:22:27,451 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:22:27,454 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:22:27,456 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:22:27,459 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:22:27,464 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:22:27,468 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:27,468 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:27,473 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:22:27,473 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:22:27,477 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:27,477 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:27,481 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:27,482 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:22:27,486 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:27,486 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:22:27,490 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:22:27,490 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:22:27,495 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:22:27,495 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:22:27,495 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:22:27,499 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:22:27,500 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:22:27,500 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:22:27,503 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:22:27,508 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:22:27,508 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:22:27,508 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:22:27,508 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:22:27,508 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:22:27,512 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:22:27,516 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:22:27,516 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:22:27,516 - DEBUG - üîç Relationship Details:
2025-11-13 13:22:27,516 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:27,516 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:22:27,516 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:27,516 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:22:27,516 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:22:27,517 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:22:27,517 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:22:27,517 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:22:27,517 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:22:27,517 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:22:27,517 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:22:27,517 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:22:27,517 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:22:27,517 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:22:34,957 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:22:34,957 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:22:34,957 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:22:35,125 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:22:35,362 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:35,378 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:35,378 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:35,393 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:35,408 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:35,417 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:22:35,437 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:22:35,443 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:22:35,446 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:22:35,448 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:22:35,451 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:22:35,453 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:22:35,456 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:22:35,458 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:22:35,461 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:22:35,464 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:22:35,468 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:22:35,471 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:22:35,473 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:22:35,476 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:22:35,482 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:22:35,486 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:35,487 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:35,490 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:22:35,490 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:22:35,494 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:35,494 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:35,498 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:35,498 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:22:35,502 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:35,502 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:22:35,506 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:22:35,506 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:22:35,510 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:22:35,511 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:22:35,511 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:22:35,515 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:22:35,515 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:22:35,515 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:22:35,519 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:22:35,523 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:22:35,523 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:22:35,523 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:22:35,523 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:22:35,523 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:22:35,527 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:22:35,531 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:22:35,531 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:22:35,531 - DEBUG - üîç Relationship Details:
2025-11-13 13:22:35,532 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:35,532 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:22:35,532 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:35,532 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:22:35,532 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:22:35,532 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:22:35,532 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:22:35,532 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:22:35,532 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:22:35,532 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:22:35,532 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:22:35,532 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:22:35,532 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:22:35,532 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:22:35,533 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:22:35,533 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:22:36,201 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:22:36,217 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:22:36,218 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:22:36,230 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:22:36,235 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:22:36,237 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:22:36,240 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:22:36,243 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:22:36,245 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:22:36,248 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:22:36,251 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:22:36,254 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:22:36,257 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:22:36,259 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:22:36,262 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:22:36,265 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:22:36,268 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:22:36,273 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:22:36,277 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:36,277 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:36,281 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:22:36,282 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:22:36,286 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:36,286 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:22:36,290 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:36,290 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:22:36,294 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:22:36,294 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:22:36,298 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:22:36,298 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:22:36,302 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:22:36,302 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:22:36,302 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:22:36,307 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:22:36,307 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:22:36,307 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:22:36,311 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:22:36,315 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:22:36,315 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:22:36,315 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:22:36,316 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:22:36,316 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:22:36,320 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:22:36,325 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:22:36,325 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:22:36,325 - DEBUG - üîç Relationship Details:
2025-11-13 13:22:36,325 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:36,325 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:22:36,325 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:22:36,325 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:22:36,325 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:22:36,325 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:22:36,325 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:22:36,325 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:22:36,326 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:22:36,326 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:22:36,326 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:22:36,326 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:22:36,326 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:22:36,326 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:23:12,634 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:23:12,634 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:23:12,634 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:23:12,805 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:23:13,046 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:13,061 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:13,061 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:13,076 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:13,091 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:13,100 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:23:13,120 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:23:13,127 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:23:13,131 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:23:13,134 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:23:13,137 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:23:13,140 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:23:13,144 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:23:13,147 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:23:13,151 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:23:13,156 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:23:13,162 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:23:13,167 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:23:13,170 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:23:13,173 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:23:13,181 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:23:13,186 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:13,186 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:13,191 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:23:13,191 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:23:13,196 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:13,196 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:13,201 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:13,201 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:23:13,207 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:13,208 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:23:13,215 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:23:13,215 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:23:13,220 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:23:13,221 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:23:13,221 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:23:13,226 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:23:13,226 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:23:13,227 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:23:13,232 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:23:13,238 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:23:13,238 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:23:13,238 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:23:13,238 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:23:13,238 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:23:13,244 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:23:13,251 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:23:13,251 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:23:13,251 - DEBUG - üîç Relationship Details:
2025-11-13 13:23:13,251 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:13,251 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:23:13,251 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:13,251 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:23:13,251 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:23:13,251 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:23:13,251 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:23:13,251 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:23:13,251 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:23:13,251 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:23:13,251 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:23:13,251 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:23:13,252 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:23:13,252 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:23:13,252 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:23:13,252 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:23:14,037 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:14,052 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:14,053 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:23:14,066 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:23:14,071 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:23:14,074 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:23:14,076 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:23:14,079 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:23:14,082 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:23:14,084 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:23:14,088 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:23:14,091 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:23:14,094 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:23:14,096 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:23:14,099 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:23:14,102 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:23:14,105 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:23:14,110 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:23:14,114 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:14,115 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:14,119 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:23:14,119 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:23:14,123 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:14,123 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:14,127 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:14,127 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:23:14,131 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:14,131 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:23:14,136 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:23:14,136 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:23:14,140 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:23:14,140 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:23:14,140 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:23:14,144 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:23:14,144 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:23:14,144 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:23:14,148 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:23:14,153 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:23:14,153 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:23:14,153 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:23:14,153 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:23:14,153 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:23:14,157 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:23:14,161 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:23:14,161 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:23:14,162 - DEBUG - üîç Relationship Details:
2025-11-13 13:23:14,162 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:14,162 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:23:14,162 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:14,162 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:23:14,162 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:23:14,162 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:23:14,162 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:23:14,162 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:23:14,162 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:23:14,162 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:23:14,162 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:23:14,162 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:23:14,162 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:23:14,162 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:23:21,194 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:23:21,194 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:23:21,194 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:23:21,362 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:23:21,597 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:21,612 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:21,612 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:21,627 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:21,642 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:21,651 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:23:21,670 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:23:21,676 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:23:21,679 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:23:21,682 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:23:21,684 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:23:21,687 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:23:21,689 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:23:21,692 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:23:21,695 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:23:21,698 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:23:21,701 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:23:21,704 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:23:21,707 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:23:21,709 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:23:21,715 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:23:21,719 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:21,719 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:21,723 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:23:21,723 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:23:21,727 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:21,727 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:21,731 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:21,731 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:23:21,735 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:21,735 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:23:21,739 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:23:21,739 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:23:21,743 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:23:21,744 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:23:21,744 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:23:21,748 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:23:21,748 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:23:21,748 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:23:21,752 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:23:21,757 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:23:21,757 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:23:21,757 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:23:21,757 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:23:21,757 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:23:21,761 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:23:21,765 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:23:21,765 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:23:21,765 - DEBUG - üîç Relationship Details:
2025-11-13 13:23:21,766 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:21,766 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:23:21,766 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:21,766 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:23:21,766 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:23:21,766 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:23:21,766 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:23:21,766 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:23:21,766 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:23:21,766 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:23:21,766 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:23:21,766 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:23:21,766 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:23:21,766 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:23:21,767 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:23:21,767 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:23:22,429 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:22,444 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:22,445 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:23:22,458 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:23:22,462 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:23:22,465 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:23:22,468 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:23:22,471 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:23:22,473 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:23:22,476 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:23:22,479 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:23:22,482 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:23:22,485 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:23:22,488 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:23:22,491 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:23:22,493 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:23:22,496 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:23:22,502 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:23:22,506 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:22,506 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:22,510 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:23:22,510 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:23:22,514 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:22,514 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:22,519 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:22,519 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:23:22,523 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:22,523 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:23:22,527 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:23:22,527 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:23:22,531 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:23:22,531 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:23:22,531 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:23:22,536 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:23:22,536 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:23:22,536 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:23:22,540 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:23:22,544 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:23:22,544 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:23:22,544 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:23:22,544 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:23:22,544 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:23:22,549 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:23:22,553 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:23:22,553 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:23:22,553 - DEBUG - üîç Relationship Details:
2025-11-13 13:23:22,554 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:22,554 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:23:22,554 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:22,554 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:23:22,554 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:23:22,554 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:23:22,554 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:23:22,554 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:23:22,554 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:23:22,554 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:23:22,554 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:23:22,554 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:23:22,554 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:23:22,554 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:23:36,106 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 13:23:36,106 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 13:23:36,106 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 13:23:36,278 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 13:23:36,512 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:36,527 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:36,528 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:36,543 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:36,558 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:36,567 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:23:36,586 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:23:36,592 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:23:36,595 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:23:36,597 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:23:36,600 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:23:36,603 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:23:36,605 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:23:36,608 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:23:36,611 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:23:36,614 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:23:36,617 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:23:36,620 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:23:36,623 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:23:36,625 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:23:36,631 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:23:36,635 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:36,635 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:36,639 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:23:36,639 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:23:36,643 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:36,643 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:36,647 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:36,647 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:23:36,651 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:36,652 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:23:36,656 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:23:36,656 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:23:36,660 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:23:36,660 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:23:36,660 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:23:36,664 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:23:36,664 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:23:36,664 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:23:36,669 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:23:36,673 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:23:36,673 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:23:36,673 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:23:36,673 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:23:36,673 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:23:36,677 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:23:36,682 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:23:36,682 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:23:36,682 - DEBUG - üîç Relationship Details:
2025-11-13 13:23:36,682 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:36,682 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:23:36,682 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:36,682 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:23:36,682 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:23:36,682 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:23:36,682 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:23:36,682 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:23:36,682 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:23:36,682 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:23:36,682 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:23:36,682 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:23:36,682 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:23:36,682 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:23:36,683 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 13:23:36,683 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 13:23:37,347 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 13:23:37,363 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 13:23:37,363 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 13:23:37,378 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 13:23:37,382 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 13:23:37,385 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 13:23:37,388 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 13:23:37,390 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 13:23:37,393 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 13:23:37,396 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 13:23:37,399 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 13:23:37,402 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 13:23:37,404 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 13:23:37,407 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 13:23:37,410 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 13:23:37,412 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 13:23:37,415 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 13:23:37,420 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 13:23:37,425 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:37,425 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:37,429 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 13:23:37,429 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 13:23:37,433 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:37,433 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 13:23:37,437 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:37,437 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 13:23:37,441 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 13:23:37,441 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 13:23:37,445 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 13:23:37,445 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 13:23:37,449 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 13:23:37,450 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 13:23:37,450 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 13:23:37,454 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 13:23:37,454 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 13:23:37,454 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 13:23:37,458 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 13:23:37,463 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 13:23:37,463 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 13:23:37,463 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 13:23:37,463 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 13:23:37,463 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 13:23:37,467 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 13:23:37,471 - DEBUG - üîó Foreign keys for users: []
2025-11-13 13:23:37,471 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 13:23:37,471 - DEBUG - üîç Relationship Details:
2025-11-13 13:23:37,471 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:37,471 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 13:23:37,471 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 13:23:37,471 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 13:23:37,471 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 13:23:37,472 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 13:23:37,472 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 13:23:37,472 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 13:23:37,472 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 13:23:37,472 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 13:23:37,472 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 13:23:37,472 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 13:23:37,472 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 13:23:37,472 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 13:31:09,980 - INFO - Database engine created with pool_size=10
2025-11-13 13:31:09,980 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 13:31:09,981 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 13:31:10,364 - INFO - SQLModel query returned 53 rows
2025-11-13 13:31:10,365 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 13:31:10,365 - DEBUG - Starting to process and group results
2025-11-13 13:31:10,365 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 13:31:10,365 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 13:31:10,365 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 13:31:10,365 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 13:31:10,365 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 13:31:10,365 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 13:31:10,365 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 13:31:10,365 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 13:31:10,365 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 13:31:10,365 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 13:31:10,365 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 13:31:10,365 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 13:31:10,365 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 13:31:10,365 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 13:31:10,365 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 13:31:10,366 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 13:31:10,366 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 13:31:10,366 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 13:31:10,366 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 13:31:10,366 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 13:31:10,366 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 13:31:10,366 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 13:31:10,366 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 13:31:10,366 - DEBUG - Converting to final data structure
2025-11-13 13:31:10,366 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 13:31:10,366 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 13:31:10,366 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 13:31:10,366 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 13:31:10,366 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 13:31:10,367 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 13:35:03,083 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 13:37:35,299 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 15:13:31,356 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 15:13:31,356 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 15:13:31,356 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 15:13:31,527 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 15:13:31,770 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 15:13:31,786 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 15:13:31,786 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 15:13:31,802 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 15:13:31,817 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 15:13:31,826 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 15:13:32,961 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 15:13:32,968 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 15:13:32,970 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 15:13:32,973 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 15:13:32,976 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 15:13:32,979 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 15:13:32,981 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 15:13:32,984 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 15:13:32,987 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 15:13:32,989 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 15:13:32,993 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 15:13:32,996 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 15:13:32,998 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 15:13:33,001 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 15:13:33,007 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 15:13:33,013 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 15:13:33,013 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 15:13:33,017 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 15:13:33,017 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 15:13:33,022 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 15:13:33,022 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 15:13:33,026 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 15:13:33,026 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 15:13:33,030 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 15:13:33,030 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 15:13:33,034 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 15:13:33,034 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 15:13:33,039 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 15:13:33,039 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 15:13:33,039 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 15:13:33,044 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 15:13:33,044 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 15:13:33,044 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 15:13:33,048 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 15:13:33,053 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 15:13:33,053 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 15:13:33,053 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 15:13:33,053 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 15:13:33,053 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 15:13:33,057 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 15:13:33,061 - DEBUG - üîó Foreign keys for users: []
2025-11-13 15:13:33,061 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 15:13:33,061 - DEBUG - üîç Relationship Details:
2025-11-13 15:13:33,062 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,062 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 15:13:33,062 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,062 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,062 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,062 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 15:13:33,062 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,062 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 15:13:33,062 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,062 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 15:13:33,062 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 15:13:33,062 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 15:13:33,062 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 15:13:33,062 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 15:13:33,063 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 15:13:33,063 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 15:13:33,771 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 15:13:33,790 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 15:13:33,791 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 15:13:33,803 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 15:13:33,808 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 15:13:33,810 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 15:13:33,813 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 15:13:33,815 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 15:13:33,818 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 15:13:33,821 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 15:13:33,824 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 15:13:33,827 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 15:13:33,829 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 15:13:33,832 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 15:13:33,835 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 15:13:33,837 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 15:13:33,840 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 15:13:33,845 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 15:13:33,851 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 15:13:33,851 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 15:13:33,855 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 15:13:33,855 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 15:13:33,859 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 15:13:33,859 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 15:13:33,863 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 15:13:33,863 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 15:13:33,867 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 15:13:33,867 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 15:13:33,871 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 15:13:33,872 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 15:13:33,876 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 15:13:33,876 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 15:13:33,876 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 15:13:33,880 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 15:13:33,880 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 15:13:33,881 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 15:13:33,885 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 15:13:33,889 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 15:13:33,889 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 15:13:33,889 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 15:13:33,889 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 15:13:33,889 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 15:13:33,893 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 15:13:33,898 - DEBUG - üîó Foreign keys for users: []
2025-11-13 15:13:33,898 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 15:13:33,898 - DEBUG - üîç Relationship Details:
2025-11-13 15:13:33,898 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,898 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 15:13:33,898 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,898 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,898 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,898 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 15:13:33,898 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,898 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 15:13:33,898 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 15:13:33,898 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 15:13:33,898 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 15:13:33,898 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 15:13:33,898 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 15:13:33,899 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 15:14:09,525 - INFO - Database engine created with pool_size=10
2025-11-13 15:14:09,525 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 15:14:09,526 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 15:14:09,558 - INFO - SQLModel query returned 53 rows
2025-11-13 15:14:09,558 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 15:14:09,559 - DEBUG - Starting to process and group results
2025-11-13 15:14:09,559 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:14:09,559 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 15:14:09,559 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:14:09,559 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 15:14:09,559 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 15:14:09,559 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 15:14:09,559 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:14:09,559 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 15:14:09,559 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 15:14:09,559 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 15:14:09,559 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 15:14:09,559 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 15:14:09,560 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:14:09,560 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 15:14:09,560 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 15:14:09,560 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 15:14:09,560 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 15:14:09,560 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 15:14:09,560 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 15:14:09,560 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 15:14:09,560 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 15:14:09,560 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 15:14:09,560 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 15:14:09,561 - DEBUG - Converting to final data structure
2025-11-13 15:14:09,561 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 15:14:09,561 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 15:14:09,561 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 15:14:09,561 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 15:14:09,561 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 15:14:09,561 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 15:14:22,248 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 15:14:24,823 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 15:15:01,034 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 15:16:51,199 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 15:36:50,460 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 15:36:50,460 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 15:36:50,527 - INFO - SQLModel query returned 53 rows
2025-11-13 15:36:50,527 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 15:36:50,527 - DEBUG - Starting to process and group results
2025-11-13 15:36:50,527 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:36:50,527 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 15:36:50,527 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:36:50,527 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 15:36:50,527 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 15:36:50,527 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 15:36:50,527 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:36:50,527 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 15:36:50,527 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 15:36:50,527 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 15:36:50,527 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 15:36:50,527 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 15:36:50,527 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:36:50,528 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 15:36:50,528 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 15:36:50,528 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 15:36:50,528 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 15:36:50,528 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 15:36:50,528 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 15:36:50,528 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 15:36:50,528 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 15:36:50,528 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 15:36:50,528 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 15:36:50,528 - DEBUG - Converting to final data structure
2025-11-13 15:36:50,528 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 15:36:50,528 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 15:36:50,528 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 15:36:50,528 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 15:36:50,528 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 15:36:50,557 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 15:39:38,272 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 15:40:56,997 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 15:40:56,997 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 15:40:57,000 - INFO - SQLModel query returned 53 rows
2025-11-13 15:40:57,000 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 15:40:57,000 - DEBUG - Starting to process and group results
2025-11-13 15:40:57,000 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:40:57,000 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 15:40:57,000 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:40:57,000 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 15:40:57,000 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 15:40:57,000 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 15:40:57,000 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:40:57,000 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 15:40:57,000 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 15:40:57,001 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 15:40:57,001 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 15:40:57,001 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 15:40:57,002 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 15:40:57,002 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 15:40:57,002 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 15:40:57,002 - DEBUG - Converting to final data structure
2025-11-13 15:40:57,002 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 15:40:57,002 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 15:40:57,002 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 15:40:57,002 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 15:40:57,002 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 15:40:57,003 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 15:41:50,975 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 15:41:50,975 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 15:41:50,983 - INFO - SQLModel query returned 53 rows
2025-11-13 15:41:50,983 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 15:41:50,983 - DEBUG - Starting to process and group results
2025-11-13 15:41:50,983 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:41:50,983 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 15:41:50,983 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:41:50,983 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 15:41:50,983 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 15:41:50,983 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 15:41:50,983 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:41:50,983 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 15:41:50,983 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 15:41:50,983 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 15:41:50,983 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 15:41:50,983 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 15:41:50,983 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:41:50,983 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 15:41:50,983 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 15:41:50,984 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 15:41:50,984 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 15:41:50,984 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 15:41:50,984 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 15:41:50,984 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 15:41:50,984 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 15:41:50,984 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 15:41:50,984 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 15:41:50,984 - DEBUG - Converting to final data structure
2025-11-13 15:41:50,984 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 15:41:50,984 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 15:41:50,984 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 15:41:50,984 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 15:41:50,984 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 15:41:50,985 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 15:45:13,742 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 15:46:07,090 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 15:46:07,090 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 15:46:07,093 - INFO - SQLModel query returned 53 rows
2025-11-13 15:46:07,093 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 15:46:07,093 - DEBUG - Starting to process and group results
2025-11-13 15:46:07,093 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:46:07,093 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 15:46:07,093 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:46:07,093 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 15:46:07,093 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 15:46:07,093 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 15:46:07,093 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:46:07,093 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 15:46:07,093 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 15:46:07,093 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 15:46:07,093 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 15:46:07,093 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 15:46:07,094 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:46:07,094 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 15:46:07,094 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 15:46:07,094 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 15:46:07,094 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 15:46:07,094 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 15:46:07,094 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 15:46:07,094 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 15:46:07,094 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 15:46:07,094 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 15:46:07,094 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 15:46:07,094 - DEBUG - Converting to final data structure
2025-11-13 15:46:07,095 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 15:46:07,095 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 15:46:07,095 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 15:46:07,095 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 15:46:07,095 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 15:46:07,095 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 15:49:03,290 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 15:50:22,875 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 15:50:22,875 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 15:50:22,878 - INFO - SQLModel query returned 53 rows
2025-11-13 15:50:22,878 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 15:50:22,878 - DEBUG - Starting to process and group results
2025-11-13 15:50:22,878 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:50:22,878 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 15:50:22,878 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:50:22,878 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 15:50:22,878 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 15:50:22,878 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 15:50:22,878 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 15:50:22,878 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 15:50:22,878 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 15:50:22,878 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 15:50:22,878 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 15:50:22,879 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 15:50:22,879 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 15:50:22,879 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 15:50:22,879 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 15:50:22,880 - DEBUG - Converting to final data structure
2025-11-13 15:50:22,880 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 15:50:22,880 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 15:50:22,880 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 15:50:22,880 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 15:50:22,880 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 15:50:22,880 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 15:50:41,975 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-13 20:31:42,852 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-13 20:31:42,852 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-13 20:31:42,852 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-13 20:31:43,140 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-13 20:31:43,568 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 20:31:43,606 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 20:31:43,606 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 20:31:43,621 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 20:31:43,635 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 20:31:43,650 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 20:31:43,868 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 20:31:43,874 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 20:31:43,877 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 20:31:43,880 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 20:31:43,882 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 20:31:43,885 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 20:31:43,888 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 20:31:43,890 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 20:31:43,893 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 20:31:43,896 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 20:31:43,899 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 20:31:43,903 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 20:31:43,905 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 20:31:43,908 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 20:31:43,914 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 20:31:43,918 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 20:31:43,918 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 20:31:43,922 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 20:31:43,922 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 20:31:43,926 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 20:31:43,926 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 20:31:43,931 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 20:31:43,931 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 20:31:43,935 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 20:31:43,935 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 20:31:43,939 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 20:31:43,939 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 20:31:43,943 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 20:31:43,943 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 20:31:43,943 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 20:31:43,948 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 20:31:43,948 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 20:31:43,948 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 20:31:43,952 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 20:31:43,956 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 20:31:43,956 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 20:31:43,956 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 20:31:43,957 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 20:31:43,957 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 20:31:43,960 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 20:31:43,965 - DEBUG - üîó Foreign keys for users: []
2025-11-13 20:31:43,965 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 20:31:43,965 - DEBUG - üîç Relationship Details:
2025-11-13 20:31:43,965 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 20:31:43,965 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 20:31:43,965 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 20:31:43,965 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 20:31:43,965 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 20:31:43,965 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 20:31:43,965 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 20:31:43,965 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 20:31:43,965 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 20:31:43,965 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 20:31:43,965 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 20:31:43,965 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 20:31:43,965 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 20:31:43,965 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 20:31:43,989 - INFO - üìå Loaded conversation memory from disk.
2025-11-13 20:31:43,989 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-13 20:31:46,044 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-13 20:31:46,059 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-13 20:31:46,060 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-13 20:31:46,073 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-13 20:31:46,078 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-13 20:31:46,080 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-13 20:31:46,083 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-13 20:31:46,086 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-13 20:31:46,089 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-13 20:31:46,092 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-13 20:31:46,095 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-13 20:31:46,098 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-13 20:31:46,101 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-13 20:31:46,104 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-13 20:31:46,107 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-13 20:31:46,110 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-13 20:31:46,113 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-13 20:31:46,118 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-13 20:31:46,123 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 20:31:46,123 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-13 20:31:46,128 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-13 20:31:46,128 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-13 20:31:46,132 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 20:31:46,133 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-13 20:31:46,137 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 20:31:46,137 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-13 20:31:46,141 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-13 20:31:46,141 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-13 20:31:46,146 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-13 20:31:46,146 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-13 20:31:46,151 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-13 20:31:46,151 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-13 20:31:46,152 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-13 20:31:46,156 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-13 20:31:46,156 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-13 20:31:46,156 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-13 20:31:46,160 - DEBUG - üîó Foreign keys for ships: []
2025-11-13 20:31:46,165 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-13 20:31:46,165 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-13 20:31:46,165 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-13 20:31:46,165 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-13 20:31:46,165 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-13 20:31:46,169 - DEBUG - üîó Foreign keys for systems: []
2025-11-13 20:31:46,173 - DEBUG - üîó Foreign keys for users: []
2025-11-13 20:31:46,173 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-13 20:31:46,173 - DEBUG - üîç Relationship Details:
2025-11-13 20:31:46,174 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-13 20:31:46,174 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-13 20:31:46,174 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-13 20:31:46,174 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-13 20:31:46,174 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-13 20:31:46,174 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-13 20:31:46,174 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-13 20:31:46,174 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-13 20:31:46,174 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-13 20:31:46,174 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-13 20:31:46,174 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-13 20:31:46,174 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-13 20:31:46,174 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-13 20:31:46,175 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-13 20:31:59,438 - INFO - Database engine created with pool_size=10
2025-11-13 20:31:59,438 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-13 20:31:59,439 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-13 20:31:59,470 - INFO - SQLModel query returned 53 rows
2025-11-13 20:31:59,470 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-13 20:31:59,470 - DEBUG - Starting to process and group results
2025-11-13 20:31:59,470 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 20:31:59,470 - DEBUG - Creating new command group: Western Naval Command
2025-11-13 20:31:59,470 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 20:31:59,470 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-13 20:31:59,470 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-13 20:31:59,470 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-13 20:31:59,470 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-13 20:31:59,470 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-13 20:31:59,470 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-13 20:31:59,471 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-13 20:31:59,471 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-13 20:31:59,471 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-13 20:31:59,472 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-13 20:31:59,472 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-13 20:31:59,472 - INFO - Processed 3 unique ships into 1 command groups
2025-11-13 20:31:59,472 - DEBUG - Converting to final data structure
2025-11-13 20:31:59,472 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-13 20:31:59,472 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-13 20:31:59,472 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-13 20:31:59,472 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-13 20:31:59,472 - DEBUG - Command groups: ['Western Naval Command']
2025-11-13 20:31:59,473 - INFO - Successfully retrieved hierarchical ship data
2025-11-13 20:32:25,429 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-14 12:40:44,073 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-14 12:40:44,073 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-14 12:40:44,073 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-14 12:40:44,257 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-14 12:40:44,487 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-14 12:40:44,503 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-14 12:40:44,503 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-14 12:40:44,519 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-14 12:40:44,534 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-14 12:40:44,543 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-14 12:40:44,681 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-14 12:40:44,688 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-14 12:40:44,691 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-14 12:40:44,694 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-14 12:40:44,697 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-14 12:40:44,700 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-14 12:40:44,703 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-14 12:40:44,706 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-14 12:40:44,709 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-14 12:40:44,712 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-14 12:40:44,716 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-14 12:40:44,719 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-14 12:40:44,722 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-14 12:40:44,726 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-14 12:40:44,733 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-14 12:40:44,737 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-14 12:40:44,737 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-14 12:40:44,741 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-14 12:40:44,741 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-14 12:40:44,745 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-14 12:40:44,746 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-14 12:40:44,750 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-14 12:40:44,750 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-14 12:40:44,754 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-14 12:40:44,754 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-14 12:40:44,759 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-14 12:40:44,759 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-14 12:40:44,763 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-14 12:40:44,763 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-14 12:40:44,763 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-14 12:40:44,767 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-14 12:40:44,767 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-14 12:40:44,767 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-14 12:40:44,772 - DEBUG - üîó Foreign keys for ships: []
2025-11-14 12:40:44,776 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-14 12:40:44,776 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-14 12:40:44,776 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-14 12:40:44,776 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-14 12:40:44,776 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-14 12:40:44,781 - DEBUG - üîó Foreign keys for systems: []
2025-11-14 12:40:44,785 - DEBUG - üîó Foreign keys for users: []
2025-11-14 12:40:44,785 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-14 12:40:44,785 - DEBUG - üîç Relationship Details:
2025-11-14 12:40:44,785 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-14 12:40:44,785 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-14 12:40:44,785 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-14 12:40:44,785 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-14 12:40:44,785 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-14 12:40:44,786 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-14 12:40:44,786 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-14 12:40:44,786 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-14 12:40:44,786 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-14 12:40:44,786 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-14 12:40:44,786 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-14 12:40:44,786 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-14 12:40:44,786 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-14 12:40:44,786 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-14 12:40:44,787 - INFO - üìå Loaded conversation memory from disk.
2025-11-14 12:40:44,787 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-14 12:40:46,141 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-14 12:40:46,156 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-14 12:40:46,157 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-14 12:40:46,170 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-14 12:40:46,174 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-14 12:40:46,177 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-14 12:40:46,179 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-14 12:40:46,182 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-14 12:40:46,185 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-14 12:40:46,187 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-14 12:40:46,190 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-14 12:40:46,193 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-14 12:40:46,196 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-14 12:40:46,198 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-14 12:40:46,202 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-14 12:40:46,204 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-14 12:40:46,207 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-14 12:40:46,212 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-14 12:40:46,217 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-14 12:40:46,217 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-14 12:40:46,221 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-14 12:40:46,222 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-14 12:40:46,226 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-14 12:40:46,226 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-14 12:40:46,230 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-14 12:40:46,230 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-14 12:40:46,234 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-14 12:40:46,234 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-14 12:40:46,238 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-14 12:40:46,238 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-14 12:40:46,243 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-14 12:40:46,243 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-14 12:40:46,243 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-14 12:40:46,247 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-14 12:40:46,247 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-14 12:40:46,247 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-14 12:40:46,252 - DEBUG - üîó Foreign keys for ships: []
2025-11-14 12:40:46,256 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-14 12:40:46,256 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-14 12:40:46,256 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-14 12:40:46,256 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-14 12:40:46,256 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-14 12:40:46,260 - DEBUG - üîó Foreign keys for systems: []
2025-11-14 12:40:46,264 - DEBUG - üîó Foreign keys for users: []
2025-11-14 12:40:46,264 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-14 12:40:46,265 - DEBUG - üîç Relationship Details:
2025-11-14 12:40:46,265 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-14 12:40:46,265 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-14 12:40:46,265 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-14 12:40:46,265 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-14 12:40:46,265 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-14 12:40:46,265 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-14 12:40:46,265 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-14 12:40:46,265 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-14 12:40:46,265 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-14 12:40:46,265 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-14 12:40:46,265 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-14 12:40:46,265 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-14 12:40:46,265 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-14 12:40:46,265 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-14 13:58:31,796 - INFO - Database engine created with pool_size=10
2025-11-14 13:58:31,796 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-14 13:58:31,797 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-14 13:58:31,944 - INFO - SQLModel query returned 53 rows
2025-11-14 13:58:31,944 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-14 13:58:31,944 - DEBUG - Starting to process and group results
2025-11-14 13:58:31,944 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-14 13:58:31,944 - DEBUG - Creating new command group: Western Naval Command
2025-11-14 13:58:31,944 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-14 13:58:31,944 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-14 13:58:31,944 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-14 13:58:31,944 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-14 13:58:31,944 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-14 13:58:31,944 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-14 13:58:31,944 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-14 13:58:31,944 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-14 13:58:31,944 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-14 13:58:31,944 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-14 13:58:31,944 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-14 13:58:31,945 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-14 13:58:31,945 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-14 13:58:31,945 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-14 13:58:31,945 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-14 13:58:31,945 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-14 13:58:31,945 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-14 13:58:31,945 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-14 13:58:31,945 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-14 13:58:31,945 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-14 13:58:31,945 - INFO - Processed 3 unique ships into 1 command groups
2025-11-14 13:58:31,945 - DEBUG - Converting to final data structure
2025-11-14 13:58:31,945 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-14 13:58:31,945 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-14 13:58:31,945 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-14 13:58:31,945 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-14 13:58:31,945 - DEBUG - Command groups: ['Western Naval Command']
2025-11-14 13:58:31,946 - INFO - Successfully retrieved hierarchical ship data
2025-11-14 14:27:23,637 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-15 15:58:14,145 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-15 15:58:14,145 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-15 15:58:14,145 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-15 15:58:14,316 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-15 15:58:14,569 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-15 15:58:14,585 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-15 15:58:14,586 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-15 15:58:14,602 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-15 15:58:14,617 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-15 15:58:14,637 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-15 15:58:14,772 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-15 15:58:14,777 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-15 15:58:14,780 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-15 15:58:14,809 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-15 15:58:14,812 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-15 15:58:14,815 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-15 15:58:14,817 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-15 15:58:14,820 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-15 15:58:14,823 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-15 15:58:14,826 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-15 15:58:14,829 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-15 15:58:14,832 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-15 15:58:14,835 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-15 15:58:14,838 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-15 15:58:14,843 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-15 15:58:14,848 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-15 15:58:14,848 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-15 15:58:14,852 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-15 15:58:14,852 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-15 15:58:14,856 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-15 15:58:14,856 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-15 15:58:14,860 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-15 15:58:14,860 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-15 15:58:14,864 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-15 15:58:14,864 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-15 15:58:14,868 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-15 15:58:14,868 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-15 15:58:14,873 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-15 15:58:14,873 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-15 15:58:14,873 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-15 15:58:14,877 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-15 15:58:14,877 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-15 15:58:14,877 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-15 15:58:14,881 - DEBUG - üîó Foreign keys for ships: []
2025-11-15 15:58:14,886 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-15 15:58:14,886 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-15 15:58:14,886 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-15 15:58:14,886 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-15 15:58:14,886 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-15 15:58:14,890 - DEBUG - üîó Foreign keys for systems: []
2025-11-15 15:58:14,894 - DEBUG - üîó Foreign keys for users: []
2025-11-15 15:58:14,894 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-15 15:58:14,895 - DEBUG - üîç Relationship Details:
2025-11-15 15:58:14,895 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-15 15:58:14,895 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-15 15:58:14,895 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-15 15:58:14,895 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-15 15:58:14,895 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-15 15:58:14,895 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-15 15:58:14,895 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-15 15:58:14,895 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-15 15:58:14,895 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-15 15:58:14,895 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-15 15:58:14,895 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-15 15:58:14,895 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-15 15:58:14,895 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-15 15:58:14,896 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-15 15:58:14,896 - INFO - üìå Loaded conversation memory from disk.
2025-11-15 15:58:14,896 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-15 15:58:15,608 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-15 15:58:15,623 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-15 15:58:15,624 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-15 15:58:15,637 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-15 15:58:15,641 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-15 15:58:15,644 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-15 15:58:15,647 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-15 15:58:15,650 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-15 15:58:15,652 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-15 15:58:15,655 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-15 15:58:15,658 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-15 15:58:15,661 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-15 15:58:15,665 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-15 15:58:15,667 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-15 15:58:15,670 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-15 15:58:15,673 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-15 15:58:15,676 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-15 15:58:15,681 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-15 15:58:15,685 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-15 15:58:15,685 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-15 15:58:15,690 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-15 15:58:15,690 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-15 15:58:15,694 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-15 15:58:15,694 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-15 15:58:15,698 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-15 15:58:15,698 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-15 15:58:15,702 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-15 15:58:15,703 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-15 15:58:15,707 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-15 15:58:15,707 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-15 15:58:15,711 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-15 15:58:15,711 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-15 15:58:15,711 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-15 15:58:15,715 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-15 15:58:15,716 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-15 15:58:15,716 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-15 15:58:15,720 - DEBUG - üîó Foreign keys for ships: []
2025-11-15 15:58:15,724 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-15 15:58:15,724 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-15 15:58:15,724 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-15 15:58:15,724 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-15 15:58:15,724 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-15 15:58:15,729 - DEBUG - üîó Foreign keys for systems: []
2025-11-15 15:58:15,733 - DEBUG - üîó Foreign keys for users: []
2025-11-15 15:58:15,733 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-15 15:58:15,733 - DEBUG - üîç Relationship Details:
2025-11-15 15:58:15,734 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-15 15:58:15,734 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-15 15:58:15,734 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-15 15:58:15,734 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-15 15:58:15,734 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-15 15:58:15,734 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-15 15:58:15,734 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-15 15:58:15,734 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-15 15:58:15,734 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-15 15:58:15,734 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-15 15:58:15,734 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-15 15:58:15,734 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-15 15:58:15,734 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-15 15:58:15,734 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-15 15:58:59,960 - INFO - Database engine created with pool_size=10
2025-11-15 15:58:59,961 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-15 15:58:59,962 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-15 15:58:59,996 - INFO - SQLModel query returned 53 rows
2025-11-15 15:58:59,996 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-15 15:58:59,996 - DEBUG - Starting to process and group results
2025-11-15 15:58:59,997 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-15 15:58:59,997 - DEBUG - Creating new command group: Western Naval Command
2025-11-15 15:58:59,997 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-15 15:58:59,997 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-15 15:58:59,997 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-15 15:58:59,997 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-15 15:58:59,997 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-15 15:58:59,997 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-15 15:58:59,997 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-15 15:58:59,997 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-15 15:58:59,997 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-15 15:58:59,997 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-15 15:58:59,997 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-15 15:58:59,998 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-15 15:58:59,998 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-15 15:58:59,998 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-15 15:58:59,998 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-15 15:58:59,998 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-15 15:58:59,998 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-15 15:58:59,998 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-15 15:58:59,998 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-15 15:58:59,998 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-15 15:58:59,998 - INFO - Processed 3 unique ships into 1 command groups
2025-11-15 15:58:59,998 - DEBUG - Converting to final data structure
2025-11-15 15:58:59,998 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-15 15:58:59,999 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-15 15:58:59,999 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-15 15:58:59,999 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-15 15:58:59,999 - DEBUG - Command groups: ['Western Naval Command']
2025-11-15 15:58:59,999 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 14:35:59,683 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 14:35:59,683 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 14:35:59,683 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 14:35:59,862 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 14:36:00,094 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 14:36:00,109 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 14:36:00,109 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 14:36:00,125 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 14:36:00,140 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 14:36:00,191 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 14:36:00,348 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 14:36:00,353 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 14:36:00,356 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 14:36:00,359 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 14:36:00,362 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 14:36:00,364 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 14:36:00,367 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 14:36:00,370 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 14:36:00,373 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 14:36:00,376 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 14:36:00,379 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 14:36:00,382 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 14:36:00,384 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 14:36:00,387 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 14:36:00,393 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 14:36:00,397 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 14:36:00,397 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 14:36:00,402 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 14:36:00,402 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 14:36:00,406 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 14:36:00,406 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 14:36:00,410 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 14:36:00,410 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 14:36:00,414 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 14:36:00,414 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 14:36:00,418 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 14:36:00,418 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 14:36:00,422 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 14:36:00,422 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 14:36:00,422 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 14:36:00,427 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 14:36:00,427 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 14:36:00,427 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 14:36:00,431 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 14:36:00,435 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 14:36:00,435 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 14:36:00,435 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 14:36:00,436 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 14:36:00,436 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 14:36:00,440 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 14:36:00,444 - DEBUG - üîó Foreign keys for users: []
2025-11-17 14:36:00,444 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 14:36:00,444 - DEBUG - üîç Relationship Details:
2025-11-17 14:36:00,444 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 14:36:00,444 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 14:36:00,444 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 14:36:00,444 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 14:36:00,444 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 14:36:00,444 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 14:36:00,444 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 14:36:00,444 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 14:36:00,445 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 14:36:00,445 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 14:36:00,445 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 14:36:00,445 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 14:36:00,445 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 14:36:00,445 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 14:36:00,445 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 14:36:00,445 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 14:36:01,360 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 14:36:01,376 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 14:36:01,377 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 14:36:01,389 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 14:36:01,394 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 14:36:01,398 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 14:36:01,401 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 14:36:01,404 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 14:36:01,406 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 14:36:01,409 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 14:36:01,413 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 14:36:01,416 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 14:36:01,419 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 14:36:01,422 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 14:36:01,426 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 14:36:01,429 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 14:36:01,432 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 14:36:01,438 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 14:36:01,442 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 14:36:01,442 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 14:36:01,446 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 14:36:01,447 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 14:36:01,451 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 14:36:01,451 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 14:36:01,455 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 14:36:01,455 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 14:36:01,459 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 14:36:01,460 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 14:36:01,464 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 14:36:01,464 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 14:36:01,469 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 14:36:01,469 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 14:36:01,469 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 14:36:01,473 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 14:36:01,473 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 14:36:01,474 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 14:36:01,477 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 14:36:01,482 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 14:36:01,482 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 14:36:01,482 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 14:36:01,482 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 14:36:01,482 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 14:36:01,486 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 14:36:01,490 - DEBUG - üîó Foreign keys for users: []
2025-11-17 14:36:01,490 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 14:36:01,491 - DEBUG - üîç Relationship Details:
2025-11-17 14:36:01,491 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 14:36:01,491 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 14:36:01,491 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 14:36:01,491 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 14:36:01,491 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 14:36:01,491 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 14:36:01,491 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 14:36:01,491 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 14:36:01,491 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 14:36:01,491 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 14:36:01,491 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 14:36:01,491 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 14:36:01,491 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 14:36:01,492 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 14:36:16,279 - INFO - Database engine created with pool_size=10
2025-11-17 14:36:16,279 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 14:36:16,280 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 14:36:16,311 - INFO - SQLModel query returned 53 rows
2025-11-17 14:36:16,312 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-17 14:36:16,312 - DEBUG - Starting to process and group results
2025-11-17 14:36:16,312 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 14:36:16,312 - DEBUG - Creating new command group: Western Naval Command
2025-11-17 14:36:16,312 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 14:36:16,312 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-17 14:36:16,312 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-17 14:36:16,312 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-17 14:36:16,312 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 14:36:16,312 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-17 14:36:16,312 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-17 14:36:16,312 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-17 14:36:16,312 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-17 14:36:16,313 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-17 14:36:16,313 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-17 14:36:16,313 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-17 14:36:16,314 - INFO - Processed 3 unique ships into 1 command groups
2025-11-17 14:36:16,314 - DEBUG - Converting to final data structure
2025-11-17 14:36:16,314 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-17 14:36:16,314 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-17 14:36:16,314 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-17 14:36:16,314 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-17 14:36:16,314 - DEBUG - Command groups: ['Western Naval Command']
2025-11-17 14:36:16,314 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 14:36:50,684 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-17 19:05:02,057 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 19:05:02,057 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 19:05:02,145 - INFO - SQLModel query returned 53 rows
2025-11-17 19:05:02,145 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-17 19:05:02,145 - DEBUG - Starting to process and group results
2025-11-17 19:05:02,145 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 19:05:02,146 - DEBUG - Creating new command group: Western Naval Command
2025-11-17 19:05:02,146 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 19:05:02,146 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-17 19:05:02,146 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-17 19:05:02,146 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-17 19:05:02,146 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 19:05:02,146 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-17 19:05:02,146 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-17 19:05:02,146 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-17 19:05:02,146 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-17 19:05:02,146 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-17 19:05:02,146 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 19:05:02,146 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-17 19:05:02,146 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-17 19:05:02,146 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-17 19:05:02,147 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-17 19:05:02,147 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-17 19:05:02,147 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-17 19:05:02,147 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-17 19:05:02,147 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-17 19:05:02,147 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-17 19:05:02,147 - INFO - Processed 3 unique ships into 1 command groups
2025-11-17 19:05:02,147 - DEBUG - Converting to final data structure
2025-11-17 19:05:02,147 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-17 19:05:02,147 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-17 19:05:02,147 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-17 19:05:02,147 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-17 19:05:02,148 - DEBUG - Command groups: ['Western Naval Command']
2025-11-17 19:05:02,176 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 19:08:09,495 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-17 19:27:19,399 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:27:19,399 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:27:19,399 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:27:19,800 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 19:27:20,533 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:27:20,570 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:27:20,571 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:27:20,586 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:27:20,602 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:27:20,659 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 19:27:20,760 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 19:27:20,766 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 19:27:20,770 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 19:27:20,773 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 19:27:20,775 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 19:27:20,778 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 19:27:20,781 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 19:27:20,784 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 19:27:20,787 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 19:27:20,790 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 19:27:20,794 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 19:27:20,798 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 19:27:20,802 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 19:27:20,805 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 19:27:20,811 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 19:27:20,815 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:27:20,815 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 19:27:20,820 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 19:27:20,820 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 19:27:20,825 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:27:20,825 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 19:27:20,830 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:27:20,830 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 19:27:20,835 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:27:20,835 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 19:27:20,839 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 19:27:20,840 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 19:27:20,844 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 19:27:20,844 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 19:27:20,844 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 19:27:20,849 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 19:27:20,849 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 19:27:20,849 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 19:27:20,853 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 19:27:20,858 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 19:27:20,858 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 19:27:20,858 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 19:27:20,858 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 19:27:20,858 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 19:27:20,863 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 19:27:20,868 - DEBUG - üîó Foreign keys for users: []
2025-11-17 19:27:20,868 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 19:27:20,868 - DEBUG - üîç Relationship Details:
2025-11-17 19:27:20,868 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:27:20,868 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 19:27:20,868 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:27:20,868 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 19:27:20,868 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 19:27:20,869 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 19:27:20,869 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 19:27:20,869 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 19:27:20,869 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 19:27:20,869 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 19:27:20,869 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 19:27:20,869 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 19:27:20,869 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 19:27:20,869 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 19:27:20,886 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 19:27:20,886 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 19:27:26,687 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:27:26,704 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:27:26,705 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 19:27:26,719 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 19:27:26,724 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 19:27:26,726 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 19:27:26,731 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 19:27:26,734 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 19:27:26,736 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 19:27:26,739 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 19:27:26,743 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 19:27:26,746 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 19:27:26,749 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 19:27:26,751 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 19:27:26,754 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 19:27:26,757 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 19:27:26,760 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 19:27:26,765 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 19:27:26,769 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:27:26,769 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 19:27:26,773 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 19:27:26,773 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 19:27:26,778 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:27:26,778 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 19:27:26,782 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:27:26,782 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 19:27:26,787 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:27:26,787 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 19:27:26,791 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 19:27:26,791 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 19:27:26,796 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 19:27:26,796 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 19:27:26,796 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 19:27:26,801 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 19:27:26,801 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 19:27:26,801 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 19:27:26,808 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 19:27:26,813 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 19:27:26,813 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 19:27:26,813 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 19:27:26,813 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 19:27:26,813 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 19:27:26,818 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 19:27:26,822 - DEBUG - üîó Foreign keys for users: []
2025-11-17 19:27:26,822 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 19:27:26,822 - DEBUG - üîç Relationship Details:
2025-11-17 19:27:26,822 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:27:26,822 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 19:27:26,822 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:27:26,822 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 19:27:26,822 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 19:27:26,823 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 19:27:26,823 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 19:27:26,823 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 19:27:26,823 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 19:27:26,823 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 19:27:26,823 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 19:27:26,823 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 19:27:26,823 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 19:27:26,823 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 19:28:50,869 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:28:50,870 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:28:50,870 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:28:52,615 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:28:52,615 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:28:52,616 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:29:07,196 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:29:07,196 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:29:07,196 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:29:08,575 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:29:08,575 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:29:08,575 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:29:10,063 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:29:10,063 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:29:10,063 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:29:12,123 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:29:12,123 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:29:12,123 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:29:14,155 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:29:14,155 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:29:14,155 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:29:15,391 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:29:15,391 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:29:15,391 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:29:17,216 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:29:17,216 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:29:17,216 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:30:04,375 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:30:04,375 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:30:04,375 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:30:09,940 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:30:09,940 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:30:09,940 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:30:10,113 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 19:30:10,347 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:30:10,363 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:30:10,363 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:30:10,380 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:30:10,395 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:30:10,404 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 19:30:11,137 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 19:30:11,143 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 19:30:11,146 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 19:30:11,149 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 19:30:11,151 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 19:30:11,154 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 19:30:11,156 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 19:30:11,159 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 19:30:11,162 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 19:30:11,165 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 19:30:11,168 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 19:30:11,171 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 19:30:11,174 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 19:30:11,177 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 19:30:11,183 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 19:30:11,187 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:30:11,187 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 19:30:11,191 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 19:30:11,191 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 19:30:11,195 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:30:11,195 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 19:30:11,199 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:30:11,199 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 19:30:11,203 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:30:11,204 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 19:30:11,208 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 19:30:11,208 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 19:30:11,212 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 19:30:11,212 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 19:30:11,212 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 19:30:11,217 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 19:30:11,217 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 19:30:11,217 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 19:30:11,221 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 19:30:11,226 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 19:30:11,226 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 19:30:11,226 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 19:30:11,226 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 19:30:11,226 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 19:30:11,230 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 19:30:11,234 - DEBUG - üîó Foreign keys for users: []
2025-11-17 19:30:11,234 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 19:30:11,234 - DEBUG - üîç Relationship Details:
2025-11-17 19:30:11,234 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:30:11,234 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 19:30:11,234 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:30:11,234 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 19:30:11,234 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 19:30:11,234 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 19:30:11,234 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 19:30:11,234 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 19:30:11,235 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 19:30:11,235 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 19:30:11,235 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 19:30:11,235 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 19:30:11,235 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 19:30:11,235 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 19:30:11,235 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 19:30:11,235 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 19:30:11,896 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:30:11,912 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:30:11,912 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 19:30:11,925 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 19:30:11,929 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 19:30:11,931 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 19:30:11,934 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 19:30:11,936 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 19:30:11,939 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 19:30:11,941 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 19:30:11,945 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 19:30:11,947 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 19:30:11,950 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 19:30:11,953 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 19:30:11,956 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 19:30:11,958 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 19:30:11,961 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 19:30:11,966 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 19:30:11,970 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:30:11,970 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 19:30:11,975 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 19:30:11,975 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 19:30:11,979 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:30:11,979 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 19:30:11,983 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:30:11,983 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 19:30:11,987 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:30:11,987 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 19:30:11,991 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 19:30:11,991 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 19:30:11,996 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 19:30:11,996 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 19:30:11,996 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 19:30:12,000 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 19:30:12,000 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 19:30:12,000 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 19:30:12,004 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 19:30:12,008 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 19:30:12,009 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 19:30:12,009 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 19:30:12,009 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 19:30:12,009 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 19:30:12,014 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 19:30:12,018 - DEBUG - üîó Foreign keys for users: []
2025-11-17 19:30:12,018 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 19:30:12,018 - DEBUG - üîç Relationship Details:
2025-11-17 19:30:12,018 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:30:12,018 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 19:30:12,018 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:30:12,018 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 19:30:12,018 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 19:30:12,018 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 19:30:12,018 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 19:30:12,018 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 19:30:12,018 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 19:30:12,019 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 19:30:12,019 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 19:30:12,019 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 19:30:12,019 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 19:30:12,019 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 19:56:26,493 - INFO - Database engine created with pool_size=10
2025-11-17 19:56:26,512 - ERROR - Failed to retrieve system hierarchy: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-11-17 19:56:26,512 - ERROR - Database session error: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-11-17 19:56:26,512 - ERROR - Database session error in FastAPI dependency: 500: Failed to fetch hierarchical ship data
2025-11-17 19:57:13,013 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 19:57:13,014 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 19:57:13,025 - ERROR - Error in _get_hierarchical_ship_data_sync: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Ovehaul_info(overhaul_info)]'. Original exception was: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/home/user/IITB/netra/backend/api/db/repos/sys_config.py", line 725, in _get_hierarchical_ship_data_sync
    results = session.exec(statement).all()
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlmodel/orm/session.py", line 66, in exec
    results = super().execute(
              ^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1629, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/mssql/base.py", line 2036, in __init__
    super().__init__(*args, **kwargs)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/base.py", line 687, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 2661, in to_compile_state
    _ColumnEntity._for_columns(
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 3015, in _for_columns
    _ORMColumnEntity(
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 3235, in __init__
    _entity._post_inspect
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Ovehaul_info(overhaul_info)]'. Original exception was: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-11-17 19:57:13,235 - ERROR - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Ovehaul_info(overhaul_info)]'. Original exception was: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-11-17 19:57:13,235 - ERROR - Exception in get_user_selection_data: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Ovehaul_info(overhaul_info)]'. Original exception was: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "/home/user/IITB/netra/backend/api/db/repos/sys_config.py", line 840, in get_user_selection_data
    result = await self.async_service.run_in_thread(_get_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/backend/api/db/connection.py", line 150, in run_in_thread
    return await loop.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/backend/api/db/repos/sys_config.py", line 837, in _get_data
    return self._get_hierarchical_ship_data_sync(session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/backend/api/db/repos/sys_config.py", line 725, in _get_hierarchical_ship_data_sync
    results = session.exec(statement).all()
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlmodel/orm/session.py", line 66, in exec
    results = super().execute(
              ^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1629, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 711, in _compile_w_cache
    compiled_sql = self._compiler(
                   ^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 320, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/dialects/mssql/base.py", line 2036, in __init__
    super().__init__(*args, **kwargs)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py", line 141, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           ^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/compiler.py", line 4728, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/sql/base.py", line 687, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 2661, in to_compile_state
    _ColumnEntity._for_columns(
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 3015, in _for_columns
    _ORMColumnEntity(
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/context.py", line 3235, in __init__
    _entity._post_inspect
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ^^^^^^^^^^^^^^
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/home/user/IITB/netra/.venv/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py", line 4251, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Ovehaul_info(overhaul_info)]'. Original exception was: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-11-17 19:57:13,303 - ERROR - Failed to get all ships: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Ovehaul_info(overhaul_info)]'. Original exception was: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-11-17 19:57:13,303 - ERROR - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Ovehaul_info(overhaul_info)]'. Original exception was: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-11-17 19:57:13,304 - ERROR - Database session error in FastAPI dependency: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Ovehaul_info(overhaul_info)]'. Original exception was: Mapper 'Mapper[SystemConfiguration(system_configuration)]' has no property 'overhaul_records'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-11-17 19:57:26,810 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 19:57:26,810 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 19:57:26,810 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 19:57:26,983 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 19:57:27,218 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:57:27,233 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:57:27,234 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:57:27,249 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:57:27,264 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:57:27,272 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 19:57:27,292 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 19:57:27,297 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 19:57:27,300 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 19:57:27,303 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 19:57:27,306 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 19:57:27,308 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 19:57:27,311 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 19:57:27,313 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 19:57:27,316 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 19:57:27,319 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 19:57:27,323 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 19:57:27,326 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 19:57:27,329 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 19:57:27,332 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 19:57:27,337 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 19:57:27,341 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:57:27,341 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 19:57:27,345 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 19:57:27,345 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 19:57:27,349 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:57:27,349 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 19:57:27,353 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:57:27,353 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 19:57:27,357 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:57:27,357 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 19:57:27,361 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 19:57:27,361 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 19:57:27,366 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 19:57:27,366 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 19:57:27,366 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 19:57:27,370 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 19:57:27,370 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 19:57:27,370 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 19:57:27,374 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 19:57:27,379 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 19:57:27,379 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 19:57:27,379 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 19:57:27,379 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 19:57:27,379 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 19:57:27,383 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 19:57:27,388 - DEBUG - üîó Foreign keys for users: []
2025-11-17 19:57:27,388 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 19:57:27,388 - DEBUG - üîç Relationship Details:
2025-11-17 19:57:27,388 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:57:27,388 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 19:57:27,388 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:57:27,388 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 19:57:27,388 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 19:57:27,388 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 19:57:27,388 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 19:57:27,388 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 19:57:27,388 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 19:57:27,388 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 19:57:27,388 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 19:57:27,388 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 19:57:27,388 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 19:57:27,388 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 19:57:27,389 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 19:57:27,389 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 19:57:28,052 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 19:57:28,067 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 19:57:28,068 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 19:57:28,081 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 19:57:28,086 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 19:57:28,088 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 19:57:28,091 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 19:57:28,094 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 19:57:28,097 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 19:57:28,099 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 19:57:28,103 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 19:57:28,106 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 19:57:28,109 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 19:57:28,111 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 19:57:28,114 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 19:57:28,117 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 19:57:28,120 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 19:57:28,125 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 19:57:28,130 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:57:28,130 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 19:57:28,134 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 19:57:28,134 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 19:57:28,138 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:57:28,138 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 19:57:28,142 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:57:28,142 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 19:57:28,146 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 19:57:28,146 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 19:57:28,150 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 19:57:28,150 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 19:57:28,154 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 19:57:28,155 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 19:57:28,155 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 19:57:28,159 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 19:57:28,159 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 19:57:28,159 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 19:57:28,163 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 19:57:28,167 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 19:57:28,168 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 19:57:28,168 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 19:57:28,168 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 19:57:28,168 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 19:57:28,172 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 19:57:28,176 - DEBUG - üîó Foreign keys for users: []
2025-11-17 19:57:28,176 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 19:57:28,176 - DEBUG - üîç Relationship Details:
2025-11-17 19:57:28,176 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:57:28,176 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 19:57:28,176 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 19:57:28,176 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 19:57:28,176 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 19:57:28,176 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 19:57:28,176 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 19:57:28,176 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 19:57:28,176 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 19:57:28,177 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 19:57:28,177 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 19:57:28,177 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 19:57:28,177 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 19:57:28,177 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 19:57:30,758 - INFO - Database engine created with pool_size=10
2025-11-17 19:57:30,758 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 19:57:30,759 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 19:57:30,790 - INFO - SQLModel query returned 53 rows
2025-11-17 19:57:30,790 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-17 19:57:30,790 - DEBUG - Starting to process and group results
2025-11-17 19:57:30,790 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 19:57:30,790 - DEBUG - Creating new command group: Western Naval Command
2025-11-17 19:57:30,791 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 19:57:30,791 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-17 19:57:30,791 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-17 19:57:30,791 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-17 19:57:30,791 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 19:57:30,791 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-17 19:57:30,791 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-17 19:57:30,791 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-17 19:57:30,791 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-17 19:57:30,791 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-17 19:57:30,791 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 19:57:30,791 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-17 19:57:30,791 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-17 19:57:30,792 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-17 19:57:30,792 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-17 19:57:30,792 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-17 19:57:30,792 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-17 19:57:30,792 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-17 19:57:30,792 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-17 19:57:30,792 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-17 19:57:30,792 - INFO - Processed 3 unique ships into 1 command groups
2025-11-17 19:57:30,792 - DEBUG - Converting to final data structure
2025-11-17 19:57:30,792 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-17 19:57:30,792 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-17 19:57:30,792 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-17 19:57:30,793 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-17 19:57:30,793 - DEBUG - Command groups: ['Western Naval Command']
2025-11-17 19:57:30,793 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 20:01:05,149 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-17 20:06:54,150 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:06:54,150 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:06:54,150 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:06:54,332 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:06:54,571 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:06:54,586 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:06:54,587 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:06:54,602 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:06:54,617 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:06:54,626 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:06:54,645 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:06:54,651 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:06:54,654 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:06:54,656 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:06:54,659 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:06:54,661 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:06:54,664 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:06:54,666 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:06:54,669 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:06:54,672 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:06:54,675 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:06:54,678 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:06:54,681 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:06:54,683 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:06:54,689 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:06:54,693 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:06:54,693 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:06:54,697 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:06:54,697 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:06:54,701 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:06:54,701 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:06:54,705 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:06:54,705 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:06:54,709 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:06:54,709 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:06:54,713 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:06:54,713 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:06:54,717 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:06:54,717 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:06:54,717 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:06:54,721 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:06:54,721 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:06:54,721 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:06:54,725 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:06:54,730 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:06:54,730 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:06:54,730 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:06:54,730 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:06:54,730 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:06:54,735 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:06:54,740 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:06:54,740 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:06:54,740 - DEBUG - üîç Relationship Details:
2025-11-17 20:06:54,740 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:06:54,740 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:06:54,740 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:06:54,740 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:06:54,740 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:06:54,740 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:06:54,740 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:06:54,740 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:06:54,740 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:06:54,740 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:06:54,740 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:06:54,741 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:06:54,741 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:06:54,741 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:06:54,742 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:06:54,742 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:06:55,620 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:06:55,636 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:06:55,636 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:06:55,649 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:06:55,653 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:06:55,656 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:06:55,658 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:06:55,661 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:06:55,663 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:06:55,666 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:06:55,669 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:06:55,672 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:06:55,675 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:06:55,677 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:06:55,680 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:06:55,683 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:06:55,685 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:06:55,690 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:06:55,695 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:06:55,695 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:06:55,699 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:06:55,699 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:06:55,703 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:06:55,703 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:06:55,708 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:06:55,708 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:06:55,712 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:06:55,712 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:06:55,716 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:06:55,717 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:06:55,721 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:06:55,721 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:06:55,722 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:06:55,726 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:06:55,726 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:06:55,726 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:06:55,730 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:06:55,734 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:06:55,734 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:06:55,735 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:06:55,735 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:06:55,735 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:06:55,739 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:06:55,743 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:06:55,743 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:06:55,743 - DEBUG - üîç Relationship Details:
2025-11-17 20:06:55,743 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:06:55,743 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:06:55,743 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:06:55,743 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:06:55,743 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:06:55,743 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:06:55,743 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:06:55,743 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:06:55,744 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:06:55,744 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:06:55,744 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:06:55,744 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:06:55,744 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:06:55,744 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:12:59,408 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:12:59,408 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:12:59,408 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:12:59,578 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:12:59,811 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:12:59,827 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:12:59,827 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:12:59,843 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:12:59,858 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:12:59,867 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:12:59,886 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:12:59,892 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:12:59,895 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:12:59,897 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:12:59,900 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:12:59,903 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:12:59,905 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:12:59,908 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:12:59,911 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:12:59,913 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:12:59,917 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:12:59,920 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:12:59,922 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:12:59,925 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:12:59,930 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:12:59,934 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:12:59,935 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:12:59,938 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:12:59,939 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:12:59,943 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:12:59,943 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:12:59,947 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:12:59,947 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:12:59,951 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:12:59,951 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:12:59,955 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:12:59,955 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:12:59,959 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:12:59,959 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:12:59,960 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:12:59,963 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:12:59,963 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:12:59,964 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:12:59,968 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:12:59,972 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:12:59,972 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:12:59,973 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:12:59,973 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:12:59,973 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:12:59,977 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:12:59,981 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:12:59,982 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:12:59,982 - DEBUG - üîç Relationship Details:
2025-11-17 20:12:59,982 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:12:59,982 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:12:59,982 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:12:59,982 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:12:59,982 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:12:59,982 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:12:59,982 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:12:59,982 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:12:59,982 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:12:59,982 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:12:59,983 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:12:59,983 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:12:59,983 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:12:59,983 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:12:59,983 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:12:59,983 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:13:00,645 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:00,661 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:00,661 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:00,674 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:00,678 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:00,681 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:00,684 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:00,686 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:00,689 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:00,691 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:00,695 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:00,698 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:00,700 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:00,703 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:00,706 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:00,709 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:00,711 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:00,716 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:00,721 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:00,721 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:00,725 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:00,725 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:00,729 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:00,730 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:00,734 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:00,734 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:00,738 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:00,739 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:00,743 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:00,743 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:00,747 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:00,747 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:00,747 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:00,752 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:00,752 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:00,752 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:00,757 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:00,761 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:00,761 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:00,761 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:00,761 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:00,761 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:00,766 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:00,770 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:00,770 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:00,770 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:00,770 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:00,771 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:00,771 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:00,771 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:00,771 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:00,771 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:00,771 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:00,771 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:00,771 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:00,771 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:00,771 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:00,771 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:00,771 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:00,771 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:13:01,681 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:13:01,681 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:13:01,681 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:13:01,849 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:13:02,088 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:02,103 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:02,103 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:02,119 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:02,133 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:02,142 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:02,162 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:02,167 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:02,170 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:02,173 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:02,176 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:02,179 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:02,181 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:02,184 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:02,187 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:02,190 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:02,193 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:02,196 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:02,198 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:02,201 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:02,207 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:02,212 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:02,212 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:02,216 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:02,216 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:02,220 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:02,220 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:02,225 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:02,225 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:02,229 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:02,229 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:02,233 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:02,233 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:02,237 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:02,237 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:02,237 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:02,242 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:02,242 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:02,242 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:02,246 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:02,250 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:02,250 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:02,250 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:02,251 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:02,251 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:02,255 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:02,259 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:02,259 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:02,259 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:02,259 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:02,259 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:02,259 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:02,259 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:02,259 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:02,259 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:02,259 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:02,259 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:02,259 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:02,260 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:02,260 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:02,260 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:02,260 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:02,260 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:13:02,260 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:13:02,260 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:13:02,919 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:02,934 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:02,935 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:02,947 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:02,952 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:02,955 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:02,958 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:02,961 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:02,963 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:02,966 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:02,970 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:02,974 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:02,976 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:02,979 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:02,983 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:02,985 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:02,988 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:02,994 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:02,998 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:02,998 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:03,003 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:03,003 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:03,007 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:03,007 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:03,011 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:03,011 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:03,015 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:03,015 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:03,019 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:03,020 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:03,024 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:03,024 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:03,024 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:03,028 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:03,028 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:03,028 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:03,033 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:03,038 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:03,038 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:03,038 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:03,038 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:03,038 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:03,043 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:03,046 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:03,047 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:03,047 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:03,047 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:03,047 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:03,047 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:03,047 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:03,047 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:03,047 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:03,047 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:03,047 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:03,047 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:03,047 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:03,047 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:03,048 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:03,048 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:03,048 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:13:20,423 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:13:20,423 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:13:20,423 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:13:20,595 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:13:20,829 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:20,845 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:20,845 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:20,860 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:20,875 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:20,884 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:20,904 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:20,909 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:20,912 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:20,915 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:20,918 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:20,920 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:20,923 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:20,926 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:20,928 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:20,931 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:20,934 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:20,937 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:20,940 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:20,943 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:20,949 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:20,953 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:20,953 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:20,957 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:20,957 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:20,961 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:20,961 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:20,966 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:20,966 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:20,970 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:20,970 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:20,975 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:20,975 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:20,980 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:20,980 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:20,980 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:20,985 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:20,985 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:20,985 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:20,990 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:20,994 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:20,994 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:20,994 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:20,994 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:20,994 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:21,000 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:21,004 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:21,004 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:21,004 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:21,004 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,004 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:21,004 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,004 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,004 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,004 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:21,004 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,005 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:21,005 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,005 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:21,005 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:21,005 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:21,005 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:21,005 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:13:21,006 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:13:21,006 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:13:21,667 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:21,683 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:21,684 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:21,697 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:21,701 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:21,704 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:21,707 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:21,710 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:21,712 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:21,715 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:21,718 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:21,721 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:21,724 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:21,727 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:21,730 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:21,733 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:21,736 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:21,741 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:21,745 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:21,745 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:21,749 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:21,750 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:21,754 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:21,754 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:21,758 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:21,758 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:21,762 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:21,762 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:21,767 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:21,767 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:21,771 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:21,771 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:21,771 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:21,775 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:21,775 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:21,775 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:21,779 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:21,783 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:21,784 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:21,784 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:21,784 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:21,784 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:21,788 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:21,792 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:21,792 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:21,793 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:21,793 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,793 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:21,793 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,793 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,793 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,793 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:21,793 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,793 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:21,793 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:21,793 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:21,793 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:21,793 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:21,793 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:21,794 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:13:29,925 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:13:29,925 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:13:29,925 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:13:30,092 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:13:30,325 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:30,340 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:30,341 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:30,356 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:30,371 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:30,379 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:30,399 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:30,405 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:30,409 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:30,411 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:30,414 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:30,417 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:30,421 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:30,423 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:30,427 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:30,430 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:30,434 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:30,437 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:30,440 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:30,443 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:30,449 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:30,454 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:30,454 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:30,458 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:30,458 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:30,462 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:30,462 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:30,466 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:30,466 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:30,470 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:30,471 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:30,475 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:30,475 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:30,481 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:30,481 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:30,481 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:30,486 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:30,486 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:30,486 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:30,491 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:30,495 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:30,495 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:30,495 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:30,495 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:30,495 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:30,500 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:30,504 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:30,504 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:30,504 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:30,504 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:30,504 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:30,505 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:30,505 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:30,505 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:30,505 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:30,505 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:30,505 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:30,505 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:30,505 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:30,505 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:30,505 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:30,505 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:30,505 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:13:30,506 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:13:30,506 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:13:31,173 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:31,188 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:31,189 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:31,201 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:31,206 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:31,209 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:31,212 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:31,214 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:31,217 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:31,219 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:31,222 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:31,225 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:31,228 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:31,230 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:31,233 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:31,236 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:31,238 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:31,243 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:31,247 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:31,247 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:31,252 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:31,252 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:31,256 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:31,256 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:31,260 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:31,260 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:31,264 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:31,264 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:31,268 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:31,268 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:31,272 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:31,272 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:31,272 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:31,276 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:31,276 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:31,276 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:31,280 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:31,285 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:31,285 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:31,285 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:31,285 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:31,285 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:31,289 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:31,293 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:31,293 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:31,293 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:31,293 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:31,293 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:31,293 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:31,293 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:31,293 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:31,293 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:31,293 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:31,294 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:31,294 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:31,294 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:31,294 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:31,294 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:31,294 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:31,294 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:13:34,631 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:13:34,631 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:13:34,631 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:13:34,798 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:13:35,037 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:35,053 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:35,053 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:35,068 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:35,083 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:35,092 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:35,112 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:35,118 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:35,121 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:35,124 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:35,127 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:35,129 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:35,133 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:35,137 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:35,140 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:35,144 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:35,149 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:35,155 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:35,158 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:35,162 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:35,170 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:35,175 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:35,176 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:35,180 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:35,180 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:35,184 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:35,184 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:35,188 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:35,188 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:35,193 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:35,193 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:35,197 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:35,197 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:35,202 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:35,202 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:35,202 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:35,207 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:35,207 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:35,207 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:35,211 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:35,216 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:35,216 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:35,216 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:35,216 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:35,216 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:35,220 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:35,224 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:35,224 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:35,224 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:35,225 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:35,225 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:35,225 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:35,225 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:35,225 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:35,225 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:35,225 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:35,225 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:35,225 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:35,225 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:35,225 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:35,225 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:35,225 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:35,225 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:13:35,226 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:13:35,226 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:13:35,897 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:13:35,912 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:13:35,913 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:13:35,928 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:13:35,932 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:13:35,935 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:13:35,938 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:13:35,940 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:13:35,943 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:13:35,945 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:13:35,949 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:13:35,952 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:13:35,954 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:13:35,957 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:13:35,961 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:13:35,964 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:13:35,968 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:13:35,973 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:13:35,977 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:35,977 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:35,982 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:13:35,982 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:13:35,986 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:35,986 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:13:35,990 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:35,990 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:13:35,994 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:13:35,994 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:13:36,000 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:13:36,000 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:13:36,005 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:13:36,005 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:13:36,005 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:13:36,009 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:13:36,009 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:13:36,009 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:13:36,013 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:13:36,017 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:13:36,017 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:13:36,017 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:13:36,018 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:13:36,018 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:13:36,022 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:13:36,026 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:13:36,026 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:13:36,026 - DEBUG - üîç Relationship Details:
2025-11-17 20:13:36,026 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:36,026 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:13:36,026 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:13:36,026 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:13:36,026 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:13:36,026 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:13:36,026 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:13:36,026 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:13:36,027 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:13:36,027 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:13:36,027 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:13:36,027 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:13:36,027 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:13:36,027 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:15:07,229 - INFO - Database engine created with pool_size=10
2025-11-17 20:15:07,229 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 20:15:07,230 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 20:15:07,262 - INFO - SQLModel query returned 53 rows
2025-11-17 20:15:07,262 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-17 20:15:07,262 - DEBUG - Starting to process and group results
2025-11-17 20:15:07,262 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:15:07,262 - DEBUG - Creating new command group: Western Naval Command
2025-11-17 20:15:07,262 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:15:07,262 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-17 20:15:07,262 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-17 20:15:07,262 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-17 20:15:07,262 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:15:07,263 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-17 20:15:07,263 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-17 20:15:07,263 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-17 20:15:07,263 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-17 20:15:07,264 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-17 20:15:07,264 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-17 20:15:07,264 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-17 20:15:07,264 - INFO - Processed 3 unique ships into 1 command groups
2025-11-17 20:15:07,264 - DEBUG - Converting to final data structure
2025-11-17 20:15:07,264 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-17 20:15:07,264 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-17 20:15:07,264 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-17 20:15:07,264 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-17 20:15:07,264 - DEBUG - Command groups: ['Western Naval Command']
2025-11-17 20:15:07,265 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 20:15:15,414 - ERROR - Failed to retrieve system hierarchy: 1 validation error for ComponentResponse
department_name
  Field required [type=missing, input_value=SystemConfiguration(modif... 14, 9, 54, 15, 823000)), input_type=SystemConfiguration]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-11-17 20:15:15,415 - ERROR - Database session error: 1 validation error for ComponentResponse
department_name
  Field required [type=missing, input_value=SystemConfiguration(), input_type=SystemConfiguration]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-11-17 20:15:15,415 - ERROR - Database session error in FastAPI dependency: 500: Failed to fetch hierarchical ship data
2025-11-17 20:16:19,974 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:16:19,974 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:16:19,974 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:16:20,148 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:16:20,385 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:16:20,400 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:16:20,400 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:16:20,416 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:16:20,431 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:16:20,440 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:16:20,461 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:16:20,468 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:16:20,472 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:16:20,476 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:16:20,479 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:16:20,484 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:16:20,488 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:16:20,492 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:16:20,496 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:16:20,500 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:16:20,504 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:16:20,508 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:16:20,511 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:16:20,515 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:16:20,522 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:16:20,527 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:16:20,527 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:16:20,532 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:16:20,532 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:16:20,537 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:16:20,537 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:16:20,542 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:16:20,542 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:16:20,548 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:16:20,548 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:16:20,553 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:16:20,553 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:16:20,559 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:16:20,559 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:16:20,559 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:16:20,566 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:16:20,566 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:16:20,567 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:16:20,572 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:16:20,579 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:16:20,580 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:16:20,580 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:16:20,580 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:16:20,580 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:16:20,586 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:16:20,592 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:16:20,592 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:16:20,592 - DEBUG - üîç Relationship Details:
2025-11-17 20:16:20,592 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:16:20,592 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:16:20,592 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:16:20,592 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:16:20,592 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:16:20,593 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:16:20,593 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:16:20,593 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:16:20,593 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:16:20,593 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:16:20,593 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:16:20,593 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:16:20,593 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:16:20,593 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:16:20,594 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:16:20,594 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:16:21,270 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:16:21,286 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:16:21,287 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:16:21,299 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:16:21,304 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:16:21,307 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:16:21,310 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:16:21,313 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:16:21,317 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:16:21,319 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:16:21,324 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:16:21,327 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:16:21,330 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:16:21,333 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:16:21,336 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:16:21,338 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:16:21,341 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:16:21,346 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:16:21,351 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:16:21,351 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:16:21,355 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:16:21,355 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:16:21,359 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:16:21,359 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:16:21,363 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:16:21,363 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:16:21,367 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:16:21,367 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:16:21,371 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:16:21,371 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:16:21,376 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:16:21,376 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:16:21,376 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:16:21,380 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:16:21,380 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:16:21,380 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:16:21,384 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:16:21,388 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:16:21,388 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:16:21,388 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:16:21,388 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:16:21,389 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:16:21,392 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:16:21,397 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:16:21,397 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:16:21,397 - DEBUG - üîç Relationship Details:
2025-11-17 20:16:21,397 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:16:21,397 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:16:21,397 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:16:21,397 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:16:21,397 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:16:21,397 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:16:21,397 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:16:21,397 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:16:21,397 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:16:21,397 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:16:21,397 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:16:21,397 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:16:21,397 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:16:21,398 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:16:32,444 - INFO - Database engine created with pool_size=10
2025-11-17 20:16:32,484 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-17 20:17:33,144 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 20:17:33,145 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 20:17:33,148 - INFO - SQLModel query returned 53 rows
2025-11-17 20:17:33,148 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-17 20:17:33,148 - DEBUG - Starting to process and group results
2025-11-17 20:17:33,148 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:17:33,148 - DEBUG - Creating new command group: Western Naval Command
2025-11-17 20:17:33,149 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-17 20:17:33,149 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-17 20:17:33,149 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-17 20:17:33,149 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:17:33,149 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-17 20:17:33,149 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-17 20:17:33,149 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-17 20:17:33,149 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-17 20:17:33,150 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-17 20:17:33,150 - INFO - Processed 3 unique ships into 1 command groups
2025-11-17 20:17:33,150 - DEBUG - Converting to final data structure
2025-11-17 20:17:33,150 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-17 20:17:33,150 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-17 20:17:33,150 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-17 20:17:33,150 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-17 20:17:33,150 - DEBUG - Command groups: ['Western Naval Command']
2025-11-17 20:17:33,150 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 20:17:39,427 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components
2025-11-17 20:20:44,637 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:20:44,637 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:20:44,637 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:20:44,815 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:20:45,049 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:20:45,065 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:20:45,065 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:20:45,081 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:20:45,100 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:20:45,110 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:20:45,133 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:20:45,142 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:20:45,145 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:20:45,149 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:20:45,153 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:20:45,157 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:20:45,161 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:20:45,165 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:20:45,169 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:20:45,173 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:20:45,178 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:20:45,182 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:20:45,185 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:20:45,189 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:20:45,196 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:20:45,206 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:45,206 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:20:45,213 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:20:45,213 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:20:45,218 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:45,218 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:20:45,223 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:45,223 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:20:45,228 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:45,228 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:20:45,232 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:20:45,232 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:20:45,237 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:20:45,237 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:20:45,237 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:20:45,242 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:20:45,242 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:20:45,242 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:20:45,246 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:20:45,251 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:20:45,252 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:20:45,252 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:20:45,252 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:20:45,252 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:20:45,257 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:20:45,261 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:20:45,262 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:20:45,262 - DEBUG - üîç Relationship Details:
2025-11-17 20:20:45,262 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:20:45,262 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:20:45,262 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:20:45,262 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:20:45,262 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:20:45,262 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:20:45,262 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:20:45,262 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:20:45,262 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:20:45,262 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:20:45,263 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:20:45,263 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:20:45,263 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:20:45,263 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:20:45,263 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:20:45,264 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:20:45,996 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:20:46,012 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:20:46,013 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:20:46,027 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:20:46,032 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:20:46,036 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:20:46,040 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:20:46,043 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:20:46,047 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:20:46,050 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:20:46,054 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:20:46,058 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:20:46,062 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:20:46,066 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:20:46,069 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:20:46,072 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:20:46,076 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:20:46,081 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:20:46,085 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:46,086 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:20:46,090 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:20:46,090 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:20:46,094 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:46,094 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:20:46,099 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:46,099 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:20:46,103 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:46,104 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:20:46,108 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:20:46,108 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:20:46,112 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:20:46,112 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:20:46,112 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:20:46,116 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:20:46,116 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:20:46,116 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:20:46,121 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:20:46,125 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:20:46,125 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:20:46,126 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:20:46,126 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:20:46,126 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:20:46,130 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:20:46,134 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:20:46,134 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:20:46,134 - DEBUG - üîç Relationship Details:
2025-11-17 20:20:46,134 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:20:46,135 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:20:46,135 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:20:46,135 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:20:46,135 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:20:46,135 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:20:46,135 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:20:46,135 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:20:46,135 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:20:46,135 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:20:46,135 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:20:46,135 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:20:46,135 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:20:46,135 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:20:47,059 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:20:47,059 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:20:47,059 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:20:47,227 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:20:47,455 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:20:47,471 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:20:47,471 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:20:47,487 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:20:47,502 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:20:47,511 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:20:47,531 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:20:47,537 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:20:47,540 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:20:47,542 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:20:47,545 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:20:47,548 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:20:47,550 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:20:47,553 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:20:47,556 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:20:47,559 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:20:47,562 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:20:47,565 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:20:47,568 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:20:47,571 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:20:47,576 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:20:47,580 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:47,580 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:20:47,585 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:20:47,585 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:20:47,589 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:47,589 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:20:47,593 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:47,593 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:20:47,597 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:47,597 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:20:47,601 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:20:47,601 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:20:47,606 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:20:47,606 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:20:47,606 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:20:47,610 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:20:47,611 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:20:47,611 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:20:47,615 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:20:47,619 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:20:47,619 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:20:47,619 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:20:47,619 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:20:47,619 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:20:47,623 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:20:47,628 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:20:47,628 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:20:47,628 - DEBUG - üîç Relationship Details:
2025-11-17 20:20:47,628 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:20:47,628 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:20:47,628 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:20:47,628 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:20:47,628 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:20:47,628 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:20:47,628 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:20:47,629 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:20:47,629 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:20:47,629 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:20:47,629 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:20:47,629 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:20:47,629 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:20:47,629 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:20:47,630 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:20:47,630 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:20:48,285 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:20:48,300 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:20:48,301 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:20:48,314 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:20:48,318 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:20:48,321 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:20:48,324 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:20:48,326 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:20:48,329 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:20:48,331 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:20:48,335 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:20:48,338 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:20:48,341 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:20:48,344 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:20:48,347 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:20:48,349 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:20:48,352 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:20:48,357 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:20:48,363 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:48,363 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:20:48,367 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:20:48,367 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:20:48,371 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:48,371 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:20:48,376 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:48,376 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:20:48,381 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:20:48,382 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:20:48,386 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:20:48,386 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:20:48,391 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:20:48,391 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:20:48,391 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:20:48,396 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:20:48,396 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:20:48,396 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:20:48,400 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:20:48,405 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:20:48,405 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:20:48,405 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:20:48,405 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:20:48,405 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:20:48,409 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:20:48,413 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:20:48,413 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:20:48,413 - DEBUG - üîç Relationship Details:
2025-11-17 20:20:48,413 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:20:48,413 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:20:48,414 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:20:48,414 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:20:48,414 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:20:48,414 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:20:48,414 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:20:48,414 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:20:48,414 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:20:48,414 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:20:48,414 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:20:48,414 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:20:48,414 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:20:48,414 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:21:01,744 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:21:01,744 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:21:01,744 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:21:01,918 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:21:02,162 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:02,178 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:02,178 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:02,194 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:02,209 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:02,218 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:21:02,238 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:21:02,243 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:21:02,246 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:21:02,249 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:21:02,252 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:21:02,254 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:21:02,257 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:21:02,259 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:21:02,262 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:21:02,265 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:21:02,268 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:21:02,271 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:21:02,273 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:21:02,276 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:21:02,281 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:21:02,285 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:02,285 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:02,289 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:21:02,289 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:21:02,293 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:02,293 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:02,297 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:02,297 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:21:02,301 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:02,301 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:21:02,305 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:21:02,305 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:21:02,309 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:21:02,309 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:21:02,310 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:21:02,314 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:21:02,314 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:21:02,314 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:21:02,318 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:21:02,322 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:21:02,322 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:21:02,322 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:21:02,322 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:21:02,322 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:21:02,326 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:21:02,330 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:21:02,330 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:21:02,330 - DEBUG - üîç Relationship Details:
2025-11-17 20:21:02,331 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:02,331 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:21:02,331 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:02,331 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:21:02,331 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:21:02,331 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:21:02,331 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:21:02,331 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:21:02,331 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:21:02,331 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:21:02,331 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:21:02,331 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:21:02,331 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:21:02,331 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:21:02,332 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:21:02,332 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:21:03,001 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:03,017 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:03,017 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:21:03,030 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:21:03,035 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:21:03,037 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:21:03,040 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:21:03,043 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:21:03,045 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:21:03,048 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:21:03,051 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:21:03,054 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:21:03,056 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:21:03,059 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:21:03,062 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:21:03,065 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:21:03,067 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:21:03,072 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:21:03,076 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:03,076 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:03,081 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:21:03,081 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:21:03,085 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:03,085 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:03,089 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:03,089 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:21:03,094 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:03,094 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:21:03,098 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:21:03,098 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:21:03,102 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:21:03,102 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:21:03,102 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:21:03,106 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:21:03,106 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:21:03,106 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:21:03,110 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:21:03,115 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:21:03,115 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:21:03,115 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:21:03,115 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:21:03,115 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:21:03,119 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:21:03,123 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:21:03,124 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:21:03,124 - DEBUG - üîç Relationship Details:
2025-11-17 20:21:03,124 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:03,124 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:21:03,124 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:03,124 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:21:03,124 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:21:03,124 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:21:03,124 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:21:03,124 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:21:03,124 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:21:03,124 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:21:03,124 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:21:03,124 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:21:03,124 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:21:03,124 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:21:04,047 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:21:04,047 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:21:04,047 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:21:04,217 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:21:04,451 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:04,466 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:04,467 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:04,482 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:04,497 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:04,507 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:21:04,529 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:21:04,536 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:21:04,540 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:21:04,544 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:21:04,548 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:21:04,551 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:21:04,555 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:21:04,559 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:21:04,564 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:21:04,567 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:21:04,572 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:21:04,576 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:21:04,580 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:21:04,583 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:21:04,590 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:21:04,596 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:04,596 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:04,601 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:21:04,601 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:21:04,606 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:04,607 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:04,612 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:04,612 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:21:04,617 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:04,617 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:21:04,623 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:21:04,623 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:21:04,628 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:21:04,628 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:21:04,629 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:21:04,634 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:21:04,634 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:21:04,634 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:21:04,640 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:21:04,646 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:21:04,646 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:21:04,646 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:21:04,647 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:21:04,647 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:21:04,653 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:21:04,659 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:21:04,659 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:21:04,659 - DEBUG - üîç Relationship Details:
2025-11-17 20:21:04,660 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:04,660 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:21:04,660 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:04,660 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:21:04,660 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:21:04,660 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:21:04,660 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:21:04,660 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:21:04,660 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:21:04,660 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:21:04,660 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:21:04,661 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:21:04,661 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:21:04,661 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:21:04,662 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:21:04,662 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:21:05,366 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:05,382 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:05,382 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:21:05,395 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:21:05,399 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:21:05,402 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:21:05,404 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:21:05,407 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:21:05,410 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:21:05,412 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:21:05,416 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:21:05,419 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:21:05,422 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:21:05,424 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:21:05,428 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:21:05,430 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:21:05,433 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:21:05,438 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:21:05,443 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:05,443 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:05,447 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:21:05,448 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:21:05,452 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:05,452 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:05,456 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:05,456 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:21:05,460 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:05,460 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:21:05,464 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:21:05,464 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:21:05,469 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:21:05,469 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:21:05,469 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:21:05,473 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:21:05,473 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:21:05,473 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:21:05,477 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:21:05,482 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:21:05,482 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:21:05,482 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:21:05,482 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:21:05,482 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:21:05,486 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:21:05,490 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:21:05,490 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:21:05,490 - DEBUG - üîç Relationship Details:
2025-11-17 20:21:05,490 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:05,490 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:21:05,490 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:05,491 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:21:05,491 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:21:05,491 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:21:05,491 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:21:05,491 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:21:05,491 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:21:05,491 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:21:05,491 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:21:05,491 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:21:05,491 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:21:05,491 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:21:09,337 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:21:09,337 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:21:09,337 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:21:09,506 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:21:09,744 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:09,760 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:09,760 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:09,775 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:09,790 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:09,799 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:21:09,819 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:21:09,824 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:21:09,827 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:21:09,830 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:21:09,832 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:21:09,836 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:21:09,839 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:21:09,841 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:21:09,845 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:21:09,847 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:21:09,851 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:21:09,855 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:21:09,858 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:21:09,861 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:21:09,867 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:21:09,872 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:09,872 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:09,877 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:21:09,877 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:21:09,881 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:09,881 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:09,886 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:09,886 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:21:09,890 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:09,890 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:21:09,895 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:21:09,895 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:21:09,899 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:21:09,899 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:21:09,899 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:21:09,904 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:21:09,904 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:21:09,905 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:21:09,911 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:21:09,918 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:21:09,918 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:21:09,919 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:21:09,919 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:21:09,919 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:21:09,925 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:21:09,931 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:21:09,932 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:21:09,932 - DEBUG - üîç Relationship Details:
2025-11-17 20:21:09,932 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:09,932 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:21:09,932 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:09,932 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:21:09,932 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:21:09,932 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:21:09,932 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:21:09,932 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:21:09,932 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:21:09,932 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:21:09,933 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:21:09,933 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:21:09,933 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:21:09,933 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:21:09,933 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:21:09,934 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:21:10,615 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:21:10,630 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:21:10,631 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:21:10,643 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:21:10,647 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:21:10,650 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:21:10,653 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:21:10,655 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:21:10,658 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:21:10,660 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:21:10,664 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:21:10,666 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:21:10,669 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:21:10,672 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:21:10,675 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:21:10,677 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:21:10,680 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:21:10,685 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:21:10,689 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:10,689 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:10,694 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:21:10,694 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:21:10,698 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:10,698 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:21:10,703 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:10,703 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:21:10,707 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:21:10,707 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:21:10,711 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:21:10,711 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:21:10,716 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:21:10,716 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:21:10,716 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:21:10,720 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:21:10,720 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:21:10,720 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:21:10,724 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:21:10,729 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:21:10,729 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:21:10,729 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:21:10,729 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:21:10,729 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:21:10,734 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:21:10,738 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:21:10,738 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:21:10,738 - DEBUG - üîç Relationship Details:
2025-11-17 20:21:10,738 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:10,738 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:21:10,738 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:21:10,738 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:21:10,738 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:21:10,738 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:21:10,738 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:21:10,738 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:21:10,738 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:21:10,739 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:21:10,739 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:21:10,739 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:21:10,739 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:21:10,739 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:21:31,026 - INFO - Database engine created with pool_size=10
2025-11-17 20:21:31,026 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 20:21:31,027 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 20:21:31,059 - INFO - SQLModel query returned 53 rows
2025-11-17 20:21:31,059 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-17 20:21:31,059 - DEBUG - Starting to process and group results
2025-11-17 20:21:31,059 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:21:31,059 - DEBUG - Creating new command group: Western Naval Command
2025-11-17 20:21:31,059 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-17 20:21:31,060 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-17 20:21:31,060 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-17 20:21:31,060 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:21:31,060 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-17 20:21:31,060 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-17 20:21:31,060 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-17 20:21:31,060 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-17 20:21:31,061 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-17 20:21:31,061 - INFO - Processed 3 unique ships into 1 command groups
2025-11-17 20:21:31,061 - DEBUG - Converting to final data structure
2025-11-17 20:21:31,061 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-17 20:21:31,061 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-17 20:21:31,061 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-17 20:21:31,061 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-17 20:21:31,061 - DEBUG - Command groups: ['Western Naval Command']
2025-11-17 20:21:31,062 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 20:21:41,300 - ERROR - Failed to retrieve system hierarchy: 1 validation error for ComponentResponse
department_name
  Field required [type=missing, input_value=SystemConfiguration(modif... 14, 9, 54, 15, 823000)), input_type=SystemConfiguration]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-11-17 20:21:41,301 - ERROR - Database session error: 1 validation error for ComponentResponse
department_name
  Field required [type=missing, input_value=SystemConfiguration(), input_type=SystemConfiguration]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-11-17 20:21:41,301 - ERROR - Database session error in FastAPI dependency: 500: Failed to fetch hierarchical ship data
2025-11-17 20:23:02,914 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-17 20:23:02,914 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-17 20:23:02,914 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-17 20:23:03,084 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-17 20:23:03,316 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:23:03,331 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:23:03,331 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:23:03,347 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:23:03,362 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:23:03,371 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:23:04,147 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:23:04,153 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:23:04,156 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:23:04,159 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:23:04,162 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:23:04,164 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:23:04,167 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:23:04,170 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:23:04,172 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:23:04,175 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:23:04,179 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:23:04,182 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:23:04,184 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:23:04,187 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:23:04,193 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:23:04,197 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:23:04,197 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:23:04,201 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:23:04,201 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:23:04,206 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:23:04,206 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:23:04,210 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:23:04,210 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:23:04,214 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:23:04,214 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:23:04,219 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:23:04,219 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:23:04,223 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:23:04,223 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:23:04,223 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:23:04,228 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:23:04,228 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:23:04,228 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:23:04,233 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:23:04,237 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:23:04,237 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:23:04,237 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:23:04,238 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:23:04,238 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:23:04,242 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:23:04,246 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:23:04,246 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:23:04,247 - DEBUG - üîç Relationship Details:
2025-11-17 20:23:04,247 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:23:04,247 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:23:04,247 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:23:04,247 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:23:04,247 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:23:04,247 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:23:04,247 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:23:04,247 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:23:04,247 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:23:04,247 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:23:04,247 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:23:04,247 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:23:04,248 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:23:04,248 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:23:04,248 - INFO - üìå Loaded conversation memory from disk.
2025-11-17 20:23:04,248 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-17 20:23:05,154 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-17 20:23:05,169 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-17 20:23:05,170 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-17 20:23:05,183 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-17 20:23:05,187 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-17 20:23:05,190 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-17 20:23:05,192 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-17 20:23:05,195 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-17 20:23:05,198 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-17 20:23:05,201 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-17 20:23:05,204 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-17 20:23:05,207 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-17 20:23:05,210 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-17 20:23:05,212 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-17 20:23:05,215 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-17 20:23:05,218 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-17 20:23:05,221 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-17 20:23:05,226 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-17 20:23:05,231 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:23:05,231 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-17 20:23:05,236 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-17 20:23:05,236 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-17 20:23:05,240 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:23:05,240 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-17 20:23:05,244 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:23:05,244 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-17 20:23:05,249 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-17 20:23:05,249 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-17 20:23:05,253 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-17 20:23:05,253 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-17 20:23:05,257 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-17 20:23:05,257 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-17 20:23:05,257 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-17 20:23:05,262 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-17 20:23:05,262 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-17 20:23:05,262 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-17 20:23:05,266 - DEBUG - üîó Foreign keys for ships: []
2025-11-17 20:23:05,270 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-17 20:23:05,270 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-17 20:23:05,270 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-17 20:23:05,271 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-17 20:23:05,271 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-17 20:23:05,275 - DEBUG - üîó Foreign keys for systems: []
2025-11-17 20:23:05,279 - DEBUG - üîó Foreign keys for users: []
2025-11-17 20:23:05,279 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-17 20:23:05,279 - DEBUG - üîç Relationship Details:
2025-11-17 20:23:05,279 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:23:05,279 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-17 20:23:05,279 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-17 20:23:05,279 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-17 20:23:05,279 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-17 20:23:05,279 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-17 20:23:05,279 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-17 20:23:05,279 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-17 20:23:05,279 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-17 20:23:05,279 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-17 20:23:05,279 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-17 20:23:05,279 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-17 20:23:05,279 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-17 20:23:05,279 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-17 20:23:18,381 - INFO - Database engine created with pool_size=10
2025-11-17 20:23:18,421 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components, 2 departments
2025-11-17 20:32:45,827 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 20:32:45,827 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 20:32:45,905 - INFO - SQLModel query returned 53 rows
2025-11-17 20:32:45,905 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-17 20:32:45,905 - DEBUG - Starting to process and group results
2025-11-17 20:32:45,905 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:32:45,905 - DEBUG - Creating new command group: Western Naval Command
2025-11-17 20:32:45,905 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:32:45,905 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-17 20:32:45,906 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-17 20:32:45,906 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-17 20:32:45,906 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:32:45,906 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-17 20:32:45,906 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-17 20:32:45,906 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-17 20:32:45,906 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-17 20:32:45,906 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-17 20:32:45,906 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:32:45,906 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-17 20:32:45,906 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-17 20:32:45,907 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-17 20:32:45,907 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-17 20:32:45,907 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-17 20:32:45,907 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-17 20:32:45,907 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-17 20:32:45,907 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-17 20:32:45,907 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-17 20:32:45,907 - INFO - Processed 3 unique ships into 1 command groups
2025-11-17 20:32:45,907 - DEBUG - Converting to final data structure
2025-11-17 20:32:45,907 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-17 20:32:45,907 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-17 20:32:45,907 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-17 20:32:45,907 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-17 20:32:45,908 - DEBUG - Command groups: ['Western Naval Command']
2025-11-17 20:32:45,936 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 20:32:55,403 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components, 2 departments
2025-11-17 20:33:48,481 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components, 2 departments
2025-11-17 20:39:06,306 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-17 20:39:06,306 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-17 20:39:06,314 - INFO - SQLModel query returned 53 rows
2025-11-17 20:39:06,314 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-17 20:39:06,314 - DEBUG - Starting to process and group results
2025-11-17 20:39:06,314 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:39:06,314 - DEBUG - Creating new command group: Western Naval Command
2025-11-17 20:39:06,314 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-17 20:39:06,315 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-17 20:39:06,315 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-17 20:39:06,315 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-17 20:39:06,315 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-17 20:39:06,315 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-17 20:39:06,315 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-17 20:39:06,315 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-17 20:39:06,316 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-17 20:39:06,316 - INFO - Processed 3 unique ships into 1 command groups
2025-11-17 20:39:06,316 - DEBUG - Converting to final data structure
2025-11-17 20:39:06,316 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-17 20:39:06,316 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-17 20:39:06,316 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-17 20:39:06,316 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-17 20:39:06,316 - DEBUG - Command groups: ['Western Naval Command']
2025-11-17 20:39:06,317 - INFO - Successfully retrieved hierarchical ship data
2025-11-17 20:43:08,575 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components, 2 departments
2025-11-18 13:32:43,705 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-18 13:32:43,705 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-18 13:32:43,705 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-18 13:32:43,873 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-18 13:32:44,102 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 13:32:44,118 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 13:32:44,118 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 13:32:44,134 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 13:32:44,149 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 13:32:44,157 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-18 13:32:44,628 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-18 13:32:44,634 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-18 13:32:44,637 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-18 13:32:44,640 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-18 13:32:44,643 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-18 13:32:44,646 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-18 13:32:44,649 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-18 13:32:44,653 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-18 13:32:44,656 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-18 13:32:44,659 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-18 13:32:44,663 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-18 13:32:44,666 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-18 13:32:44,669 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-18 13:32:44,672 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-18 13:32:44,678 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-18 13:32:44,683 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 13:32:44,683 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-18 13:32:44,689 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-18 13:32:44,690 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-18 13:32:44,695 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 13:32:44,695 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-18 13:32:44,700 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 13:32:44,700 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-18 13:32:44,705 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 13:32:44,705 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-18 13:32:44,710 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-18 13:32:44,710 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-18 13:32:44,715 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-18 13:32:44,715 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-18 13:32:44,715 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-18 13:32:44,720 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-18 13:32:44,720 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-18 13:32:44,720 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-18 13:32:44,724 - DEBUG - üîó Foreign keys for ships: []
2025-11-18 13:32:44,730 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-18 13:32:44,730 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-18 13:32:44,730 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-18 13:32:44,730 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-18 13:32:44,730 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-18 13:32:44,735 - DEBUG - üîó Foreign keys for systems: []
2025-11-18 13:32:44,742 - DEBUG - üîó Foreign keys for users: []
2025-11-18 13:32:44,742 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-18 13:32:44,742 - DEBUG - üîç Relationship Details:
2025-11-18 13:32:44,742 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-18 13:32:44,742 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-18 13:32:44,742 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-18 13:32:44,742 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-18 13:32:44,742 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-18 13:32:44,742 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-18 13:32:44,742 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-18 13:32:44,743 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-18 13:32:44,743 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-18 13:32:44,743 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-18 13:32:44,743 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-18 13:32:44,743 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-18 13:32:44,743 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-18 13:32:44,743 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-18 13:32:44,743 - INFO - üìå Loaded conversation memory from disk.
2025-11-18 13:32:44,743 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-18 13:32:46,342 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 13:32:46,358 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 13:32:46,358 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-18 13:32:46,371 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-18 13:32:46,375 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-18 13:32:46,378 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-18 13:32:46,381 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-18 13:32:46,383 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-18 13:32:46,386 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-18 13:32:46,389 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-18 13:32:46,392 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-18 13:32:46,396 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-18 13:32:46,399 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-18 13:32:46,402 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-18 13:32:46,406 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-18 13:32:46,409 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-18 13:32:46,412 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-18 13:32:46,418 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-18 13:32:46,422 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 13:32:46,422 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-18 13:32:46,427 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-18 13:32:46,427 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-18 13:32:46,432 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 13:32:46,432 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-18 13:32:46,436 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 13:32:46,436 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-18 13:32:46,440 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 13:32:46,440 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-18 13:32:46,444 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-18 13:32:46,444 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-18 13:32:46,449 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-18 13:32:46,449 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-18 13:32:46,449 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-18 13:32:46,453 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-18 13:32:46,453 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-18 13:32:46,453 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-18 13:32:46,457 - DEBUG - üîó Foreign keys for ships: []
2025-11-18 13:32:46,462 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-18 13:32:46,462 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-18 13:32:46,462 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-18 13:32:46,462 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-18 13:32:46,462 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-18 13:32:46,467 - DEBUG - üîó Foreign keys for systems: []
2025-11-18 13:32:46,471 - DEBUG - üîó Foreign keys for users: []
2025-11-18 13:32:46,471 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-18 13:32:46,471 - DEBUG - üîç Relationship Details:
2025-11-18 13:32:46,471 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-18 13:32:46,471 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-18 13:32:46,471 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-18 13:32:46,471 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-18 13:32:46,472 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-18 13:32:46,472 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-18 13:32:46,472 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-18 13:32:46,472 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-18 13:32:46,472 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-18 13:32:46,472 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-18 13:32:46,472 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-18 13:32:46,472 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-18 13:32:46,472 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-18 13:32:46,472 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-18 13:34:22,590 - INFO - Database engine created with pool_size=10
2025-11-18 13:34:22,590 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-18 13:34:22,591 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-18 13:34:22,622 - INFO - SQLModel query returned 53 rows
2025-11-18 13:34:22,622 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-18 13:34:22,622 - DEBUG - Starting to process and group results
2025-11-18 13:34:22,622 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-18 13:34:22,622 - DEBUG - Creating new command group: Western Naval Command
2025-11-18 13:34:22,622 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-18 13:34:22,622 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-18 13:34:22,622 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-18 13:34:22,622 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-18 13:34:22,622 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-18 13:34:22,623 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-18 13:34:22,623 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-18 13:34:22,623 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-18 13:34:22,623 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-18 13:34:22,623 - INFO - Processed 3 unique ships into 1 command groups
2025-11-18 13:34:22,624 - DEBUG - Converting to final data structure
2025-11-18 13:34:22,624 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-18 13:34:22,624 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-18 13:34:22,624 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-18 13:34:22,624 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-18 13:34:22,624 - DEBUG - Command groups: ['Western Naval Command']
2025-11-18 13:34:22,624 - INFO - Successfully retrieved hierarchical ship data
2025-11-18 13:35:24,272 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components, 2 departments
2025-11-18 14:05:48,773 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-18 14:05:48,773 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-18 14:05:48,773 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-18 14:05:48,952 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-18 14:05:49,189 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:05:49,205 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 14:05:49,205 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:05:49,221 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:05:49,235 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 14:05:49,244 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-18 14:05:49,264 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-18 14:05:49,270 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-18 14:05:49,272 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-18 14:05:49,275 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-18 14:05:49,278 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-18 14:05:49,280 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-18 14:05:49,283 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-18 14:05:49,285 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-18 14:05:49,288 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-18 14:05:49,291 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-18 14:05:49,294 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-18 14:05:49,297 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-18 14:05:49,299 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-18 14:05:49,302 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-18 14:05:49,308 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-18 14:05:49,312 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:49,312 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-18 14:05:49,316 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-18 14:05:49,316 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-18 14:05:49,320 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:49,320 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-18 14:05:49,324 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:49,324 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-18 14:05:49,328 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:49,328 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-18 14:05:49,332 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-18 14:05:49,332 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-18 14:05:49,336 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-18 14:05:49,336 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-18 14:05:49,336 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-18 14:05:49,340 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-18 14:05:49,340 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-18 14:05:49,340 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-18 14:05:49,344 - DEBUG - üîó Foreign keys for ships: []
2025-11-18 14:05:49,349 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-18 14:05:49,349 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-18 14:05:49,349 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-18 14:05:49,349 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-18 14:05:49,349 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-18 14:05:49,353 - DEBUG - üîó Foreign keys for systems: []
2025-11-18 14:05:49,357 - DEBUG - üîó Foreign keys for users: []
2025-11-18 14:05:49,357 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-18 14:05:49,357 - DEBUG - üîç Relationship Details:
2025-11-18 14:05:49,357 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:05:49,357 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-18 14:05:49,357 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:05:49,357 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-18 14:05:49,357 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-18 14:05:49,357 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-18 14:05:49,358 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-18 14:05:49,358 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-18 14:05:49,358 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-18 14:05:49,358 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-18 14:05:49,358 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-18 14:05:49,358 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-18 14:05:49,358 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-18 14:05:49,358 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-18 14:05:49,358 - INFO - üìå Loaded conversation memory from disk.
2025-11-18 14:05:49,358 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-18 14:05:50,018 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:05:50,033 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 14:05:50,034 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-18 14:05:50,047 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-18 14:05:50,051 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-18 14:05:50,054 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-18 14:05:50,057 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-18 14:05:50,059 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-18 14:05:50,062 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-18 14:05:50,064 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-18 14:05:50,068 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-18 14:05:50,071 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-18 14:05:50,073 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-18 14:05:50,076 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-18 14:05:50,079 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-18 14:05:50,082 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-18 14:05:50,085 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-18 14:05:50,090 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-18 14:05:50,094 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:50,094 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-18 14:05:50,098 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-18 14:05:50,099 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-18 14:05:50,103 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:50,103 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-18 14:05:50,108 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:50,108 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-18 14:05:50,112 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:50,112 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-18 14:05:50,116 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-18 14:05:50,116 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-18 14:05:50,120 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-18 14:05:50,120 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-18 14:05:50,120 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-18 14:05:50,124 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-18 14:05:50,124 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-18 14:05:50,125 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-18 14:05:50,129 - DEBUG - üîó Foreign keys for ships: []
2025-11-18 14:05:50,133 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-18 14:05:50,133 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-18 14:05:50,133 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-18 14:05:50,133 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-18 14:05:50,133 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-18 14:05:50,137 - DEBUG - üîó Foreign keys for systems: []
2025-11-18 14:05:50,141 - DEBUG - üîó Foreign keys for users: []
2025-11-18 14:05:50,141 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-18 14:05:50,141 - DEBUG - üîç Relationship Details:
2025-11-18 14:05:50,141 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:05:50,141 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-18 14:05:50,141 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:05:50,141 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-18 14:05:50,141 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-18 14:05:50,142 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-18 14:05:50,142 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-18 14:05:50,142 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-18 14:05:50,142 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-18 14:05:50,142 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-18 14:05:50,142 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-18 14:05:50,142 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-18 14:05:50,142 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-18 14:05:50,142 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-18 14:05:56,785 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-18 14:05:56,785 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-18 14:05:56,785 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-18 14:05:56,954 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-18 14:05:57,191 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:05:57,206 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 14:05:57,206 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:05:57,222 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:05:57,237 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 14:05:57,245 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-18 14:05:57,265 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-18 14:05:57,271 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-18 14:05:57,274 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-18 14:05:57,276 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-18 14:05:57,279 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-18 14:05:57,282 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-18 14:05:57,284 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-18 14:05:57,287 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-18 14:05:57,290 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-18 14:05:57,293 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-18 14:05:57,296 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-18 14:05:57,299 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-18 14:05:57,302 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-18 14:05:57,305 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-18 14:05:57,310 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-18 14:05:57,315 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:57,315 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-18 14:05:57,319 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-18 14:05:57,319 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-18 14:05:57,323 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:57,323 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-18 14:05:57,327 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:57,327 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-18 14:05:57,331 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:57,332 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-18 14:05:57,336 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-18 14:05:57,336 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-18 14:05:57,340 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-18 14:05:57,340 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-18 14:05:57,340 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-18 14:05:57,344 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-18 14:05:57,344 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-18 14:05:57,344 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-18 14:05:57,348 - DEBUG - üîó Foreign keys for ships: []
2025-11-18 14:05:57,353 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-18 14:05:57,353 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-18 14:05:57,353 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-18 14:05:57,353 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-18 14:05:57,353 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-18 14:05:57,357 - DEBUG - üîó Foreign keys for systems: []
2025-11-18 14:05:57,361 - DEBUG - üîó Foreign keys for users: []
2025-11-18 14:05:57,361 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-18 14:05:57,361 - DEBUG - üîç Relationship Details:
2025-11-18 14:05:57,361 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:05:57,361 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-18 14:05:57,362 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:05:57,362 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-18 14:05:57,362 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-18 14:05:57,362 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-18 14:05:57,362 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-18 14:05:57,362 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-18 14:05:57,362 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-18 14:05:57,362 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-18 14:05:57,362 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-18 14:05:57,362 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-18 14:05:57,362 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-18 14:05:57,362 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-18 14:05:57,362 - INFO - üìå Loaded conversation memory from disk.
2025-11-18 14:05:57,362 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-18 14:05:58,059 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:05:58,074 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 14:05:58,075 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-18 14:05:58,087 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-18 14:05:58,091 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-18 14:05:58,094 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-18 14:05:58,096 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-18 14:05:58,099 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-18 14:05:58,102 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-18 14:05:58,104 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-18 14:05:58,108 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-18 14:05:58,110 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-18 14:05:58,113 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-18 14:05:58,116 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-18 14:05:58,119 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-18 14:05:58,121 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-18 14:05:58,124 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-18 14:05:58,129 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-18 14:05:58,134 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:58,134 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-18 14:05:58,138 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-18 14:05:58,138 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-18 14:05:58,142 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:58,142 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-18 14:05:58,147 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:58,147 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-18 14:05:58,151 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:05:58,151 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-18 14:05:58,156 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-18 14:05:58,156 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-18 14:05:58,160 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-18 14:05:58,160 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-18 14:05:58,160 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-18 14:05:58,164 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-18 14:05:58,165 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-18 14:05:58,165 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-18 14:05:58,172 - DEBUG - üîó Foreign keys for ships: []
2025-11-18 14:05:58,178 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-18 14:05:58,179 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-18 14:05:58,179 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-18 14:05:58,179 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-18 14:05:58,179 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-18 14:05:58,185 - DEBUG - üîó Foreign keys for systems: []
2025-11-18 14:05:58,191 - DEBUG - üîó Foreign keys for users: []
2025-11-18 14:05:58,191 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-18 14:05:58,191 - DEBUG - üîç Relationship Details:
2025-11-18 14:05:58,191 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:05:58,191 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-18 14:05:58,191 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:05:58,191 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-18 14:05:58,191 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-18 14:05:58,191 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-18 14:05:58,191 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-18 14:05:58,191 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-18 14:05:58,191 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-18 14:05:58,191 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-18 14:05:58,191 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-18 14:05:58,191 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-18 14:05:58,191 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-18 14:05:58,191 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-18 14:10:48,679 - INFO - Database engine created with pool_size=10
2025-11-18 14:10:48,718 - INFO - Retrieved system hierarchy for ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components, 2 departments
2025-11-18 14:20:01,128 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:20:01,145 - INFO - üìå User authenticated: {'role': 'Admin/ INSMA', 'user_id': 'f47ac10b-58cc-4372-a567-0e02b2c3d479', 'username': 'jake'}
2025-11-18 14:20:01,146 - INFO - üì® Chat request: what is the reliability of GT 1 on ins one over 48...
2025-11-18 14:20:01,146 - INFO - üöÄ Creating ChatOrchestrator instance...
2025-11-18 14:20:01,162 - DEBUG - Starting new HTTP connection (1): localhost:11434
2025-11-18 14:20:01,566 - DEBUG - http://localhost:11434 "GET /api/tags HTTP/1.1" 200 1373
2025-11-18 14:20:01,566 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:20:01,582 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 14:20:01,582 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:20:01,597 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-18 14:20:01,613 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-18 14:20:01,613 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-18 14:20:01,627 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-18 14:20:01,631 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-18 14:20:01,634 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-18 14:20:01,637 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-18 14:20:01,640 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-18 14:20:01,643 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-18 14:20:01,645 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-18 14:20:01,648 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-18 14:20:01,651 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-18 14:20:01,653 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-18 14:20:01,656 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-18 14:20:01,660 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-18 14:20:01,662 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-18 14:20:01,665 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-18 14:20:01,671 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-18 14:20:01,675 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:20:01,675 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-18 14:20:01,680 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-18 14:20:01,680 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-18 14:20:01,685 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:20:01,685 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-18 14:20:01,689 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:20:01,689 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-18 14:20:01,694 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-18 14:20:01,694 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-18 14:20:01,698 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-18 14:20:01,698 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-18 14:20:01,702 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-18 14:20:01,702 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-18 14:20:01,702 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-18 14:20:01,706 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-18 14:20:01,706 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-18 14:20:01,707 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-18 14:20:01,711 - DEBUG - üîó Foreign keys for ships: []
2025-11-18 14:20:01,715 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-18 14:20:01,715 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-18 14:20:01,715 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-18 14:20:01,715 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-18 14:20:01,716 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-18 14:20:01,720 - DEBUG - üîó Foreign keys for systems: []
2025-11-18 14:20:01,724 - DEBUG - üîó Foreign keys for users: []
2025-11-18 14:20:01,724 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-18 14:20:01,724 - DEBUG - üîç Relationship Details:
2025-11-18 14:20:01,724 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:20:01,724 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-18 14:20:01,724 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-18 14:20:01,724 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-18 14:20:01,724 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-18 14:20:01,724 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-18 14:20:01,724 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-18 14:20:01,724 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-18 14:20:01,725 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-18 14:20:01,725 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-18 14:20:01,725 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-18 14:20:01,725 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-18 14:20:01,725 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-18 14:20:01,725 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-18 14:20:01,726 - INFO - üìå Loaded conversation memory from disk.
2025-11-18 14:20:01,726 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-18 14:20:01,726 - INFO - ‚úÖ ChatOrchestrator instance created successfully!
2025-11-18 14:20:01,726 - INFO - ‚úÖ Got ChatOrchestrator
2025-11-18 14:20:01,802 - DEBUG - connect_tcp.started host='localhost' port=11434 local_address=None timeout=60.0 socket_options=None
2025-11-18 14:20:01,803 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7261c08f02d0>
2025-11-18 14:20:01,803 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-11-18 14:20:01,803 - DEBUG - send_request_headers.complete
2025-11-18 14:20:01,803 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-11-18 14:20:01,804 - DEBUG - send_request_body.complete
2025-11-18 14:20:01,804 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-11-18 14:21:01,804 - DEBUG - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-11-18 14:21:01,852 - DEBUG - response_closed.started
2025-11-18 14:21:01,853 - DEBUG - response_closed.complete
2025-11-18 14:21:01,893 - INFO - ‚úÖ Got response from ChatOrchestrator - Intent: RELIABILITY
2025-11-21 18:53:07,197 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-21 18:53:07,253 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-21 18:53:07,253 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-21 18:53:07,546 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-21 18:53:08,024 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-21 18:53:08,062 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-21 18:53:08,062 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-21 18:53:08,077 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-21 18:53:08,092 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-21 18:53:08,164 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-21 18:53:08,573 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-21 18:53:08,637 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-21 18:53:08,640 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-21 18:53:08,643 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-21 18:53:08,646 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-21 18:53:08,649 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-21 18:53:08,651 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-21 18:53:08,654 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-21 18:53:08,657 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-21 18:53:08,660 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-21 18:53:08,663 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-21 18:53:08,666 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-21 18:53:08,669 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-21 18:53:08,672 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-21 18:53:09,014 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-21 18:53:09,019 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 18:53:09,019 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-21 18:53:09,023 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-21 18:53:09,024 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-21 18:53:09,028 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 18:53:09,028 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-21 18:53:09,032 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 18:53:09,032 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-21 18:53:09,036 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 18:53:09,036 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-21 18:53:09,041 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-21 18:53:09,041 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-21 18:53:09,045 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-21 18:53:09,045 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-21 18:53:09,045 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-21 18:53:09,050 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-21 18:53:09,050 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-21 18:53:09,050 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-21 18:53:09,054 - DEBUG - üîó Foreign keys for ships: []
2025-11-21 18:53:09,059 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-21 18:53:09,059 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-21 18:53:09,059 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-21 18:53:09,059 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-21 18:53:09,059 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-21 18:53:09,064 - DEBUG - üîó Foreign keys for systems: []
2025-11-21 18:53:09,068 - DEBUG - üîó Foreign keys for users: []
2025-11-21 18:53:09,069 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-21 18:53:09,069 - DEBUG - üîç Relationship Details:
2025-11-21 18:53:09,069 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-21 18:53:09,069 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-21 18:53:09,069 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-21 18:53:09,069 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-21 18:53:09,069 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-21 18:53:09,069 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-21 18:53:09,069 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-21 18:53:09,069 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-21 18:53:09,069 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-21 18:53:09,069 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-21 18:53:09,069 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-21 18:53:09,069 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-21 18:53:09,069 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-21 18:53:09,069 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-21 18:53:09,086 - INFO - üìå Loaded conversation memory from disk.
2025-11-21 18:53:09,086 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-21 18:53:22,626 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-21 18:53:22,642 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-21 18:53:22,643 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-21 18:53:22,655 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-21 18:53:22,660 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-21 18:53:22,662 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-21 18:53:22,665 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-21 18:53:22,667 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-21 18:53:22,670 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-21 18:53:22,673 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-21 18:53:22,676 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-21 18:53:22,679 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-21 18:53:22,682 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-21 18:53:22,685 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-21 18:53:22,688 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-21 18:53:22,690 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-21 18:53:22,693 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-21 18:53:22,699 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-21 18:53:22,703 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 18:53:22,703 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-21 18:53:22,707 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-21 18:53:22,708 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-21 18:53:22,711 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 18:53:22,712 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-21 18:53:22,716 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 18:53:22,716 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-21 18:53:22,720 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 18:53:22,720 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-21 18:53:22,724 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-21 18:53:22,724 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-21 18:53:22,728 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-21 18:53:22,728 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-21 18:53:22,728 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-21 18:53:22,732 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-21 18:53:22,732 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-21 18:53:22,732 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-21 18:53:22,737 - DEBUG - üîó Foreign keys for ships: []
2025-11-21 18:53:22,741 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-21 18:53:22,741 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-21 18:53:22,741 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-21 18:53:22,741 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-21 18:53:22,741 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-21 18:53:22,745 - DEBUG - üîó Foreign keys for systems: []
2025-11-21 18:53:22,750 - DEBUG - üîó Foreign keys for users: []
2025-11-21 18:53:22,750 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-21 18:53:22,750 - DEBUG - üîç Relationship Details:
2025-11-21 18:53:22,750 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-21 18:53:22,750 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-21 18:53:22,750 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-21 18:53:22,750 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-21 18:53:22,750 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-21 18:53:22,750 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-21 18:53:22,750 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-21 18:53:22,750 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-21 18:53:22,751 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-21 18:53:22,751 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-21 18:53:22,751 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-21 18:53:22,751 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-21 18:53:22,751 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-21 18:53:22,751 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-21 19:20:37,567 - INFO - Database engine created with pool_size=10
2025-11-21 19:20:37,567 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-21 19:20:37,568 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-21 19:20:37,681 - INFO - SQLModel query returned 53 rows
2025-11-21 19:20:37,681 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-21 19:20:37,681 - DEBUG - Starting to process and group results
2025-11-21 19:20:37,681 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-21 19:20:37,681 - DEBUG - Creating new command group: Western Naval Command
2025-11-21 19:20:37,681 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-21 19:20:37,681 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-21 19:20:37,681 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-21 19:20:37,681 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-21 19:20:37,681 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-21 19:20:37,681 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-21 19:20:37,681 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-21 19:20:37,681 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-21 19:20:37,681 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-21 19:20:37,682 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-21 19:20:37,682 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-21 19:20:37,682 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-21 19:20:37,682 - INFO - Processed 3 unique ships into 1 command groups
2025-11-21 19:20:37,682 - DEBUG - Converting to final data structure
2025-11-21 19:20:37,682 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-21 19:20:37,682 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-21 19:20:37,682 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-21 19:20:37,682 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-21 19:20:37,682 - DEBUG - Command groups: ['Western Naval Command']
2025-11-21 19:20:37,683 - INFO - Successfully retrieved hierarchical ship data
2025-11-21 20:48:08,826 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-21 20:48:08,826 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-21 20:48:08,826 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-21 20:48:08,994 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-21 20:48:09,229 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-21 20:48:09,245 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-21 20:48:09,245 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-21 20:48:09,260 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-21 20:48:09,275 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-21 20:48:09,284 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-21 20:48:09,394 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-21 20:48:09,400 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-21 20:48:09,402 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-21 20:48:09,405 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-21 20:48:09,408 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-21 20:48:09,410 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-21 20:48:09,413 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-21 20:48:09,415 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-21 20:48:09,418 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-21 20:48:09,421 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-21 20:48:09,424 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-21 20:48:09,427 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-21 20:48:09,429 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-21 20:48:09,432 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-21 20:48:09,437 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-21 20:48:09,442 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 20:48:09,442 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-21 20:48:09,446 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-21 20:48:09,446 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-21 20:48:09,450 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 20:48:09,450 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-21 20:48:09,454 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 20:48:09,454 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-21 20:48:09,458 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 20:48:09,458 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-21 20:48:09,463 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-21 20:48:09,463 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-21 20:48:09,467 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-21 20:48:09,467 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-21 20:48:09,467 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-21 20:48:09,471 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-21 20:48:09,471 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-21 20:48:09,471 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-21 20:48:09,475 - DEBUG - üîó Foreign keys for ships: []
2025-11-21 20:48:09,480 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-21 20:48:09,480 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-21 20:48:09,480 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-21 20:48:09,480 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-21 20:48:09,480 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-21 20:48:09,484 - DEBUG - üîó Foreign keys for systems: []
2025-11-21 20:48:09,488 - DEBUG - üîó Foreign keys for users: []
2025-11-21 20:48:09,488 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-21 20:48:09,489 - DEBUG - üîç Relationship Details:
2025-11-21 20:48:09,489 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-21 20:48:09,489 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-21 20:48:09,489 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-21 20:48:09,489 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-21 20:48:09,489 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-21 20:48:09,489 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-21 20:48:09,489 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-21 20:48:09,489 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-21 20:48:09,489 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-21 20:48:09,489 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-21 20:48:09,489 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-21 20:48:09,489 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-21 20:48:09,489 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-21 20:48:09,489 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-21 20:48:09,490 - INFO - üìå Loaded conversation memory from disk.
2025-11-21 20:48:09,490 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-21 20:48:10,155 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-21 20:48:10,170 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-21 20:48:10,171 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-21 20:48:10,183 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-21 20:48:10,188 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-21 20:48:10,190 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-21 20:48:10,193 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-21 20:48:10,196 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-21 20:48:10,199 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-21 20:48:10,201 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-21 20:48:10,205 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-21 20:48:10,208 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-21 20:48:10,211 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-21 20:48:10,214 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-21 20:48:10,217 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-21 20:48:10,220 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-21 20:48:10,223 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-21 20:48:10,228 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-21 20:48:10,232 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 20:48:10,232 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-21 20:48:10,236 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-21 20:48:10,237 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-21 20:48:10,241 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 20:48:10,241 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-21 20:48:10,245 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 20:48:10,245 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-21 20:48:10,249 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-21 20:48:10,249 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-21 20:48:10,253 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-21 20:48:10,253 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-21 20:48:10,258 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-21 20:48:10,258 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-21 20:48:10,258 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-21 20:48:10,262 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-21 20:48:10,262 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-21 20:48:10,262 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-21 20:48:10,267 - DEBUG - üîó Foreign keys for ships: []
2025-11-21 20:48:10,272 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-21 20:48:10,272 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-21 20:48:10,272 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-21 20:48:10,272 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-21 20:48:10,272 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-21 20:48:10,276 - DEBUG - üîó Foreign keys for systems: []
2025-11-21 20:48:10,280 - DEBUG - üîó Foreign keys for users: []
2025-11-21 20:48:10,280 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-21 20:48:10,280 - DEBUG - üîç Relationship Details:
2025-11-21 20:48:10,281 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-21 20:48:10,281 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-21 20:48:10,281 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-21 20:48:10,281 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-21 20:48:10,281 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-21 20:48:10,281 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-21 20:48:10,281 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-21 20:48:10,281 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-21 20:48:10,281 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-21 20:48:10,281 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-21 20:48:10,281 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-21 20:48:10,281 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-21 20:48:10,281 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-21 20:48:10,281 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-21 20:48:23,146 - INFO - Database engine created with pool_size=10
2025-11-21 20:48:23,146 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-21 20:48:23,147 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-21 20:48:23,179 - INFO - SQLModel query returned 53 rows
2025-11-21 20:48:23,179 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-21 20:48:23,179 - DEBUG - Starting to process and group results
2025-11-21 20:48:23,179 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-21 20:48:23,180 - DEBUG - Creating new command group: Western Naval Command
2025-11-21 20:48:23,180 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-21 20:48:23,180 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-21 20:48:23,180 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-21 20:48:23,180 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-21 20:48:23,180 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-21 20:48:23,180 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-21 20:48:23,180 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-21 20:48:23,181 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-21 20:48:23,181 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-21 20:48:23,181 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-21 20:48:23,181 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-21 20:48:23,181 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-21 20:48:23,181 - INFO - Processed 3 unique ships into 1 command groups
2025-11-21 20:48:23,181 - DEBUG - Converting to final data structure
2025-11-21 20:48:23,181 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-21 20:48:23,181 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-21 20:48:23,181 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-21 20:48:23,181 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-21 20:48:23,181 - DEBUG - Command groups: ['Western Naval Command']
2025-11-21 20:48:23,182 - INFO - Successfully retrieved hierarchical ship data
2025-11-21 20:54:33,162 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-21 20:54:33,162 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-21 20:54:33,171 - INFO - SQLModel query returned 53 rows
2025-11-21 20:54:33,171 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-21 20:54:33,171 - DEBUG - Starting to process and group results
2025-11-21 20:54:33,171 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-21 20:54:33,171 - DEBUG - Creating new command group: Western Naval Command
2025-11-21 20:54:33,171 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-21 20:54:33,171 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-21 20:54:33,171 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-21 20:54:33,171 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-21 20:54:33,171 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-21 20:54:33,172 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-21 20:54:33,172 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-21 20:54:33,172 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-21 20:54:33,172 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-21 20:54:33,173 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-21 20:54:33,173 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-21 20:54:33,173 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-21 20:54:33,173 - INFO - Processed 3 unique ships into 1 command groups
2025-11-21 20:54:33,173 - DEBUG - Converting to final data structure
2025-11-21 20:54:33,173 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-21 20:54:33,173 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-21 20:54:33,173 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-21 20:54:33,173 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-21 20:54:33,173 - DEBUG - Command groups: ['Western Naval Command']
2025-11-21 20:54:33,174 - INFO - Successfully retrieved hierarchical ship data
2025-11-21 20:59:58,121 - INFO - Retrieved system hierarchy for ship 33f13701-849f-4030-8d71-a0f65eac992e: 4 systems, 16 components, 2 departments
2025-11-22 14:15:04,941 - DEBUG - loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
2025-11-22 14:15:04,941 - DEBUG - loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
2025-11-22 14:15:04,941 - DEBUG - loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
2025-11-22 14:15:05,105 - DEBUG - registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
2025-11-22 14:15:05,334 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-22 14:15:05,349 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-22 14:15:05,349 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-22 14:15:05,365 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-22 14:15:05,380 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-22 14:15:05,388 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-22 14:15:05,488 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-22 14:15:05,494 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-22 14:15:05,496 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-22 14:15:05,499 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-22 14:15:05,502 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-22 14:15:05,504 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-22 14:15:05,507 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-22 14:15:05,509 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-22 14:15:05,512 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-22 14:15:05,515 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-22 14:15:05,518 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-22 14:15:05,521 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-22 14:15:05,523 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-22 14:15:05,526 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-22 14:15:05,531 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-22 14:15:05,536 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:15:05,536 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-22 14:15:05,540 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-22 14:15:05,540 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-22 14:15:05,544 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:15:05,544 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-22 14:15:05,548 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:15:05,548 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-22 14:15:05,553 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:15:05,553 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-22 14:15:05,557 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-22 14:15:05,557 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-22 14:15:05,561 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-22 14:15:05,561 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-22 14:15:05,561 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-22 14:15:05,565 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-22 14:15:05,565 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-22 14:15:05,565 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-22 14:15:05,569 - DEBUG - üîó Foreign keys for ships: []
2025-11-22 14:15:05,573 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-22 14:15:05,574 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-22 14:15:05,574 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-22 14:15:05,574 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-22 14:15:05,574 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-22 14:15:05,578 - DEBUG - üîó Foreign keys for systems: []
2025-11-22 14:15:05,582 - DEBUG - üîó Foreign keys for users: []
2025-11-22 14:15:05,582 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-22 14:15:05,582 - DEBUG - üîç Relationship Details:
2025-11-22 14:15:05,582 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-22 14:15:05,582 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-22 14:15:05,582 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-22 14:15:05,582 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-22 14:15:05,582 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-22 14:15:05,582 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-22 14:15:05,582 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-22 14:15:05,582 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-22 14:15:05,582 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-22 14:15:05,582 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-22 14:15:05,582 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-22 14:15:05,582 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-22 14:15:05,582 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-22 14:15:05,583 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-22 14:15:05,583 - INFO - üìå Loaded conversation memory from disk.
2025-11-22 14:15:05,583 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-22 14:15:06,265 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-22 14:15:06,280 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-22 14:15:06,281 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-22 14:15:06,294 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-22 14:15:06,298 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-22 14:15:06,301 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-22 14:15:06,304 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-22 14:15:06,306 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-22 14:15:06,309 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-22 14:15:06,312 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-22 14:15:06,315 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-22 14:15:06,318 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-22 14:15:06,321 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-22 14:15:06,323 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-22 14:15:06,327 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-22 14:15:06,329 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-22 14:15:06,332 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-22 14:15:06,338 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-22 14:15:06,343 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:15:06,343 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-22 14:15:06,348 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-22 14:15:06,348 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-22 14:15:06,352 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:15:06,352 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-22 14:15:06,357 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:15:06,357 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-22 14:15:06,361 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:15:06,361 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-22 14:15:06,365 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-22 14:15:06,365 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-22 14:15:06,370 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-22 14:15:06,370 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-22 14:15:06,371 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-22 14:15:06,375 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-22 14:15:06,376 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-22 14:15:06,376 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-22 14:15:06,380 - DEBUG - üîó Foreign keys for ships: []
2025-11-22 14:15:06,384 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-22 14:15:06,385 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-22 14:15:06,385 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-22 14:15:06,385 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-22 14:15:06,385 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-22 14:15:06,389 - DEBUG - üîó Foreign keys for systems: []
2025-11-22 14:15:06,394 - DEBUG - üîó Foreign keys for users: []
2025-11-22 14:15:06,394 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-22 14:15:06,394 - DEBUG - üîç Relationship Details:
2025-11-22 14:15:06,394 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-22 14:15:06,394 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-22 14:15:06,394 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-22 14:15:06,394 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-22 14:15:06,394 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-22 14:15:06,394 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-22 14:15:06,394 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-22 14:15:06,394 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-22 14:15:06,394 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-22 14:15:06,395 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-22 14:15:06,395 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-22 14:15:06,395 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-22 14:15:06,395 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-22 14:15:06,395 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-22 14:17:07,391 - INFO - Database engine created with pool_size=10
2025-11-22 14:17:07,391 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 14:17:07,392 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 14:17:07,438 - INFO - SQLModel query returned 53 rows
2025-11-22 14:17:07,438 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 14:17:07,438 - DEBUG - Starting to process and group results
2025-11-22 14:17:07,438 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 14:17:07,439 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 14:17:07,439 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 14:17:07,439 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 14:17:07,439 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 14:17:07,439 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 14:17:07,439 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 14:17:07,439 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 14:17:07,439 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 14:17:07,439 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 14:17:07,439 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 14:17:07,439 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 14:17:07,439 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 14:17:07,439 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 14:17:07,439 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 14:17:07,440 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 14:17:07,440 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 14:17:07,440 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 14:17:07,440 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 14:17:07,440 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 14:17:07,440 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 14:17:07,440 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 14:17:07,440 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 14:17:07,440 - DEBUG - Converting to final data structure
2025-11-22 14:17:07,440 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 14:17:07,440 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 14:17:07,440 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 14:17:07,440 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 14:17:07,440 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 14:17:07,441 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 14:27:48,499 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 14:27:48,499 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 14:27:48,508 - INFO - SQLModel query returned 53 rows
2025-11-22 14:27:48,509 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 14:27:48,509 - DEBUG - Starting to process and group results
2025-11-22 14:27:48,509 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 14:27:48,509 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 14:27:48,509 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 14:27:48,509 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 14:27:48,509 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 14:27:48,509 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 14:27:48,509 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 14:27:48,509 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 14:27:48,509 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 14:27:48,509 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 14:27:48,510 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 14:27:48,510 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 14:27:48,510 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 14:27:48,511 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 14:27:48,511 - DEBUG - Converting to final data structure
2025-11-22 14:27:48,511 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 14:27:48,511 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 14:27:48,511 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 14:27:48,511 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 14:27:48,511 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 14:27:48,511 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 14:38:56,514 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 14:38:56,514 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 14:38:56,588 - INFO - SQLModel query returned 53 rows
2025-11-22 14:38:56,589 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 14:38:56,589 - DEBUG - Starting to process and group results
2025-11-22 14:38:56,589 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 14:38:56,589 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 14:38:56,589 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 14:38:56,589 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 14:38:56,589 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 14:38:56,589 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 14:38:56,589 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 14:38:56,589 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 14:38:56,589 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 14:38:56,589 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 14:38:56,589 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 14:38:56,589 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 14:38:56,590 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 14:38:56,590 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 14:38:56,590 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 14:38:56,590 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 14:38:56,590 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 14:38:56,590 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 14:38:56,590 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 14:38:56,590 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 14:38:56,590 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 14:38:56,590 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 14:38:56,590 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 14:38:56,590 - DEBUG - Converting to final data structure
2025-11-22 14:38:56,590 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 14:38:56,590 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 14:38:56,590 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 14:38:56,591 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 14:38:56,591 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 14:38:56,619 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 14:41:47,580 - INFO - üöÄ Creating ChatOrchestrator instance...
2025-11-22 14:41:47,610 - DEBUG - Starting new HTTP connection (1): localhost:11434
2025-11-22 14:41:47,758 - DEBUG - http://localhost:11434 "GET /api/tags HTTP/1.1" 200 1373
2025-11-22 14:41:47,758 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-22 14:41:47,801 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-22 14:41:47,801 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-22 14:41:47,816 - INFO - Loading configuration from: /home/user/IITB/netra/backend/utils/config.yaml
2025-11-22 14:41:47,831 - INFO - Initializing LLMClient with Ollama model: codellama:7b-instruct
2025-11-22 14:41:47,832 - INFO - ‚úÖ Database engine created with URL: mssql+pyodbc://sa:Camlab110@localhost:1433/NetraKoshx?driver=ODBC+Driver+18+for+SQL+Server&TrustServerCertificate=yes&timeout=300
2025-11-22 14:41:47,845 - INFO - üîç Found tables: ['alembic_version', 'alphabeta', 'departments', 'etabeta', 'failure_modes', 'monthly_utilization', 'refresh_tokens', 'sensor_metadata', 'sensor_readings', 'ships', 'system_configuration', 'systems', 'users']
2025-11-22 14:41:47,849 - DEBUG - üìä Table alembic_version columns: ['version_num']
2025-11-22 14:41:47,852 - DEBUG - üìä Table alphabeta columns: ['id', 'alpha', 'beta', 'component_id']
2025-11-22 14:41:47,855 - DEBUG - üìä Table departments columns: ['ship_id', 'department_name', 'department_code', 'department_id', 'created_date', 'modified_date']
2025-11-22 14:41:47,857 - DEBUG - üìä Table etabeta columns: ['id', 'eta', 'beta', 'component_id', 'priority']
2025-11-22 14:41:47,860 - DEBUG - üìä Table failure_modes columns: ['name', 'severity', 'component_id', 'failure_mode_id']
2025-11-22 14:41:47,862 - DEBUG - üìä Table monthly_utilization columns: ['id', 'operation_date', 'utlization', 'component_id']
2025-11-22 14:41:47,865 - DEBUG - üìä Table refresh_tokens columns: ['id', 'token', 'user_id', 'expires_at', 'created_at', 'is_revoked']
2025-11-22 14:41:47,868 - DEBUG - üìä Table sensor_metadata columns: ['sensor_name', 'unit', 'min_value', 'max_value', 'frequency', 'P', 'F', 'component_id', 'sensor_id', 'failure_mode_id']
2025-11-22 14:41:47,871 - DEBUG - üìä Table sensor_readings columns: ['value', 'operating_hours', 'alert', 'id', 'date', 'component_id', 'sensor_id']
2025-11-22 14:41:47,874 - DEBUG - üìä Table ships columns: ['ship_name', 'ship_category', 'ship_class', 'command', 'ship_id', 'created_date', 'modified_date']
2025-11-22 14:41:47,877 - DEBUG - üìä Table system_configuration columns: ['component_name', 'parent_id', 'department_id', 'CMMS_EquipmentCode', 'is_lmu', 'parent_name', 'nomenclature', 'etl', 'component_id', 'created_date', 'modified_date', 'ship_id', 'system_id']
2025-11-22 14:41:47,880 - DEBUG - üìä Table systems columns: ['system_id', 'system_type', 'created_date']
2025-11-22 14:41:47,883 - DEBUG - üìä Table users columns: ['email', 'username', 'full_name', 'role', 'is_active', 'id', 'hashed_password', 'created_at', 'updated_at', 'last_login']
2025-11-22 14:41:47,888 - DEBUG - üîó Foreign keys for alembic_version: []
2025-11-22 14:41:47,892 - DEBUG - üîó Foreign keys for alphabeta: [{'name': 'FK__alphabeta__compo__3E1D39E1', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:41:47,892 - DEBUG - üîó Added relationship: alphabeta.component_id -> system_configuration.component_id
2025-11-22 14:41:47,896 - DEBUG - üîó Foreign keys for departments: [{'name': 'FK__departmen__ship___47DBAE45', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}]
2025-11-22 14:41:47,897 - DEBUG - üîó Added relationship: departments.ship_id -> ships.ship_id
2025-11-22 14:41:47,901 - DEBUG - üîó Foreign keys for etabeta: [{'name': 'FK__etabeta__compone__40F9A68C', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:41:47,901 - DEBUG - üîó Added relationship: etabeta.component_id -> system_configuration.component_id
2025-11-22 14:41:47,905 - DEBUG - üîó Foreign keys for failure_modes: [{'name': 'FK__failure_m__compo__37703C52', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:41:47,905 - DEBUG - üîó Added relationship: failure_modes.component_id -> system_configuration.component_id
2025-11-22 14:41:47,909 - DEBUG - üîó Foreign keys for monthly_utilization: [{'name': 'FK__monthly_u__compo__2EDAF651', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}]
2025-11-22 14:41:47,909 - DEBUG - üîó Added relationship: monthly_utilization.component_id -> system_configuration.component_id
2025-11-22 14:41:47,913 - DEBUG - üîó Foreign keys for refresh_tokens: [{'name': 'FK__refresh_t__user___49C3F6B7', 'constrained_columns': ['user_id'], 'referred_schema': None, 'referred_table': 'users', 'referred_columns': ['id'], 'options': {}}]
2025-11-22 14:41:47,913 - DEBUG - üîó Added relationship: refresh_tokens.user_id -> users.id
2025-11-22 14:41:47,917 - DEBUG - üîó Foreign keys for sensor_metadata: [{'name': 'FK__sensor_me__compo__31B762FC', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_me__failu__32AB8735', 'constrained_columns': ['failure_mode_id'], 'referred_schema': None, 'referred_table': 'failure_modes', 'referred_columns': ['failure_mode_id'], 'options': {}}]
2025-11-22 14:41:47,917 - DEBUG - üîó Added relationship: sensor_metadata.component_id -> system_configuration.component_id
2025-11-22 14:41:47,917 - DEBUG - üîó Added relationship: sensor_metadata.failure_mode_id -> failure_modes.failure_mode_id
2025-11-22 14:41:47,921 - DEBUG - üîó Foreign keys for sensor_readings: [{'name': 'FK__sensor_re__compo__3587F3E0', 'constrained_columns': ['component_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__sensor_re__senso__367C1819', 'constrained_columns': ['sensor_id'], 'referred_schema': None, 'referred_table': 'sensor_metadata', 'referred_columns': ['sensor_id'], 'options': {}}]
2025-11-22 14:41:47,921 - DEBUG - üîó Added relationship: sensor_readings.component_id -> system_configuration.component_id
2025-11-22 14:41:47,921 - DEBUG - üîó Added relationship: sensor_readings.sensor_id -> sensor_metadata.sensor_id
2025-11-22 14:41:47,925 - DEBUG - üîó Foreign keys for ships: []
2025-11-22 14:41:47,930 - DEBUG - üîó Foreign keys for system_configuration: [{'name': 'FK__system_co__depar__4BAC3F29', 'constrained_columns': ['department_id'], 'referred_schema': None, 'referred_table': 'departments', 'referred_columns': ['department_id'], 'options': {}}, {'name': 'FK__system_co__paren__4CA06362', 'constrained_columns': ['parent_id'], 'referred_schema': None, 'referred_table': 'system_configuration', 'referred_columns': ['component_id'], 'options': {}}, {'name': 'FK__system_co__ship___3864608B', 'constrained_columns': ['ship_id'], 'referred_schema': None, 'referred_table': 'ships', 'referred_columns': ['ship_id'], 'options': {}}, {'name': 'FK__system_co__syste__47A6A41B', 'constrained_columns': ['system_id'], 'referred_schema': None, 'referred_table': 'systems', 'referred_columns': ['system_id'], 'options': {}}]
2025-11-22 14:41:47,930 - DEBUG - üîó Added relationship: system_configuration.department_id -> departments.department_id
2025-11-22 14:41:47,930 - DEBUG - üîó Added relationship: system_configuration.parent_id -> system_configuration.component_id
2025-11-22 14:41:47,930 - DEBUG - üîó Added relationship: system_configuration.ship_id -> ships.ship_id
2025-11-22 14:41:47,930 - DEBUG - üîó Added relationship: system_configuration.system_id -> systems.system_id
2025-11-22 14:41:47,934 - DEBUG - üîó Foreign keys for systems: []
2025-11-22 14:41:47,938 - DEBUG - üîó Foreign keys for users: []
2025-11-22 14:41:47,938 - INFO - ‚úÖ Schema loading complete. Found 13 tables and 14 relationships
2025-11-22 14:41:47,938 - DEBUG - üîç Relationship Details:
2025-11-22 14:41:47,938 - DEBUG -   ('alphabeta', 'system_configuration') -> ('alphabeta.component_id', 'system_configuration.component_id')
2025-11-22 14:41:47,938 - DEBUG -   ('departments', 'ships') -> ('departments.ship_id', 'ships.ship_id')
2025-11-22 14:41:47,938 - DEBUG -   ('etabeta', 'system_configuration') -> ('etabeta.component_id', 'system_configuration.component_id')
2025-11-22 14:41:47,938 - DEBUG -   ('failure_modes', 'system_configuration') -> ('failure_modes.component_id', 'system_configuration.component_id')
2025-11-22 14:41:47,938 - DEBUG -   ('monthly_utilization', 'system_configuration') -> ('monthly_utilization.component_id', 'system_configuration.component_id')
2025-11-22 14:41:47,938 - DEBUG -   ('refresh_tokens', 'users') -> ('refresh_tokens.user_id', 'users.id')
2025-11-22 14:41:47,938 - DEBUG -   ('sensor_metadata', 'system_configuration') -> ('sensor_metadata.component_id', 'system_configuration.component_id')
2025-11-22 14:41:47,938 - DEBUG -   ('sensor_metadata', 'failure_modes') -> ('sensor_metadata.failure_mode_id', 'failure_modes.failure_mode_id')
2025-11-22 14:41:47,938 - DEBUG -   ('sensor_readings', 'system_configuration') -> ('sensor_readings.component_id', 'system_configuration.component_id')
2025-11-22 14:41:47,938 - DEBUG -   ('sensor_readings', 'sensor_metadata') -> ('sensor_readings.sensor_id', 'sensor_metadata.sensor_id')
2025-11-22 14:41:47,938 - DEBUG -   ('system_configuration', 'departments') -> ('system_configuration.department_id', 'departments.department_id')
2025-11-22 14:41:47,938 - DEBUG -   ('system_configuration', 'system_configuration') -> ('system_configuration.parent_id', 'system_configuration.component_id')
2025-11-22 14:41:47,938 - DEBUG -   ('system_configuration', 'ships') -> ('system_configuration.ship_id', 'ships.ship_id')
2025-11-22 14:41:47,939 - DEBUG -   ('system_configuration', 'systems') -> ('system_configuration.system_id', 'systems.system_id')
2025-11-22 14:41:47,951 - INFO - üìå Loaded conversation memory from disk.
2025-11-22 14:41:47,951 - INFO - üìå Initialized memory: Last 5 exchanges
2025-11-22 14:41:47,952 - INFO - ‚úÖ ChatOrchestrator instance created successfully!
2025-11-22 14:41:48,008 - INFO - Retrieved 4 systems for ship ID: 33f13701-849f-4030-8d71-a0f65eac992e
2025-11-22 14:41:48,018 - INFO - Retrieved hierarchical component structure for system 64044bde-5b46-4ab3-b44d-2d140833284b: 4 total components, 4 root components
2025-11-22 14:41:48,020 - INFO - Retrieved hierarchical component structure for system 017bdf6b-d9f2-4f31-869d-842ad61a9627: 4 total components, 4 root components
2025-11-22 14:41:48,022 - INFO - Retrieved hierarchical component structure for system 6b3a59eb-4cc2-4480-b512-9357aed35540: 6 total components, 6 root components
2025-11-22 14:41:48,024 - INFO - Retrieved hierarchical component structure for system a2b3e95b-c3b8-43ce-af79-eb445794f7ab: 2 total components, 2 root components
2025-11-22 14:41:48,027 - INFO - Retrieved 4 systems for ship ID: 33f13701-849f-4030-8d71-a0f65eac992e
2025-11-22 14:41:48,033 - INFO - Retrieved hierarchical component structure for system 64044bde-5b46-4ab3-b44d-2d140833284b: 4 total components, 4 root components
2025-11-22 14:41:48,034 - INFO - Retrieved hierarchical component structure for system 017bdf6b-d9f2-4f31-869d-842ad61a9627: 4 total components, 4 root components
2025-11-22 14:41:48,036 - INFO - Retrieved hierarchical component structure for system 6b3a59eb-4cc2-4480-b512-9357aed35540: 6 total components, 6 root components
2025-11-22 14:41:48,037 - INFO - Retrieved hierarchical component structure for system a2b3e95b-c3b8-43ce-af79-eb445794f7ab: 2 total components, 2 root components
2025-11-22 14:42:41,988 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 14:42:41,989 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 14:42:41,991 - INFO - SQLModel query returned 53 rows
2025-11-22 14:42:41,991 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 14:42:41,991 - DEBUG - Starting to process and group results
2025-11-22 14:42:41,991 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 14:42:41,991 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 14:42:41,991 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 14:42:41,991 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 14:42:41,991 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 14:42:41,991 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 14:42:41,991 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 14:42:41,991 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 14:42:41,992 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 14:42:41,992 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 14:42:41,992 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 14:42:41,992 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 14:42:41,992 - DEBUG - Converting to final data structure
2025-11-22 14:42:41,992 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 14:42:41,992 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 14:42:41,992 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 14:42:41,992 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 14:42:41,992 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 14:42:41,993 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:17:45,357 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:17:45,357 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:17:45,366 - INFO - SQLModel query returned 53 rows
2025-11-22 15:17:45,366 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:17:45,366 - DEBUG - Starting to process and group results
2025-11-22 15:17:45,366 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:17:45,366 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:17:45,366 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:17:45,366 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:17:45,366 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:17:45,366 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:17:45,366 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:17:45,366 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:17:45,366 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:17:45,367 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:17:45,367 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:17:45,367 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:17:45,368 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:17:45,368 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:17:45,368 - DEBUG - Converting to final data structure
2025-11-22 15:17:45,368 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:17:45,368 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:17:45,368 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:17:45,368 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:17:45,368 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:17:45,368 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:18:59,952 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:18:59,952 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:18:59,955 - INFO - SQLModel query returned 53 rows
2025-11-22 15:18:59,955 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:18:59,955 - DEBUG - Starting to process and group results
2025-11-22 15:18:59,955 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:18:59,955 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:18:59,955 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:18:59,955 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:18:59,955 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:18:59,955 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:18:59,956 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:18:59,956 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:18:59,956 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:18:59,956 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:18:59,956 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:18:59,957 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:18:59,957 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:18:59,957 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:18:59,957 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:18:59,957 - DEBUG - Converting to final data structure
2025-11-22 15:18:59,957 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:18:59,957 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:18:59,957 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:18:59,957 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:18:59,957 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:18:59,958 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:19:21,565 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:19:21,566 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:19:21,568 - INFO - SQLModel query returned 53 rows
2025-11-22 15:19:21,568 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:19:21,568 - DEBUG - Starting to process and group results
2025-11-22 15:19:21,568 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:19:21,568 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:19:21,568 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:19:21,568 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:19:21,569 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:19:21,569 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:19:21,569 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:19:21,569 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:19:21,569 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:19:21,569 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:19:21,569 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:19:21,569 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:19:21,569 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:19:21,569 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:19:21,569 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:19:21,569 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:19:21,570 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:19:21,570 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:19:21,570 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:19:21,570 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:19:21,570 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:19:21,570 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:19:21,570 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:19:21,570 - DEBUG - Converting to final data structure
2025-11-22 15:19:21,570 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:19:21,570 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:19:21,570 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:19:21,570 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:19:21,570 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:19:21,571 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:21:21,292 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:21:21,293 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:21:21,295 - INFO - SQLModel query returned 53 rows
2025-11-22 15:21:21,295 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:21:21,295 - DEBUG - Starting to process and group results
2025-11-22 15:21:21,295 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:21:21,295 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:21:21,295 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:21:21,295 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:21:21,295 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:21:21,295 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:21:21,295 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:21:21,295 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:21:21,295 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:21:21,296 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:21:21,296 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:21:21,296 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:21:21,296 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:21:21,296 - DEBUG - Converting to final data structure
2025-11-22 15:21:21,296 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:21:21,296 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:21:21,296 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:21:21,296 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:21:21,296 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:21:21,297 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:28:13,282 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:28:13,283 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:28:13,290 - INFO - SQLModel query returned 53 rows
2025-11-22 15:28:13,290 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:28:13,290 - DEBUG - Starting to process and group results
2025-11-22 15:28:13,290 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:28:13,290 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:28:13,290 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:28:13,290 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:28:13,290 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:28:13,291 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:28:13,291 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:28:13,291 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:28:13,291 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:28:13,291 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:28:13,291 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:28:13,292 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:28:13,292 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:28:13,292 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:28:13,292 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:28:13,292 - DEBUG - Converting to final data structure
2025-11-22 15:28:13,292 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:28:13,292 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:28:13,292 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:28:13,292 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:28:13,292 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:28:13,293 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:28:49,742 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:28:49,743 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:28:49,745 - INFO - SQLModel query returned 53 rows
2025-11-22 15:28:49,745 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:28:49,745 - DEBUG - Starting to process and group results
2025-11-22 15:28:49,745 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:28:49,745 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:28:49,745 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:28:49,745 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:28:49,745 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:28:49,745 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:28:49,745 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:28:49,745 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:28:49,745 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:28:49,745 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:28:49,745 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:28:49,745 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:28:49,745 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:28:49,745 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:28:49,745 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:28:49,745 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:28:49,746 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:28:49,746 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:28:49,746 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:28:49,746 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:28:49,746 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:28:49,746 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:28:49,746 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:28:49,746 - DEBUG - Converting to final data structure
2025-11-22 15:28:49,746 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:28:49,746 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:28:49,746 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:28:49,746 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:28:49,746 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:28:49,746 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:28:54,321 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:28:54,322 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:28:54,324 - INFO - SQLModel query returned 53 rows
2025-11-22 15:28:54,324 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:28:54,324 - DEBUG - Starting to process and group results
2025-11-22 15:28:54,324 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:28:54,324 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:28:54,324 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:28:54,324 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:28:54,324 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:28:54,324 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:28:54,324 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:28:54,324 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:28:54,324 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:28:54,325 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:28:54,325 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:28:54,325 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:28:54,325 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:28:54,325 - DEBUG - Converting to final data structure
2025-11-22 15:28:54,325 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:28:54,325 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:28:54,325 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:28:54,325 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:28:54,325 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:28:54,326 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:29:34,575 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:29:34,575 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:29:34,577 - INFO - SQLModel query returned 53 rows
2025-11-22 15:29:34,578 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:29:34,578 - DEBUG - Starting to process and group results
2025-11-22 15:29:34,578 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:29:34,578 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:29:34,578 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:29:34,578 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:29:34,578 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:29:34,578 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:29:34,578 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:29:34,578 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:29:34,578 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:29:34,578 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:29:34,579 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:29:34,579 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:29:34,579 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:29:34,579 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:29:34,579 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:29:34,579 - DEBUG - Converting to final data structure
2025-11-22 15:29:34,579 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:29:34,579 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:29:34,579 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:29:34,579 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:29:34,579 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:29:34,579 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:29:35,573 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:29:35,573 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:29:35,576 - INFO - SQLModel query returned 53 rows
2025-11-22 15:29:35,576 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:29:35,576 - DEBUG - Starting to process and group results
2025-11-22 15:29:35,576 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:29:35,576 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:29:35,576 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:29:35,576 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:29:35,576 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:29:35,576 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:29:35,576 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:29:35,576 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:29:35,576 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:29:35,576 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:29:35,576 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:29:35,576 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:29:35,576 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:29:35,577 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:29:35,577 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:29:35,577 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:29:35,577 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:29:35,577 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:29:35,577 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:29:35,577 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:29:35,577 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:29:35,577 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:29:35,577 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:29:35,577 - DEBUG - Converting to final data structure
2025-11-22 15:29:35,577 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:29:35,577 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:29:35,577 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:29:35,577 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:29:35,577 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:29:35,578 - INFO - Successfully retrieved hierarchical ship data
2025-11-22 15:30:50,898 - DEBUG - Starting _get_hierarchical_ship_data_sync
2025-11-22 15:30:50,898 - DEBUG - Executing SQLModel query for hierarchical ship data
2025-11-22 15:30:51,642 - INFO - SQLModel query returned 53 rows
2025-11-22 15:30:51,642 - DEBUG - First row sample: (UUID('33f13701-849f-4030-8d71-a0f65eac992e'), 'INS ONE', 'Western Naval Command', UUID('51c112c4-e47d-4f37-82e0-21cc824c5ff9'), 'pump2', 'p2', None, None)
2025-11-22 15:30:51,642 - DEBUG - Starting to process and group results
2025-11-22 15:30:51,642 - DEBUG - Initializing new ship: INS ONE (ID: 33f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:30:51,642 - DEBUG - Creating new command group: Western Naval Command
2025-11-22 15:30:51,642 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:30:51,642 - DEBUG - Creating new equipment group 'Other' for ship INS ONE
2025-11-22 15:30:51,642 - DEBUG - Component motor 1 has no system_type, assigning to 'Other' group
2025-11-22 15:30:51,642 - DEBUG - Component pump3 has no system_type, assigning to 'Other' group
2025-11-22 15:30:51,642 - DEBUG - Component pump2 has no system_type, assigning to 'Other' group
2025-11-22 15:30:51,642 - DEBUG - Component pump1 has no system_type, assigning to 'Other' group
2025-11-22 15:30:51,642 - DEBUG - Creating new equipment group 'Firing' for ship INS ONE
2025-11-22 15:30:51,642 - DEBUG - Creating new equipment group 'Power Generation' for ship INS ONE
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Propulsion' for ship INS ONE
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Support' for ship INS ONE
2025-11-22 15:30:51,643 - DEBUG - Initializing new ship: INS THREE (ID: 53f13701-849f-4030-8d71-a0f65eac992e, Command: Western Naval Command)
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Firing' for ship INS THREE
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Power Generation' for ship INS THREE
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Propulsion' for ship INS THREE
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Support' for ship INS THREE
2025-11-22 15:30:51,643 - DEBUG - Initializing new ship: INS TWO (ID: fdc1f9a0-d380-42bb-9ee5-7990a46ddff5, Command: Western Naval Command)
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Firing' for ship INS TWO
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Power Generation' for ship INS TWO
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Propulsion' for ship INS TWO
2025-11-22 15:30:51,643 - DEBUG - Creating new equipment group 'Support' for ship INS TWO
2025-11-22 15:30:51,643 - INFO - Processed 3 unique ships into 1 command groups
2025-11-22 15:30:51,643 - DEBUG - Converting to final data structure
2025-11-22 15:30:51,643 - DEBUG - Ship 33f13701-849f-4030-8d71-a0f65eac992e: 5 equipment groups, 21 total items
2025-11-22 15:30:51,643 - DEBUG - Ship 53f13701-849f-4030-8d71-a0f65eac992e: 4 equipment groups, 16 total items
2025-11-22 15:30:51,643 - DEBUG - Ship fdc1f9a0-d380-42bb-9ee5-7990a46ddff5: 4 equipment groups, 16 total items
2025-11-22 15:30:51,643 - INFO - Final data structure: 1 command groups, 3 total ships
2025-11-22 15:30:51,643 - DEBUG - Command groups: ['Western Naval Command']
2025-11-22 15:30:51,673 - INFO - Successfully retrieved hierarchical ship data
